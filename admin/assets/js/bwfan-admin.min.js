"use strict";function bwfan_make_html(t,a,n){var e=jQuery(a);1==t?(jQuery(a).html(""),e.html(n)):2==t&&e.append(n)}!function(t){var a="undefined"!=typeof wp&&void 0!==wp.i18n?wp.i18n.__:function(t,a){return t};function n(){var a=t(".datepicker");0!==a.length&&a.datepicker({dateFormat:"yy-mm-dd",required:!0})}function e(t){var a,n,e=window.location.search.substring(1).split("&");for(n=0;n<e.length;n++)if((a=e[n].split("="))[0]===t)return void 0===a[1]?void 0:decodeURIComponent(a[1]);return!1}function s(){t(document).on("click",".bwfan_run_tool",function(){var a=t(this),n=a.attr("data-type"),e=a.attr("data-inputs");a.addClass("bwfan_btn_spin");var s=new bwf_ajax,o={tool_type:n,data_inputs:e};s.ajax("run_global_tools",o),s.success=function(t){a.removeClass("bwfan_btn_spin");var n="error";1==t.status&&(n="success"),swal({type:n,title:"",text:t.msg})}})}function o(){if(0!==t(".bwfan_recipe").length){var n="",e=_.keys(bwfanParams.recipes);t(".bwfan_r_tabs li a.bwfan_r_t_active").length>0&&(n=t(".bwfan_r_tabs li a.bwfan_r_t_active").data("slug")),"-1"!==n&&!0===_.has(bwfanParams.recipes_connector,n)&&(e=bwfanParams.recipes_connector[n].recipe);var s="",o=_.keys(bwfanParams.recipes);t(".bwfan_r_t select").length>0&&(s=t(".bwfan_r_t select").val()),"-1"!==s&&!0===_.has(bwfanParams.recipes_plugins,s)&&(o=bwfanParams.recipes_plugins[s].recipe);var i=[];_.size(_.intersection(e,o))>0&&(i=_.intersection(e,o));var r=t(".bwfan-pagination-wrap"),c=t(".bwfan_r_list"),l=wp.template("bwfan-pagination-ui"),f=r.find(".bwfan-pagination").attr("data-page");f=parseInt(f);var w=l({total:_.size(i),current_page:f,show_items:10});if(r.html(w),0!==_.size(i)){c.html('<div class="bwfan_r_load"><div class="bwfan_r_load_text">'+a("Loading ...","wp-marketing-automations")+"</div></div>");var u=1===f?0:10*(f-1),d=0;setTimeout(function(){c.html(""),t.each(i,function(t,a){if(!(t<u)){var n=wp.template("recipe-list-template");if(_.has(bwfanParams.recipes,a)){if(d>=10)return!1;var e=n({details:bwfanParams.recipes[a].data,slug:a});c.append(e),d++}}})},500)}else c.html('<div class="bwfan_r_single"><div class="bwfan_r_s_name">No Recipes found for given selection</div></div>')}}t(document).on("click",".bwfan_sync_customer_order",function(){t(".bwfan_sync_customer_order").parents(".error").addClass("bwfan-elem-loader"),t.ajax({method:"post",url:bwfanParams.ajax_url,data:{action:"bwfan_sync_customer_order"},success:function(a){t(".bwfan_sync_customer_order").parents(".error").fadeOut(400)}})}),t(document).on("click",".bwfan_page_unsubscribers form .bwfan_form_submit button, .export-automations",function(){t(this).hasClass("bwfan_loading")||t(this).addClass("bwfan_loading")}),t(document).on("click",".import-automations",function(){if(""!=t("#bwfan-import-automations").val()){if(t(this).hasClass("bwfan_loading"))return;t(this).addClass("bwfan_loading")}}),t(document).on("click",".bwfan_abandoned_preview",function(){var a=t(this).siblings(".bwfan_abandoned_preview_info").attr("data-details"),n=(a=JSON.parse(a)).billing,e=a.shipping,s=a.others,o=a.products,i=a.discount,r=a.currency,c=a.total,l=a.shipping_total;bwfan_make_html(1,"#bwfan-abandoned-section",wp.template("bwfan-abandoned-popup")({products:o,billing:n,shipping:e,others:s,discount:i,currency:r,total:c,shipping_total:l}))}),t(document).on("click",".bwfan_recovered_cart_preview",function(){var a=t(this).siblings(".bwfan_recovered_cart_preview_info").attr("data-details"),n=(a=JSON.parse(a)).billing,e=a.shipping,s=a.others,o=a.products,i=a.discount,r=a.currency,c=a.total;bwfan_make_html(1,"#bwfan-abandoned-section",wp.template("bwfan-recovered-cart-popup")({products:o,billing:n,shipping:e,others:s,discount:i,currency:r,total:c}))}),t(document).on("click",".bwfan-recipe-import",function(){var a={recipe_slug:t(this).closest(".bwfan-recipe-list").data("recipe_slug"),action:"bwfan_recipe_import"};t.post(bwfanParams.ajax_url,a,function(){})}),t(document).on("click",".bwfan-export-automation a",function(a){a.preventDefault();var n=t(this).attr("data-automation"),e=new bwf_ajax,s={id:n};swal({title:"Exporting...",text:"Please wait",showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1}),swal.showLoading(),e.ajax("export_single_automation",s),e.success=function(t){swal.close(),window.location.href=t}}),t(document).on("click",".bwfan-duplicate-automation a",function(a){a.preventDefault();var n=t(this).attr("data-automation"),e=new bwf_ajax,s={id:n};swal({title:"Duplicating...",text:"Please wait",showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1}),swal.showLoading(),e.ajax("duplicate_single_automation",s),e.success=function(t){if(0==parseInt(t.status))return setTimeout(function(){swal("Duplication Failed","","error")},500),!1;setTimeout(function(){swal("Duplicated Successfully","","success")},500),setTimeout(function(){window.location.href=t.url},1500),swal.close()}}),t(document).on("click","#bwfan-exp-aut",function(a){a.preventDefault();var n=t(this),e=new bwf_ajax;n.attr("disabled","disabled"),swal({title:"Exporting...",text:"Please wait",showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1}),swal.showLoading(),e.ajax("export_all_automation",{}),e.success=function(t){n.removeAttr("disabled"),swal.close(),window.location.href=t}}),t(document).on("submit","#bwfan-autonami-import",function(a){a.preventDefault();var n=t("#bwfan-import-automations").prop("files")[0],e=new FormData;e.append("file",n),e.append("action","bwf_import_automations_json_file"),t.ajax({type:"POST",url:bwfanParams.ajax_url,data:e,dataType:"json",contentType:!1,cache:!1,processData:!1,beforeSend:function(){swal({title:"Importing...",text:"Please wait",showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1}),swal.showLoading()},complete:function(){},success:function(t){if(1!==parseInt(t))return setTimeout(function(){swal("Import Failed","","error")},500),!1;setTimeout(function(){swal("Import Success","","success")},500);var a=bwfan.site_url+"/wp-admin/admin.php?page=autonami-automations";setTimeout(function(){window.location.href=a},1500)}})}),t(document).ready(function(){var a=t("#bwfan_select_sync_history_automation");a.select2(),a.on("change",function(){var a=t(this),e=a.val();if(0!=e&&!a.hasClass("bwfan_loading")){a.addClass("bwfan_loading");var o=a.parents(".field-wrap").find(".bwfan_spinner");o.show();var i=new bwf_ajax,r={id:e};i.ajax("select_syncable_automation",r),i.success=function(e){if(a.removeClass("bwfan_loading"),o.hide(),0==e.success){var i="<label>"+e.response+"</label>",r=a.closest(".bwfan_forms_global_settings").find(".bwfan-response-failure");return r.fadeIn().html(i),void setTimeout(function(){r.fadeOut("slow")},2500)}a.closest(".bwfan_forms_global_settings").find(".bwfan-response-success").html(e.response),t(document).on("click",".bwfan_sync_old_data_anchor",function(){t(this).addClass("bwfan_btn_spin");var a=t(this),n=t(this).closest("form.bwfan_sync_old_data"),e=n.find("input[type=submit]").attr("data-step"),s=n.find("input[type=submit]").attr("data-next"),o=n.find("input[name=page]").val();void 0===o&&(o="autonami");var i=n.find("#from_date").val(),r=n.find("#to_date").val();if(""===i||""===r)return t(".bwfan_sync_old_data_anchor").removeClass("bwfan_btn_spin"),swal({title:"",text:"Please select from and to date",type:"error"}),!1;var c=BWFAN_Actions.validate_checkboxes(".bwfan_sync_old_data .bwfan-checkbox");if(!1===c)return t(".bwfan_sync_old_data_anchor").removeClass("bwfan_btn_spin"),!1;var l=t(".bwfan_sync_step"+e),f=t(".bwfan_sync_step"+s),w=new FormData(n[0]);return w.append("step",e),t.ajax({url:bwfanParams.ajax_url,type:"POST",data:w,contentType:!1,cache:!1,processData:!1,success:function(s){if(t(".bwfan_sync_old_data_anchor").removeClass("bwfan_btn_spin"),0==s.show_content||0==s.status)n.find("input[type=submit]").attr("data-step",1),n.find("input[type=submit]").attr("data-next",2),swal({title:"",text:s.msg,type:"error"});else if(2==e){var i=bwfanParams.admin_url+"admin.php?page="+o+"&tab=batch_process";swal({title:"",text:s.msg,type:"success"}),setTimeout(function(){window.location.href=i},3e3)}else if(1==e){var r=swal({title:"",text:s.msg,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, proceed.",confirmButtonClass:"bwfan_btn bwfan_btn_red",cancelButtonClass:"bwfan_btn bwfan_btn_grey",cancelButtonText:"No",allowOutsideClick:!1});r.then(function(t){t&&(n.find("input[type=submit]").attr("data-step",2),n.find("input[type=submit]").attr("data-next","last"),l.hide(),f.show(),a.trigger("click"))}),r.catch(function(){console.log("no")})}}}),!1}),n(),s()}}}),t(".bwfan_ab_exclude_roles").select2()}),t(document).ready(function(){var n,s,i;!function(){if(t(".bwfan-select-unsubscribe-page").length>0){var n={minimumInputLength:2,tags:!1,data:[],escapeMarkup:function(t){return t},ajax:{url:ajaxurl,dataType:"json",type:"POST",delay:250,data:function(t){return{search_term:t,action:"bwfan_select_unsubscribe_page"}},success:function(t){return{results:t.results}}}};t(".bwfan-select-unsubscribe-page").select2(n)}if(t("#modal-update-automation").length>0&&"off"==bwfan_automation_data.automation_sync_state){var e=a("Update Automation","autonami-automation");t("#modal-update-automation").iziModal({title:e,headerColor:"#f3f8f9",background:"#ffffff",borderBottom:!1,history:!1,width:600,radius:20,overlayColor:"rgba(0, 0, 0, 0.6)",transitionIn:"comingIn",transitionOut:"comingOut",navigateCaption:!0,navigateArrows:"false",onOpening:function(t){t.startLoading()},onOpened:function(a){a.stopLoading(),t("form.bwfan_update_automation").show(),t(".bwfan-automation-create-success-wrap").hide(),t(".bwfan_submit_btn_style").text("Update")}})}if(t("#modal-show-merge-tags").length>0){var s=a("Merge Tags","autonami-automation");t("#modal-show-merge-tags").iziModal({title:s,headerColor:"#f3f8f9",background:"#ffffff",borderBottom:!1,history:!1,width:600,radius:5,overlayColor:"rgba(0, 0, 0, 0.6)",transitionIn:"none",navigateCaption:!0,navigateArrows:"false",onClosed:function(){t("#bwfan-merge-tag-settings").html(""),t("input.search_merge_tag").val(""),t("table.bwfan-table-merge-tags tr").css("display","inline-block");var a=t("#modal-show-merge-tags h2.iziModal-header-title");a.text("Merge Tags"),a.css("padding-left","0px"),t(".bwfan-merge-tag-list").show()}})}if(t("#modal-show-task-details").length>0){var o=a("Task Details","autonami-automation");t("#modal-show-task-details").iziModal({title:o,headerColor:"#f3f8f9",background:"#ffffff",borderBottom:!1,history:!1,width:600,radius:20,overlayColor:"rgba(0, 0, 0, 0.6)",transitionIn:"comingIn",transitionOut:"comingOut",navigateCaption:!0,navigateArrows:"false"})}if(t("#modal-show-abandoned-cart-details").length>0){var i=a("Abandoned Cart","autonami-automation");t("#modal-show-abandoned-cart-details").iziModal({title:i,headerColor:"#f3f8f9",background:"#ffffff",borderBottom:!1,history:!1,width:600,radius:20,overlayColor:"rgba(0, 0, 0, 0.6)",transitionIn:"comingIn",transitionOut:"comingOut",navigateCaption:!0,navigateArrows:"false"})}if(t("#modal-show-recovered-cart-details").length>0){var r=a("Recovered Cart","autonami-automation");t("#modal-show-recovered-cart-details").iziModal({title:r,headerColor:"#f3f8f9",background:"#ffffff",borderBottom:!1,history:!1,width:600,radius:20,overlayColor:"rgba(0, 0, 0, 0.6)",transitionIn:"comingIn",transitionOut:"comingOut",navigateCaption:!0,navigateArrows:"false"})}if(t("#modal-plus-icon-add").length>0){var c=a("What's Next?","autonami-automation");t("#modal-plus-icon-add").iziModal({title:c,headerColor:"#ffffff",background:"#ffffff",borderBottom:!1,history:!1,width:410,radius:6,overlayColor:"rgba(0, 0, 0, 0)",transitionIn:"",transitionOut:"",transitionInOverlay:"",transitionOutOverlay:"",navigateCaption:!0,closeButton:!1,navigateArrows:"closeToModal",onClosed:function(){t("#modal-plus-icon-add").find(".bwfan_add_block_wrap").attr("data-ui","")}})}t("#modal_automation_success").length>0&&t("#modal_automation_success").iziModal({icon:"icon-check",headerColor:"#6dbe45",background:"#ffffff",borderBottom:!1,width:600,radius:5,timeout:2e3,timeoutProgressbar:!0,transitionIn:"comingIn",transitionOut:"comingOut",bottom:0,loop:!0,pauseOnHover:!0,overlay:!1});t("#modal-show-upgrade-to-pro").length>0&&t("#modal-show-upgrade-to-pro").iziModal({icon:"icon-check",headerColor:"#6dbe45",background:"#ffffff",borderBottom:!1,width:600,radius:5,timeoutProgressbar:!0,transitionIn:"comingIn",transitionOut:"comingOut",navigateCaption:!0,navigateArrows:"false",closeButton:!1})}(),t(".bwfan_ab_email_consent").on("click",function(){t(".bwfan_ab_email_consent_message").toggleClass("bwfan_hide")}),t(".bwfan_user_consent").on("click",function(){t(".bwfan_user_consent_html").toggleClass("bwfan_hide")}),t(".bwfan_ab_enable").on("click",function(){t(".bwfan_ab_enable_html").toggleClass("bwfan_hide")}),t(".bwfan_ab_exclude_users_cart_tracking").on("click",function(){t(".bwfan_ab_exclude_roles_cart_tracking").toggleClass("bwfan_hide"),t(".bwfan_ab_exclude_emails_cart_tracking").toggleClass("bwfan_hide")}),function(){if(0===t(".bwfan_add_automation").length)return;var a=new bwf_ajax(".bwfan_add_automation",!0);a.before_send=function(){t(".bwfan_submit_btn_style").addClass("bwfan_btn_spin")},a.success=function(a){!0===a.status?(t("form.bwfan_add_automation").hide(),t(".bwfan-automation-create-success-wrap").show(),setTimeout(function(){window.location.href=a.redirect_url},3e3)):t(".bwfan_form_response").html(a.msg)}}(),n=e("bitly"),s=e("access_token"),i=e("apiKey"),!1!==n&&!1!==s&&!1!==i&&(swal({type:"success",title:"",text:bwfanParams.bitly_success_authentication_message,showConfirmButton:!1}),setTimeout(function(){window.location.href=bwfanParams.connector_page_url},2e3)),setTimeout(function(){!function(){if(0==t(".bwfan-endpoints-status-settings").length)return;var a=new bwf_ajax,n={};t(".bwfan-woofunnels-worker-status").addClass("bwfan_btn_spin"),t(".bwfan-woofunnels-cache-status").addClass("bwfan_btn_spin"),a.ajax("bwfan_api_woofunnels_working",n),a.success=function(e){1==e.status?(t(".bwfan-woofunnels-worker-status").removeClass("bwfan_btn_spin"),t(".bwfan-woofunnels-worker-status").append('<div class="bwfan_success">Working</div>'),setTimeout(function(){n={time:e.time},a.ajax("bwfan_api_woofunnels_working",n),a.success=function(a){1==a.status&&!1===a.cached?(t(".bwfan-woofunnels-cache-status").removeClass("bwfan_btn_spin"),t(".bwfan-woofunnels-cache-status").append('<div class="bwfan_success">No cached</div>')):(t(".bwfan-woofunnels-cache-status").removeClass("bwfan_btn_spin"),t(".bwfan-woofunnels-cache-status").append('<div class="bwfan_error">Cached</div>'))}},500)):(t(".bwfan-woofunnels-worker-status").removeClass("bwfan_btn_spin"),t(".bwfan-woofunnels-cache-status").removeClass("bwfan_btn_spin"),t(".bwfan-woofunnels-worker-status").append('<div class="bwfan_error">'+e.msg+"</div>"),t(".bwfan-woofunnels-cache-status").append('<div class="bwfan_error">'+e.msg+"</div>"))}}()},500),setTimeout(function(){!function(){if(0==t(".bwfan-endpoints-status-settings").length)return;var a=new bwf_ajax,n={};t(".bwfan-autonami-worker-status").addClass("bwfan_btn_spin"),t(".bwfan-autonami-cache-status").addClass("bwfan_btn_spin"),a.ajax("bwfan_autonami_working",n),a.success=function(e){1==e.status?(t(".bwfan-autonami-worker-status").removeClass("bwfan_btn_spin"),t(".bwfan-autonami-worker-status").append('<div class="bwfan_success">Working</div>'),setTimeout(function(){n={time:e.time},a.ajax("bwfan_autonami_working",n),a.success=function(a){1==a.status&&!1===a.cached?(t(".bwfan-autonami-cache-status").removeClass("bwfan_btn_spin"),t(".bwfan-autonami-cache-status").append('<div class="bwfan_success">No cached</div>')):(t(".bwfan-autonami-cache-status").removeClass("bwfan_btn_spin"),t(".bwfan-autonami-cache-status").append('<div class="bwfan_error">Cached</div>'))}},500)):(t(".bwfan-autonami-worker-status").removeClass("bwfan_btn_spin"),t(".bwfan-autonami-cache-status").removeClass("bwfan_btn_spin"),t(".bwfan-autonami-worker-status").append('<div class="bwfan_error">'+e.msg+"</div>"),t(".bwfan-autonami-cache-status").append('<div class="bwfan_error">'+e.msg+"</div>"))}}()},500),setTimeout(function(){!function(){if(0==t(".bwfan-endpoints-status-settings").length)return;var a=new bwf_ajax,n={};t(".bwfan-event-worker-status").addClass("bwfan_btn_spin"),t(".bwfan-event-cache-status").addClass("bwfan_btn_spin"),a.ajax("bwfan_event_working",n),a.success=function(e){1==e.status?(t(".bwfan-event-worker-status").removeClass("bwfan_btn_spin"),t(".bwfan-event-worker-status").append('<div class="bwfan_success">Working</div>'),setTimeout(function(){n={time:e.time},a.ajax("bwfan_event_working",n),a.success=function(a){1==a.status&&!1===a.cached?(t(".bwfan-event-cache-status").removeClass("bwfan_btn_spin"),t(".bwfan-event-cache-status").append('<div class="bwfan_success">No cached</div>')):(t(".bwfan-event-cache-status").removeClass("bwfan_btn_spin"),t(".bwfan-event-cache-status").append('<div class="bwfan_error">Cached</div>'))}},500)):(t(".bwfan-event-worker-status").removeClass("bwfan_btn_spin"),t(".bwfan-event-cache-status").removeClass("bwfan_btn_spin"),t(".bwfan-event-cache-status").append('<div class="bwfan_error">'+e.msg+"</div>"),t(".bwfan-event-worker-status").append('<div class="bwfan_error">'+e.msg+"</div>"))}}()},500);var r='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 130.2 130.2" class="bwfan_svg_loader" data-state="error">';r+='<circle fill="none" stroke="#ffb7bf" stroke-width="6" stroke-miterlimit="10" cx="65.1" cy="65.1" r="62.1" class="path circle"></circle>',r+='<line fill="none" stroke="#e64155" stroke-width="8" stroke-linecap="round" stroke-miterlimit="10" x1="34.4" y1="37.9" x2="95.8" y2="92.3" class="path line"></line>',r+='<line fill="none" stroke="#e64155" stroke-width="8" stroke-linecap="round" stroke-miterlimit="10" x1="95.8" y1="38" x2="34.4" y2="92.2" class="path line"></line>',r+="</svg>";var c='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 130.2 130.2" class="bwfan_svg_loader" data-state="success">';(c+='<circle fill="none" stroke="#b7e6bb" stroke-width="5" stroke-miterlimit="10" cx="65.1" cy="65.1" r="62.1" class="path circle"></circle>',c+='<polyline fill="none" stroke="#39c359" stroke-width="9" stroke-linecap="round" stroke-miterlimit="10" points="100.2,40.2 51.5,88.8 29.8,67.5 " class="path check"></polyline>',c+="</svg>",t("body").on("click",".bwfan_update_form_submit",function(){t(this).addClass("bwfan_btn_spin"),t("form.bwfan_update_automation").trigger("submit")}),t(".bwfan_update_automation").length>0)&&(new bwf_ajax(".bwfan_update_automation",!0).success=function(a){!0===a.status?(t("form.bwfan_update_automation").hide(),t(".bwfan-automation-create-success-wrap").show(),t("#bwfan_automation_name").text(a.automation_name),t("#modal-update-automation").iziModal("close")):t(".bwfan_form_response").html(a.msg),t(".bwfan_update_form_submit.bwfan_btn_spin").removeClass("bwfan_btn_spin")});t(".bwfan_r_tabs").length>0&&t(".bwfan_r_tabs li a").on("click",function(){t(".bwfan_r_tabs li a.bwfan_r_t_active").removeClass("bwfan_r_t_active"),t(this).addClass("bwfan_r_t_active")}),o(),t("body").on("click",".bwfan_r_tabs li a",function(){t(".bwfan-pagination-wrap").find(".bwfan-pagination").attr("data-page",1),o()}),t("body").on("change",".bwfan_r_t select",function(){t(".bwfan-pagination-wrap").find(".bwfan-pagination").attr("data-page",1),o()}),t("body").on("click",".bwfan_pagination_click",function(){var a=t(this),n=t(".bwfan-pagination-wrap"),e=a.attr("data-page");n.find(".bwfan-pagination").attr("data-page",e),o()}),t("body").on("click",".bwfan_r_s_action > a",function(){var n="<div class='bwfan_r_load'></div>",e=t("#modal-show-recipe-import #bwfan-recipe-import");if(t("#modal-show-recipe-import").length>0){var s=a("Processing Recipe Import","autonami-automation");t("#modal-show-recipe-import").iziModal({title:s,headerColor:"#f3f8f9",background:"#ffffff",borderBottom:!1,history:!1,overlayClose:!1,width:600,radius:20,overlayColor:"rgba(0, 0, 0, 0.6)",transitionIn:"comingIn",transitionOut:"comingOut",navigateCaption:!1,navigateArrows:"false",onOpening:function(){(e=t("#modal-show-recipe-import #bwfan-recipe-import")).html(n+'<div class="bwfan_heading_m bwfan_tc">'+a("Checking Dependencies","wp-marketing-automations")+"</div>")}})}var o=new bwf_ajax,i=t(this).data("slug"),l={slug:i,_wpnonce:bwfanParams.ajax_nonce};setTimeout(function(){o.ajax("recipe_dependency_check",l)},1e3),o.success=function(s){if(e=t("#modal-show-recipe-import #bwfan-recipe-import"),!1===s.status){var o=r+"<div class='bwfan_heading_m bwfan_tc'>"+a("Oops! Unable to Import the Recipe","wp-marketing-automations")+"</div>";return _.has(s,"error_data")&&_.size(s.error_data)>0&&(o+="<div class='bwfan_bg_red_alrt'>",_.each(s.error_data,function(t){!1===_.isEmpty(t)&&(o+="<p>- "+t+"</p>")}),o+="</div>"),void e.html(o)}e.html(n+'<div class="bwfan_heading_m bwfan_tc">'+s.msg+"</div>"),setTimeout(function(){!function(n,e){var s=t("#modal-show-recipe-import #bwfan-recipe-import");s.html(e+'<div class="bwfan_heading_m bwfan_tc">'+a("Importing Recipe","wp-marketing-automations")+"</div>");var o=new bwf_ajax,i={slug:n,_wpnonce:bwfanParams.ajax_nonce};o.ajax("importing_recipe",i),o.success=function(n){if(s=t("#modal-show-recipe-import #bwfan-recipe-import"),!1===n.status){var e=r+"<div class='bwfan_heading_m bwfan_tc'>"+a("Oops! Unable to import the recipe","wp-marketing-automations")+"</div>";return e+="<div class='bwfan_bg_red_alrt'><p>"+n.msg+"</p></div>",void s.html(e)}s.html(c+'<div class="bwfan_heading_m bwfan_tc">'+n.msg+"</div>"),setTimeout(function(){window.location.href=n.redirect_url},500)}}(i,n)},1e3)}}),t("body").on("click",".bwfan_start_scratch",function(){t("a.page-title-action").trigger("click")})}),t(window).on("load",function(){!function(){var a=t(".bwfan-loader");if(0===a.length)return;a.each(function(){var a=t(this);a.is(":visible")&&setTimeout(function(){a.remove()},400)})}(),function(){if(t(".bwfan-product-widget-tabs").length>0){var a=t(".bwfan-tab-title");a.on("click",function(){var n=t(this).attr("id");a.removeClass("current"),t(this).addClass("current"),t(".bwfan-tab-content").hide().removeClass("bwfan-activeTab"),t('.bwfan-tab-content[setting-id="'+n+'"]').show().addClass("bwfan-activeTab")}),a.eq(0).trigger("click")}}(),function(){var a=t(".automation_state_toggle .bwfan-tgl, .bwfan_fsetting_table_title .bwfan-tgl");if(0===a.length)return;a.on("click",function(a){var n,e=t(this).attr("data-sync-state");if("on"===e)return swal({title:window.bwfan.texts.sync_oops_title,text:window.bwfan.texts.sync_process_oops_title,type:"error"}),void a.preventDefault();!0===this.checked?(t(".bwfan_head_automation_state_on").length>0&&t(".bwfan_head_automation_state_on").show(),t(".bwfan_head_automation_state_off").length>0&&t(".bwfan_head_automation_state_off").hide(),t(".bwfan_head_mr").length&&t(".bwfan_head_mr").attr("data-status","live"),n=window.bwfan.texts.activated):(t(".bwfan_head_automation_state_on").length>0&&t(".bwfan_head_automation_state_on").hide(),t(".bwfan_head_automation_state_off").length>0&&t(".bwfan_head_automation_state_off").show(),t(".bwfan_head_mr").length>0&&t(".bwfan_head_mr").attr("data-status","sandbox"),n=window.bwfan.texts.deactivated);var s=new bwf_ajax,o={state:this.checked.toString(),id:t(this).attr("data-id"),_wpnonce:bwfanParams.ajax_nonce};s.ajax("toggle_automation_state",o),s.success=function(){var a=t("#modal_automation_success");a.length>0&&(a.iziModal("setTitle",n),a.iziModal("open"))}})}(),t(document).on("click",".bwfan-delete-automation",function(){var a=t(this).attr("data-id"),n=swal({title:window.bwfan.texts.delete_automation_title,text:window.bwfan.texts.delete_automation_text,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, proceed",confirmButtonClass:"bwfan_btn bwfan_btn_red",cancelButtonClass:"bwfan_btn bwfan_btn_grey",cancelButtonText:"No",allowOutsideClick:!1});n.then(function(t){if(t){swal({title:window.bwfan.texts.delete_automation_wait_title,text:window.bwfan.texts.delete_automation_wait_text,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,onOpen:function(){swal.showLoading()}});var n=new bwf_ajax;n.ajax("handle_delete_automation",{id:a,_wpnonce:bwfanParams.ajax_nonce}),n.success=function(t){!0===t.status?(swal({title:window.bwfan.texts.delete_automation_success,type:"success",showConfirmButton:!1}),setTimeout(function(){window.location.reload()},1e3)):swal({title:window.bwfan.texts.sync_oops_title,text:window.bwfan.texts.sync_oops_text,type:"error"})}}}),n.catch(function(){console.log("no")})}),t(document).on("click",".bwfan-delete-batch-process",function(){var a=t(this).attr("data-id"),n=swal({title:window.bwfan.texts.delete_batch_process_title,text:window.bwfan.texts.delete_batch_process_text,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, proceed",confirmButtonClass:"bwfan_btn bwfan_btn_red",cancelButtonClass:"bwfan_btn bwfan_btn_grey",cancelButtonText:"No",allowOutsideClick:!1});n.then(function(t){if(t){swal({title:window.bwfan.texts.delete_batch_process_wait_title,text:window.bwfan.texts.delete_batch_process_wait_text,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,onOpen:function(){swal.showLoading()}});var n=new bwf_ajax;n.ajax("handle_delete_batch_process",{id:a,_wpnonce:bwfanParams.ajax_nonce}),n.success=function(t){if(!0===t.status)swal({title:window.bwfan.texts.delete_batch_process_success,type:"success",showConfirmButton:!1}),setTimeout(function(){window.location.reload()},1e3);else{var a=""!=t.msg?t.msg:window.bwfan.texts.sync_oops_text;swal({title:window.bwfan.texts.sync_oops_title,text:a,type:"error"})}}}}),n.catch(function(){console.log("no")})}),t(document).on("click",".bwfan-terminate-batch-process",function(){var a=t(this).attr("data-id"),n=swal({title:window.bwfan.texts.terminate_batch_process_title,text:window.bwfan.texts.terminate_batch_process_text,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, proceed",confirmButtonClass:"bwfan_btn bwfan_btn_red",cancelButtonClass:"bwfan_btn bwfan_btn_grey",cancelButtonText:"No",allowOutsideClick:!1});n.then(function(t){if(t){swal({title:window.bwfan.texts.terminate_batch_process_wait_title,text:window.bwfan.texts.terminate_batch_process_wait_text,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,onOpen:function(){swal.showLoading()}});var n=new bwf_ajax;n.ajax("handle_terminate_batch_process",{id:a,_wpnonce:bwfanParams.ajax_nonce}),n.success=function(t){if(!0===t.status)swal({title:window.bwfan.texts.terminate_batch_process_success,type:"success",showConfirmButton:!1}),setTimeout(function(){window.location.reload()},1e3);else{var a=""!=t.msg?t.msg:window.bwfan.texts.sync_oops_text;swal({title:window.bwfan.texts.sync_oops_title,text:a,type:"error"})}}}}),n.catch(function(){console.log("no")})}),t(document).on("click",".bwfan-preview",function(){var a,n=t(this),e=n.data("task-id");if(_.has(bwfan_task_table_local,"tasks")||_.has(bwfan_task_table_local,"logs")){var s=n.data("task-type");a=bwfan_task_table_local[s][e]}else a=bwfan_task_table_local[e];var o=a.task_message;0==t(o).length&&(o=0);var i=a.task_details,r=wp.template("bwfan-task-popup");t("#bwfan-task-section").html(""),bwfan_make_html(1,"#bwfan-task-section",r({details:a,task_message:o})),t(".bwfan_task_details").html(i)}),t(document).on("click",".bwfan-run-task",function(){var a=t(this),n=t(this).attr("data-task-id");a.siblings(".bwfan-gif-task-delete").show();var e=new bwf_ajax;e.ajax("run_task",{id:n}),e.success=function(t){1==t.status?(a.parent(".column-execute").parent(".bwfan_automation").remove(),swal({title:window.bwfan.texts.task_executed_success,type:"success",showConfirmButton:!1}),setTimeout(function(){window.location.reload()},1e3)):swal({title:window.bwfan.texts.sync_oops_title,text:t.msg,type:"error"}),a.siblings(".bwfan-gif-task-delete").hide()}}),t(document).on("click",".bwfan-delete-task",function(){var a=t(this),n=t(this).attr("data-task-id"),e=swal({title:window.bwfan.texts.task_delete_title,text:window.bwfan.texts.task_delete_text,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, proceed.",confirmButtonClass:"bwfan_btn bwfan_btn_red",cancelButtonClass:"bwfan_btn bwfan_btn_grey",cancelButtonText:"No",allowOutsideClick:!1});e.then(function(t){if(t){a.siblings(".bwfan-gif-task-delete").show();var e=new bwf_ajax;e.ajax("delete_task",{id:n,_wpnonce:bwfanParams.ajax_nonce}),e.success=function(t){!0===t.status?(a.parent(".column-execute").parent(".bwfan_automation").addClass("bwfan_removed"),a.parent(".column-execute").parent(".bwfan_automation").hide(900)):swal({title:window.bwfan.texts.sync_oops_title,text:t.msg,type:"error"}),a.siblings(".bwfan-gif-task-delete").hide()}}}),e.catch(function(){})}),t(document).on("click",".bwfan_collapse",function(){var a=t(this),n=a.parents(".bwfan_body");n.hasClass("bwfan_collapsed")?n.removeClass("bwfan_collapsed"):n.addClass("bwfan_collapsed"),setTimeout(function(){var a=100,n=t(".wr").offset().left;t(".bwfan_body").hasClass("bwfan_collapsed")&&(a=50),a+=t(".wr_slide_pane").width(),t("#adminmenuwrap").length>0&&(a+=t("#adminmenuwrap").outerWidth()),t(".wr_slide_pane").css("left",n-a)},500)}),t(document).on("click",".bwfan-run-log",function(){var a=t(this),n=t(this).attr("data-log-id");a.siblings(".bwfan-gif-task-delete").show();var e=new bwf_ajax;e.ajax("run_log",{id:n,_wpnonce:bwfanParams.ajax_nonce}),e.success=function(e){t(".time-run-"+n).html(window.bwfan.texts.task_executed_just);var s=t(".status-"+n);!0===e.status?(swal({title:window.bwfan.texts.task_executed_success,type:"success"}),s.removeClass("dashicons-no-alt").addClass("dashicons-yes").attr("title","Executed Successfully")):(swal({title:window.bwfan.texts.sync_oops_title,text:e.msg,type:"error"}),s.removeClass("dashicons-yes").addClass("dashicons-no-alt").attr("title","Execution Failed")),a.siblings(".bwfan-gif-task-delete").hide()}}),t(document).on("click",".bwfan-delete-log",function(){var a=t(this),n=t(this).attr("data-log-id"),e=swal({title:window.bwfan.texts.task_delete_title,text:window.bwfan.texts.task_delete_text,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, proceed.",confirmButtonClass:"bwfan_btn bwfan_btn_red",cancelButtonClass:"bwfan_btn bwfan_btn_grey",cancelButtonText:"No, Revert.",allowOutsideClick:!1});e.then(function(t){if(t){a.siblings(".bwfan-gif-task-delete").show();var e=new bwf_ajax;e.ajax("delete_log",{id:n,_wpnonce:bwfanParams.ajax_nonce}),e.success=function(t){!0===t.status?(a.parent(".column-execute").parent(".bwfan_automation").addClass("bwfan_removed"),a.parent(".column-execute").parent(".bwfan_automation").hide(900)):swal({title:window.bwfan.texts.sync_oops_title,text:t.msg,type:"error"}),a.siblings(".bwfan-gif-task-delete").hide()}}}),e.catch(function(){})}),function(){if(t(".bwfan_show_toastr").length>0){var a=t(".bwfan_show_toastr").attr("data-msg"),n=t("#modal_automation_success");n.length>0&&(n.iziModal("setTitle",a),n.iziModal("open"));var s=e("tab"),o=e("status"),i=e("section"),r=e("edit"),c=bwfanParams.admin_url+"admin.php?page=autonami";void 0!==s&&0!=s&&(c=c+"&tab="+s),void 0!==o&&0!=o&&(c=c+"&status="+o),void 0!==i&&0!=i&&(c=c+"&section="+i),void 0!==r&&0!=r&&(c=c+"&edit="+r),function(t,a){if(void 0!==history.pushState){var n={Title:t,Url:a};history.pushState("","",n.Url)}else alert("Browser does not support HTML5.")}("",c)}}(),t(document).on("click",".bwfan_save_global_settings",function(){var a=t(this),n=t(".bwfan_forms_global_settings");n[0].checkValidity()?(a.addClass("bwfan_btn_spin"),n.trigger("submit")):n.find(":submit").click()}),new bwf_ajax(".bwfan_forms_global_settings",!0).success=function(a){if(t(".bwfan_save_btn_style").removeClass("bwfan_btn_spin"),!0===a.status)return swal({type:"success",title:"",text:"Settings saved",showConfirmButton:!1}),void setTimeout(function(){window.location.reload()},1e3);swal({type:"error",title:window.bwfan.texts.sync_oops_title,text:a.msg})},n(),s(),t(".bwfan_automation_setting_inner").removeClass("bwfan-page-loading")}),t(document).on("click",".bwfan_regenerate_tables",function(){t(".bwfan_regenerate_tables").addClass("bwfan_btn_spin"),t.ajax({method:"post",url:bwfanParams.ajax_url,data:{action:"bwfan_regenerate_tables"},success:function(a){1==a.status?(t(".bwfan_regenerate_tables").removeClass("bwfan_btn_spin"),setTimeout(function(){location.reload()},1e3)):t(".bwfan_regenerate_tables").removeClass("bwfan_btn_spin")}})}),t(document).on("click",".bwf-ellipsis-menu.bwf-ellipsis--alter-alter .bwf-ellipsis-menu__toggle",function(){t(this).parents(".bwf-ellipsis--alter-alter").toggleClass("show-menu")}),t(document).on("click",function(a){t(".bwf-ellipsis-menu.bwf-ellipsis--alter-alter").length&&(a.target.matches(".bwf-ellipsis-menu__toggle")||a.target.closest(".bwf-ellipsis-menu__toggle")||t(".bwf-ellipsis-menu.bwf-ellipsis--alter-alter").removeClass("show-menu"))})}(jQuery);