"use strict";var BWFAN_Auto;!function(t){(BWFAN_Auto={mainElem:"",rightElemTop:"",rightElem:"",ui:{},uiData:[],uiDataDetail:{},uiCopiedAction:{},sidebarMsg:{select_event:{head:"Select an Event",desc:"This Automation would run every time when this Event occurs."},selected_event:{head:"Selected Event Name",desc:"This Automation would run every time when a new WooCommerce order is created."},select_condition:{head:"Select Conditions",desc:"Take different actions based on the conditions you set."},select_actions:{head:"Select Actions",desc:"Select Actions which you want to run."},select_action:{head:"Select an Action",desc:"Choose from below list of Actions which you want to run."},select_block:{head:"Select Action Block",desc:"Click on + icon to select the Action block (Direct or Conditional)."}},cancelledElementObject:{},cancelledElementData:{},actionCopied:"",init:function(){this.dom_ready(),this.win_load(),this.dom_click()},buildAutomation:function(){var i,e;if(0==_.size(_.keys(this.uiData)))return i=wp.template("add_trigger"),this.mainElem.html(i({ui:0})),e=this.getSidebarTopTextArr("select_event"),void BWFAN_Auto.setSidebarTopText(e);this.mainElem.html(""),e={},e=2===_.size(BWFAN_Auto.uiData)?BWFAN_Auto.getSidebarTopTextArr("select_block"):!1===_.isUndefined(BWFAN_Auto.uiDataDetail.trigger)&&_.size(BWFAN_Auto.uiDataDetail.trigger)>0?BWFAN_Auto.getSidebarTopTextArr("selected_event"):BWFAN_Auto.getSidebarTopTextArr("select_event"),BWFAN_Auto.setSidebarTopText(e),t.each(this.uiData,function(e,a){var n=a.group_id,o={},u="",c="";switch(a.id){case"trigger":_.isUndefined(BWFAN_Auto.uiDataDetail.trigger)||0===_.size(BWFAN_Auto.uiDataDetail.trigger)?(i=wp.template("select_trigger"),BWFAN_Auto.mainElem.append(i({ui:e}))):(i=wp.template("selected_trigger"),u=BWFAN_Actions.get_action_name("event_text",BWFAN_Auto.uiDataDetail.trigger.source,BWFAN_Auto.uiDataDetail.trigger.event),BWFAN_Auto.mainElem.append(i({ui:e,trigger_name:u})));break;case"condition":_.isUndefined(BWFAN_Auto.uiDataDetail.condition)||_.isUndefined(BWFAN_Auto.uiDataDetail.condition[n])||0===_.size(BWFAN_Auto.uiDataDetail.condition[n])?(i=wp.template("select_condition"),o=!1===_.isUndefined(BWFAN_Auto.uiDataDetail.actions[n])&&_.size(BWFAN_Auto.uiDataDetail.actions[n])>0?BWFAN_Auto.uiDataDetail.actions[n]:{},BWFAN_Auto.mainElem.append(i({ui:e,group_id:n,actions:o}))):(i=wp.template("selected_condition"),c=_.isUndefined(bwfan_app.Views[n])?"":bwfan_app.Views[n].GetUiText(),o=!1===_.isUndefined(BWFAN_Auto.uiDataDetail.actions[n])&&_.size(BWFAN_Auto.uiDataDetail.actions[n])>0?BWFAN_Auto.uiDataDetail.actions[n]:{},BWFAN_Auto.mainElem.append(i({ui:e,group_id:n,rulesHtml:c,actions:o})));break;case"action":i=wp.template("action_only"),o=!1===_.isUndefined(BWFAN_Auto.uiDataDetail.actions[n])&&_.size(BWFAN_Auto.uiDataDetail.actions[n])>0?BWFAN_Auto.uiDataDetail.actions[n]:{},BWFAN_Auto.mainElem.append(i({ui:e,group_id:n,actions:o}))}!1===_.isUndefined(a.html)&&_.size(a.html)>0&&t.each(a.html,function(t,e){switch(e){case"gap":i=wp.template("vertical_line_gap"),BWFAN_Auto.mainElem.append(i);break;case"gap_top":i=wp.template("vertical_line_gap_top"),BWFAN_Auto.mainElem.append(i);break;case"add_block":i=wp.template("add_block"),BWFAN_Auto.mainElem.append(i);break;case"no_html":i=wp.template("no_html"),BWFAN_Auto.mainElem.append(i);break;case"end_html":i=wp.template("end_html"),BWFAN_Auto.mainElem.append(i)}})})},modifyTrigger:function(){this.emptySidebar(),BWFAN_Auto.slideSidebar("open"),t(document).trigger("bwfan_trigger_modified")},modifyCondition:function(i){this.emptySidebar(),BWFAN_Auto.slideSidebar("open");var e=this.getGroupIndex(i),a=this.getUIIndex(i),n=jQuery.extend(!0,{},this.uiDataDetail.condition[e]);n.group_id=e,n.ui_id=a,t(document).trigger("bwfan_condition_modified",[e,a])},addAction:function(t,i){var e;e=wp.template("select_action"),t.append(e({action_id:i})),_.has(BWFAN_Auto.uiCopiedAction,"data")&&t.find(".item_paste_action").length>0&&t.find(".item_paste_action").remove(),e=wp.template("add_action"),t.append(e)},modifyAction:function(i){this.emptySidebar();var e=this.getGroupIndex(i),a=this.getActionIndex(i);if(!1!==this.hasActionSelected(e,a))""===BWFAN_Auto.actionCopied?BWFAN_Auto.slideSidebar("open"):(BWFAN_Auto.removeActiveStates(),BWFAN_Auto.actionCopied=""),t(document).trigger("bwfan_action_modified",[e,a]);else{var n=t("#modal-autonami-event-action");n.length>0&&(n.iziModal("open"),n.find("input[name='selected_action_group_id']").val(e),n.find("input[name='selected_action_action_id']").val(a))}},removeAction:function(t,i){var e=this.getGroupIndex(t),a=this.getActionIndex(t);this.uiDataDetail.actions[e].hasOwnProperty(a)&&delete this.uiDataDetail.actions[e][a],2===i&&0===_.size(this.uiDataDetail.actions[e])&&(this.uiDataDetail.actions[e]={}),t.parents(".item_modify_action").remove()},hasActionSelected:function(t,i){return!1!==_.has(BWFAN_Auto.uiDataDetail.actions,t)&&(!1!==_.has(BWFAN_Auto.uiDataDetail.actions[t],i)&&(!1!==_.has(BWFAN_Auto.uiDataDetail.actions[t][i],"action_slug")&&""!==BWFAN_Auto.uiDataDetail.actions[t][i].action_slug))},setTriggerData:function(t,i){_.isEmpty(t)?this.uiDataDetail.trigger=i:this.uiDataDetail.trigger[t]=i},getTriggerData:function(t){return _.isEmpty(t)?this.uiDataDetail.trigger:this.uiDataDetail.trigger[t]},setActionData:function(t,i,e){_.each(e,function(t,i){e[i]=BWFAN_Auto.isJSON(t)?JSON.parse(t):t}),!1!==_.isUndefined(i)?this.uiDataDetail.actions[t]=e:this.uiDataDetail.actions[t][i]=e},getActionData:function(t,i){return this.uiDataDetail.actions[t].hasOwnProperty(i)?this.uiDataDetail.actions[t][i]:this.uiDataDetail.actions[t]},setConditionData:function(t,i,e){!1!==_.isUndefined(i)?this.uiDataDetail.condition[t]=e:this.uiDataDetail.condition[t][i]=e},getConditionData:function(t,i){return this.uiDataDetail.condition[t].hasOwnProperty(i)?this.uiDataDetail.condition[t][i]:this.uiDataDetail.condition[t]},setActionFieldData:function(t,i,e,a){_.isUndefined(this.uiDataDetail.actions[t])||_.isUndefined(this.uiDataDetail.actions[t][i])||(this.uiDataDetail.actions[t][i][e]=a)},setActionFieldInnerData:function(t,i,e,a){_.isUndefined(this.uiDataDetail.actions[t])||_.isUndefined(this.uiDataDetail.actions[t][i])||(_.isUndefined(this.uiDataDetail.actions[t][i].data)&&(this.uiDataDetail.actions[t][i].data={}),this.uiDataDetail.actions[t][i].data[e]=a)},setActionFieldAjaxData:function(t,i,e,a){_.isUndefined(this.uiDataDetail.actions[t])||_.isUndefined(this.uiDataDetail.actions[t][i])||(_.isUndefined(this.uiDataDetail.actions[t][i]["ajax-data"])&&(this.uiDataDetail.actions[t][i]["ajax-data"]={}),this.uiDataDetail.actions[t][i]["ajax-data"][e]=a)},setSidebarTopText:function(t){var i=wp.template("bwfan-sidebar-top");BWFAN_Auto.rightElemTop.html(i(t))},getCurrentCol:function(t){return t.parents(".workflow_item_data").index()},getUIIndex:function(t){return t.parents(".workflow_item").attr("data-ui")},getGroupIndex:function(t){return t.parents(".workflow_item").attr("data-group")},getActionIndex:function(t){return t.hasClass("item_modify_action")?t.attr("data-action"):t.parents(".item_modify_action").attr("data-action")},getNewGroupIndex:function(){var t=0;return!1===_.isUndefined(BWFAN_Auto.ui.groupCount)&&(t=parseInt(BWFAN_Auto.ui.groupCount)+1),t},getSidebarTopTextArr:function(t){var i={};return!1===_.isUndefined(this.sidebarMsg[t])&&(i={head:this.sidebarMsg[t].head,desc:this.sidebarMsg[t].desc}),i},getActionDesc:function(t,i){return!0===_.isUndefined(bwfan_automation_data.all_integrations[t])?"":!0===_.isUndefined(bwfan_automation_data.all_integrations[t][i])?"":bwfan_automation_data.all_integrations[t][i].action_desc},emptySidebar:function(){this.rightElem.html("")},slideSidebar:function(i){if("close"===i)return t(".wr").removeClass("wr-expanded"),void t(".wl-sidebar-overlay").fadeOut();t(".wr").addClass("wr-expanded"),t(".wl-sidebar-overlay").fadeIn()},setBlankData:function(){this.uiData=[],this.setBlankUI(),this.setBlankUIDetail()},setBlankUI:function(){this.ui={}},setBlankUIDetail:function(){this.uiDataDetail={trigger:{},actions:{},condition:{}}},removeUIElement:function(t){!1===_.isUndefined(this.uiData[t])&&this.uiData.splice(t,1)},removeGroupElementData:function(t){!1===_.isUndefined(this.uiDataDetail.condition[t])&&delete this.uiDataDetail.condition[t],!1===_.isUndefined(this.uiDataDetail.actions[t])&&delete this.uiDataDetail.actions[t],!1===_.isUndefined(this.ui.actions)&&!1===_.isUndefined(this.ui.actions[t])&&delete this.ui.actions[t]},resizeAfterSlide:function(i,e){t.each(e,function(e,a){t.each(a,function(a,n){var o=parseInt(n.value+parseInt(n.operator+i));t("."+e).css(a,o)})})},dom_ready:function(){t(document).ready(function(){if(BWFAN_Auto.mainElem=t(".wl"),BWFAN_Auto.rightElemTop=t(".wr .wr_t_wrap .wr_tw"),BWFAN_Auto.rightElem=t(".wr .wr_wrap_form"),!1===_.isUndefined(bwfan_automation_ui_data_detail)){if(bwfan_automation_ui_data_detail.trigger.event){var i=!1;if(t.each(bwfan_automation_data.all_triggers_events,function(e,a){t.each(a,function(t){t===bwfan_automation_ui_data_detail.trigger.event&&(i=!0)})}),!1===i)return}BWFAN_Auto.ui=bwfan_automation_ui_data_detail.ui,BWFAN_Auto.uiData=bwfan_automation_ui_data_detail.uiData,delete bwfan_automation_ui_data_detail.ui,delete bwfan_automation_ui_data_detail.uiData,BWFAN_Auto.uiDataDetail=bwfan_automation_ui_data_detail,(_.isUndefined(BWFAN_Auto.uiDataDetail.actions)||""===BWFAN_Auto.uiDataDetail.actions)&&(BWFAN_Auto.uiDataDetail.actions={})}if(void 0!==BWFAN_Auto.uiDataDetail.trigger&&void 0!==BWFAN_Auto.uiDataDetail.trigger.source){BWFAN_Auto.sidebarMsg.selected_event.head=BWFAN_Actions.get_action_name("event_text",BWFAN_Auto.uiDataDetail.trigger.source,BWFAN_Auto.uiDataDetail.trigger.event);var e=BWFAN_Actions.get_event_desc(BWFAN_Auto.uiDataDetail.trigger.source,BWFAN_Auto.uiDataDetail.trigger.event);""!==e&&(BWFAN_Auto.sidebarMsg.selected_event.desc=e)}BWFAN_Auto.re_calc_ui_prop(),t(document).trigger("bwfan_ui_before_load_dom"),BWFAN_Auto.buildAutomation(),t(document).trigger("bwfan_ui_after_load_dom")})},win_load:function(){t(window).on("bind","load",function(){})},dom_click:function(){var i;function e(){var e=i.getBoundingClientRect().top;t("#modal-plus-icon-add").css({"margin-top":e+"px"})}t(document).on("click",".bwfan_modify_event",function(){var i=t(this).attr("tabindex");swal.clickConfirm();var e=BWFAN_Auto.cancelledElementObject,a=BWFAN_Auto.cancelledElementData,n=a.selected_value,o=a.events_merge_tags;"1"==i||"2"==i?(BWFAN_Actions.make_automation_track_id(),BWFAN_Auto.setBlankData(),BWFAN_Auto.uiData.push({id:"trigger",html:{}}),BWFAN_Auto.buildAutomation(),e.attr("data-old",n),BWFAN_Actions.make_merge_tag_ui(n,o),jQuery("#tmpl-event-"+n).length>0?BWFAN_Actions.create_event_meta_ui(n):t(".bwfan-events-meta").html("")):"3"==i&&t(".item_modify_trigger").trigger("click")}),t(document).on("click",".bwfan_delete_block",function(){var i=t(this).attr("tabindex"),e=BWFAN_Auto.cancelledElementObject,a=BWFAN_Auto.cancelledElementData.deleteType;if("3"!=i){swal.clickConfirm();var n=BWFAN_Auto.getUIIndex(e),o=BWFAN_Auto.getGroupIndex(e),u=BWFAN_Auto.get_child_actions(e);"action"!==a&&"condition"!==a||(BWFAN_Auto.removeUIElement(n),BWFAN_Auto.removeGroupElementData(o),BWFAN_Auto.buildAutomation()),BWFAN_Auto.slideSidebar("close"),BWFAN_Auto.emptySidebar(),t('input[name="bwfan_delete_action_opt"]:checked').length>0&&BWFAN_Auto.update_actions_track_id_index(e,u)}else swal.clickCancel()}),t(document).on("click",".bwfan_delete_action",function(){var i=t(this).attr("tabindex"),e=BWFAN_Auto.cancelledElementObject,a=BWFAN_Auto.cancelledElementData.curCol;if("3"!=i){swal.clickConfirm();var n=BWFAN_Auto.getGroupIndex(e),o=BWFAN_Auto.getActionIndex(e);BWFAN_Auto.removeAction(e,a),BWFAN_Auto.slideSidebar("close"),BWFAN_Auto.emptySidebar(),t('input[name="bwfan_delete_action_opt"]:checked').length>0&&BWFAN_Auto.update_actions_track_id_index(e,[n+"_"+o])}else swal.clickCancel()}),t(document).on("click",".item_wrap_single",function(){var i=t(this);t(".item_active").length>0&&t(".item_active").each(function(){t(this).removeClass("item_active")}),i.hasClass("item_add")||(i.addClass("item_active"),i.parents(".item_wrap_conditions").addClass("wrap_active"))}),t(document).on("click",".item_add_trigger",function(){BWFAN_Auto.setBlankData(),BWFAN_Auto.uiData.push({id:"trigger",html:{}}),BWFAN_Auto.buildAutomation(),BWFAN_Auto.mainElem.find(".item_modify_trigger").trigger("click")}),t(document).on("click",".item_modify_trigger",function(){var i={};if(void 0!==BWFAN_Auto.uiDataDetail.trigger&&_.size(BWFAN_Auto.uiDataDetail.trigger)>0)return BWFAN_Auto.modifyTrigger(),i=BWFAN_Auto.getSidebarTopTextArr("selected_event"),void BWFAN_Auto.setSidebarTopText(i);var e=t("#modal-autonami-event");e.length>0&&e.iziModal("open")}),t(document).on("click","#bwf-modal-event-continue",function(){var i=t("#modal-autonami-event"),e=i.find(".bwf-event-brick.is-selected");0===e.length&&console.log("Event is not selected");var a=e.attr("data-value"),n=e.attr("data-group"),o=BWFAN_Actions.get_action_name("event_text",n,a);BWFAN_Auto.setTriggerData("source",n),BWFAN_Auto.setTriggerData("event",a),BWFAN_Auto.setTriggerData("name",o),BWFAN_Auto.sidebarMsg.selected_event.head=BWFAN_Actions.get_action_name("event_text",n,a),BWFAN_Auto.buildAutomation(),BWFAN_Auto.emptySidebar(),t(".item_modify_trigger").trigger("click"),i.iziModal("close")}),t(document).on("click","#bwf-modal-action-continue",function(){var i=t("#modal-autonami-event-action"),e=i.find(".bwf-event-brick.is-selected");0===e.length&&console.log("Action is not selected");var a=e.attr("data-group"),n=e.attr("data-value"),o=BWFAN_Actions.get_action_name("action_text",a,n),u=i.find("input[name='selected_action_group_id']").val(),c=i.find("input[name='selected_action_action_id']").val();BWFAN_Auto.setActionFieldData(u,c,"integration_slug",a),BWFAN_Auto.setActionFieldData(u,c,"action_slug",n),BWFAN_Auto.setActionFieldData(u,c,"action_name",o);var _='<div class="bwfan_small_name">'+o.integration+"</div>"+o.action+"</div>",d=t('.workflow_item[data-group="'+u+'"] .item_modify_action[data-action="'+c+'"]');d.find(".action_text").html(_),d.trigger("click"),i.iziModal("close"),i.find("input[name='selected_action_group_id']").val(""),i.find("input[name='selected_action_action_id']").val("")}),t(document).on("click",".item_add_condition",function(){var i=t(this),e=BWFAN_Auto.getUIIndex(i);BWFAN_Auto.removeUIElement(e);var a=BWFAN_Auto.getNewGroupIndex();BWFAN_Auto.ui.groupCount=a,BWFAN_Auto.uiData.push({id:"condition",group_id:a,html:["gap_top","no_html"]}),BWFAN_Auto.uiData.push({id:"else",html:["end_html"]}),void 0===BWFAN_Auto.uiDataDetail.condition&&(BWFAN_Auto.uiDataDetail.condition={},BWFAN_Auto.uiDataDetail.actions={}),BWFAN_Auto.uiDataDetail.condition[a]={},BWFAN_Auto.uiDataDetail.actions[a]={},BWFAN_Auto.buildAutomation(),BWFAN_Auto.mainElem.find(".workflow_item[data-ui='"+e+"']").find(".item_modify_condition").trigger("click")}),t(document).on("click",".item_modify_condition",function(){var i=t(this);BWFAN_Auto.modifyCondition(i);var e=BWFAN_Auto.getSidebarTopTextArr("select_condition");BWFAN_Auto.setSidebarTopText(e)}),t(document).on("click",".item_add_action",function(){var i=t(this),e=i.parents(".item_wrap_conditions"),a=BWFAN_Auto.getGroupIndex(i);BWFAN_Auto.slideSidebar("close"),BWFAN_Auto.emptySidebar(),i.remove();var n=0;_.isUndefined(BWFAN_Auto.ui.actions)||""===BWFAN_Auto.ui.actions?BWFAN_Auto.ui.actions={}:!1===_.isUndefined(BWFAN_Auto.ui.actions[a])&&(n=parseInt(BWFAN_Auto.ui.actions[a])+1),_.isUndefined(BWFAN_Auto.uiDataDetail.actions[a])&&(BWFAN_Auto.uiDataDetail.actions[a]={}),BWFAN_Auto.uiDataDetail.actions[a][n]={},BWFAN_Auto.ui.actions[a]=n,BWFAN_Auto.addAction(e,n),e.find(".item_modify_action[data-action='"+n+"']").trigger("click")}),t(document).on("click",".item_modify_action",function(){var i=t(this);BWFAN_Auto.modifyAction(i)}),t(document).on("click",".item_wrap_single .item_actions",function(i){var e=t(this).parents(".item_wrap_single").find(".item_actions_list");e.length>0&&e.show(),i.stopPropagation()}),t(document).on("click",".item_wrap_top i.dashicons",function(i){var e=t(this),a=BWFAN_Auto.getCurrentCol(e),n=e.parents(".workflow_item"),o="action",u="Do you want to remove this Direct Action block.";n.hasClass("workflow_type_condition")&&(o="condition",u="Do you want to remove this Conditional Action block."),BWFAN_Auto.setup_cancelled_elements(e,{curCol:a,parentWorkflow:n,deleteType:o}),BWFAN_Auto.show_prompt_before_delete("Are you sure ?",u,"bwfan_delete_block bwfan_btn ","Yes! remove all actions","Do nothing"),i.stopPropagation()}),t(document).on("click",".item_wrap_html_add",function(e){var a=t(this),n=t("#modal-plus-icon-add");if(n.length>0){var o=0;if(a.parents(".workflow_item").prevAll().each(function(){var i=t(this);void 0!==i.attr("data-ui")&&i.attr("data-ui")>0&&o<i.attr("data-ui")&&(o=i.attr("data-ui"))}),void 0!==o){n.iziModal("open"),i=e.currentTarget,n.find(".bwfan_add_block_wrap").attr("data-ui",o);var u=e.currentTarget.getBoundingClientRect().top,c=e.currentTarget.getBoundingClientRect().right+20;t("#modal-plus-icon-add").css({"margin-top":u+"px","margin-left":c+"px"})}}e.stopPropagation()}),t(document).on("opened","#modal-plus-icon-add",function(i){t(window).on("scroll",e)}),t(document).on("closed","#modal-plus-icon-add",function(i){t(window).off("scroll",e)}),t(document).on("click",".bwfan_add_next_block",function(){var i=t(this),e=parseInt(i.parents(".bwfan_add_block_wrap").attr("data-ui"))+1,a=i.attr("data-type"),n=BWFAN_Auto.getNewGroupIndex();BWFAN_Auto.slideSidebar("close"),BWFAN_Auto.emptySidebar(),0==_.size(BWFAN_Auto.uiDataDetail.actions)&&(BWFAN_Auto.uiDataDetail.actions={}),0==_.size(BWFAN_Auto.uiDataDetail.condition)&&(BWFAN_Auto.uiDataDetail.condition={});var o={};switch(a){case"conditional":o={id:"condition",group_id:n,html:["gap_top","no_html"]},BWFAN_Auto.uiData.splice(e,0,o),BWFAN_Auto.uiDataDetail.condition[n]={},BWFAN_Auto.uiDataDetail.actions[n]={},BWFAN_Auto.buildAutomation(),BWFAN_Auto.mainElem.find(".workflow_item[data-ui='"+e+"']").find(".item_modify_condition").trigger("click");break;case"action":o={id:"action",group_id:n,html:["gap_top","add_block","gap"]},BWFAN_Auto.uiData.splice(e,0,o),BWFAN_Auto.uiDataDetail.actions[n]={},BWFAN_Auto.buildAutomation();var u=BWFAN_Auto.getSidebarTopTextArr("select_actions");BWFAN_Auto.setSidebarTopText(u)}BWFAN_Auto.ui.groupCount=n,t("#modal-plus-icon-add").iziModal("close")}),t(document).on("click",".wr_tw_save .wr-form-btn",function(){var i=t(this),e=t(".wr_wrap_form").find("form");if(i.addClass("bwfan_btn_spin"),0==e.length)return t(document).trigger("bwfan_automation_save"),void setTimeout(function(){i.removeClass("bwfan_btn_spin")},1e3);e.trigger("submit"),setTimeout(function(){i.removeClass("bwfan_btn_spin")},1e3)}),t(document).on("click",".item_actions_list li a",function(){var i=t(this),e=BWFAN_Auto.getGroupIndex(i),a=BWFAN_Auto.getActionIndex(i),n=t(".bwfan_copied_action_msg"),o=i.attr("data-type");if(BWFAN_Auto.actionCopied=o,i.parents(".item_actions_list").hide(),"delete"===o){var u=BWFAN_Auto.getCurrentCol(i);BWFAN_Auto.setup_cancelled_elements(i,{curCol:u}),BWFAN_Auto.show_prompt_before_delete("Are you sure ?","You are going to remove the action","bwfan_delete_action","Yes! remove the action","Do nothing")}else if("copy"===o){if(0===n.length)return;try{var c=BWFAN_Auto.uiDataDetail.actions[e][a],d=c.integration_slug,s=c.action_slug,r=BWFAN_Actions.get_action_name("action_text",d,s);if(_.has(r,"integration")){var l=wp.template("bwfan-copied-action");n.html(l(r)),BWFAN_Auto.emptySidebar(),BWFAN_Auto.uiCopiedAction={},BWFAN_Auto.uiCopiedAction.data=BWFAN_Auto.uiDataDetail.actions[e][a],BWFAN_Auto.buildAutomation()}}catch(t){console.log("Couldn't able to copy the action with group id: "+e+"& action id: "+a)}}}),t(document).on("click",".bwfan_discard_btn_cross",function(){t(".bwfan_copied_action_msg").html(""),BWFAN_Auto.slideSidebar("close"),BWFAN_Auto.emptySidebar(),BWFAN_Auto.uiCopiedAction={},BWFAN_Auto.buildAutomation()}),t(document).on("click",".item_paste_action",function(){var i=t(this),e=(BWFAN_Auto.getUIIndex(i),BWFAN_Auto.getGroupIndex(i));try{var a=BWFAN_Auto.uiCopiedAction.data;t(".bwfan_copied_action_msg").html(""),BWFAN_Auto.uiCopiedAction={},BWFAN_Auto.slideSidebar("close"),BWFAN_Auto.emptySidebar();var n=0;!1===_.isUndefined(BWFAN_Auto.ui.actions[e])&&(n=parseInt(BWFAN_Auto.ui.actions[e])+1),_.isUndefined(BWFAN_Auto.uiDataDetail.actions[e])&&(BWFAN_Auto.uiDataDetail.actions[e]={}),BWFAN_Auto.uiDataDetail.actions[e][n]=a,BWFAN_Auto.ui.actions[e]=n,BWFAN_Auto.buildAutomation()}catch(t){console.log("Error occurred in pasting. Message: "+t.message),BWFAN_Auto.uiCopiedAction={},BWFAN_Auto.buildAutomation()}}),t(document).click(function(i){var e=t(i.target),a=t(".item_actions_list");a.is(":visible")&&0===e.parents(".item_actions_list").length&&a.css("display","none")}),t(document).on("click","#collapse-button",function(){t(this).attr("aria-expanded");var i=t("ul#adminmenu").outerWidth();t(".bwfan_header").css("width","calc(100% - "+i+"px)")}),t(document).on("click",".wl-sidebar-overlay",function(){t(this);t(".wr").removeClass("wr-expanded"),t(".wl-sidebar-overlay").fadeOut(),t(".wr_tw_save .wr-form-btn").trigger("click"),BWFAN_Auto.removeActiveStates()});t(".wr"),t(".bwfan_content_wrap").width();t(document).on("click",".wr .wr-resizer",null,function(){var i,e=t(".bwfan_content_wrap").width(),a=t(".wr").width();a>e||(t(this).hasClass("reverse")?(t(".wr").css({width:365}),t(".wr .wr-resizer").removeClass("reverse")):e/2>a?(i=e/2,t(".wr").css({width:i})):(i=.7*e,t(".wr").css({width:i}),t(".wr .wr-resizer").addClass("reverse")))})},setup_cancelled_elements:function(t,i){BWFAN_Auto.cancelledElementObject=t,BWFAN_Auto.cancelledElementData=i},show_prompt_before_delete:function(i,e,a,n,o){swal({type:"warning",title:i,html:e+"<div class='bwfan_clear_30'></div><div class='bwfan_pop_input'><input id='bwfan_delete_action_opt' type='checkbox' name='bwfan_delete_action_opt' /><label for='bwfan_delete_action_opt'>Yes, delete all scheduled actions associated with the actions.</label></div><div class='bwfan_clear_30'></div><button type=\"button\" tabindex=\"1\" class=\""+a+' bwfan_custom_swal_button bwfan_btn_red">'+n+'</button><button type="button" tabindex="3" class="'+a+' bwfan_custom_swal_button bwfan_btn_grey">'+o+"</button>",showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1}).then(function(i){i&&t(".wr_tw_save .wr-form-btn").trigger("click")})},update_actions_track_id_index:function(i,e,a){if(_.isEmpty(a)&&(a=1),_.isEmpty(e)&&(e=[]),0!==_.size(e)){var n=t("input#t_to_delete").val();_.isEmpty(n)?t("input#t_to_delete").val(JSON.stringify(e)):(n=JSON.parse(n),e=_.union(n,e),e=_.uniq(e),t("input#t_to_delete").val(JSON.stringify(e)))}},get_child_actions:function(t){var i=BWFAN_Auto.getGroupIndex(t),e=_.keys(BWFAN_Auto.uiDataDetail.actions[i]),a=[];return _.size(e)>0&&(a=e.map(function(t){return i+"_"+t})),a},is_event_exists:function(){return t("select.bwfan-selected-trigger").length>0&&""!=t("select.bwfan-selected-trigger").val()||!0!==_.isUndefined(BWFAN_Auto.uiDataDetail.trigger)&&0!==_.size(BWFAN_Auto.uiDataDetail.trigger)&&!1!==_.has(BWFAN_Auto.uiDataDetail.trigger,"event")&&!0!==_.isEmpty(BWFAN_Auto.uiDataDetail.trigger.event)},re_calc_ui_prop:function(){var i=this.uiData,e=0,a={};t.each(i,function(t,i){_.has(i,"group_id")&&(e=i.group_id>e?i.group_id:e,a.groupCount=parseInt(e))});var n=this.uiDataDetail;_.has(n,"actions")&&t.each(n.actions,function(t){if(_.size(n.actions[t])>0){var i=_.last(_.keys(n.actions[t]));_.isUndefined(a.actions)&&(a.actions=[]),a.actions[t]=parseInt(i)}}),this.ui=a},removeActiveStates:function(){var i=t(".item_wrap_conditions.wrap_active");i.length>0&&i.removeClass("wrap_active");var e=t(".item_wrap_single.item_active");e.length>0&&e.removeClass("item_active")},isJSON:function(t){try{JSON.parse(t)}catch(t){return!1}return!0}}).init()}(jQuery);