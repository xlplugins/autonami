(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{224:function(e,t,a){"use strict";var r=a(0);a(257);t.a=function(e){return Object(r.useEffect)((function(){setTimeout((function(){e.removeMessage()}),5e3)}),[e.message]),Object(r.createElement)(r.Fragment,null,e.message&&Object(r.createElement)("div",{id:"bwfcrm-message-notice"},Object(r.createElement)("span",{className:"bwfcrm-message-text"},e.message)))}},257:function(e,t,a){},723:function(e,t,a){"use strict";a.r(t);var r=a(0),c=a(9),n=a(4),m=a(7),s=a(16),i=a.n(s),o=a(176),l=a(460),b=a(30),w=a.n(b),p=a(5),u=a(20),d=a(17),O=a(368),f=a(120),j=a(121),g=a(109),v=a(224),E=a(117),_=a(13);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function h(e,t,a,r,c,n,m){try{var s=e[n](m),i=s.value}catch(e){return void a(e)}s.done?t(i):Promise.resolve(i).then(r,c)}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,c=!1,n=void 0;try{for(var m,s=e[Symbol.iterator]();!(r=(m=s.next()).done)&&(a.push(m.value),!t||a.length!==t);r=!0);}catch(e){c=!0,n=e}finally{try{r||null==s.return||s.return()}finally{if(c)throw n}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return k(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}t.default=function(e){var t=location&&location.search?Object(d.parse)(location.search.substring(1)):{},a=N(Object(r.useState)(!1),2),s=a[0],b=a[1],k=N(Object(r.useState)(!1),2),S=k[0],C=k[1],P=N(Object(r.useState)(1),2),I=P[0],T=P[1],M=N(Object(r.useState)(""),2),x=M[0],A=M[1],D=N(Object(r.useState)({loading:!1,error:!1,success:!1,message:""}),2),B=D[0],R=D[1],L=N(Object(r.useState)(!1),2),F=L[0],H=L[1],U=N(Object(r.useState)(!1),2),Y=U[0],q=U[1],J=N(Object(r.useState)({}),2),V=J[0],G=J[1],W={rich:Object(n.__)("Rich Text","wp-marketing-automations-crm"),wc:Object(n.__)("WooCommerce","wp-marketing-automations-crm"),html:Object(n.__)("HTML","wp-marketing-automations-crm"),editor:Object(n.__)("Editor","wp-marketing-automations-crm")},$=N(Object(r.useState)({message:"",type:1}),2),z=$[0],K=$[1],Q=Object(l.a)().setCampaignValues,X=Object(m.i)(),Z=o.a.getCampaignData(),ee=o.a.getCampaignId(),te=parseInt(Z.type);Object(r.useEffect)((function(){if(Z)if(Z.hasOwnProperty("execution_time")&&!Object(p.isNull)(Z.execution_time)){var e=new Date(Object(m.p)(Z.execution_time));T(2),A(e)}else{var t=new Date;A(t)}}),[]);var ae,re,ce,ne=Z?Z.count:0,me=[{value:1,className:"bwf-crm-campaign-schedule bwf-crm-campaign-schedule-now",label:Object(n.__)("Broadcast Now","wp-marketing-automations-crm")},{value:2,className:"bwf-crm-campaign-schedule bwf-crm-campaign-schedule-later",label:Object(n.__)("Schedule For Later","wp-marketing-automations-crm")}],se=function(){var a,r=(a=regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.setPending(!0),R({loading:!0,error:!1,success:!1,message:""}),a.prev=2,a.next=5,i()({path:Object(m.f)("/broadcast/".concat(ee)),method:"POST",data:{data:{schedule_time:w()(x).utc().format(),modified_by:Object(m.m)()},step:4},headers:{"Content-Type":"application/json"}}).then((function(e){200==e.code&&(Q("data",e.result),R({loading:!0,error:!1,success:!0,message:e.message}),2==I&&setTimeout((function(){Object(u.j)({page:t.page,path:"/broadcasts"},"/",{})}),2e3))}));case 5:a.next=11;break;case 7:a.prev=7,a.t0=a.catch(2),R({loading:!0,error:!0,success:!1,message:a.t0.message}),setTimeout((function(){R({loading:!1,error:!1,success:!1,message:""})}),2e3);case 11:e.setPending(!1);case 12:case"end":return a.stop()}}),a,null,[[2,7]])})),function(){var e=this,t=arguments;return new Promise((function(r,c){var n=a.apply(e,t);function m(e){h(n,r,c,m,s,"next",e)}function s(e){h(n,r,c,m,s,"throw",e)}m(void 0)}))});return function(){return r.apply(this,arguments)}}();return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(E.a,null),Object(r.createElement)("div",{className:"bwf-campaign-step-div bwf-card-wrap bwf-campaign-step-4"},Object(r.createElement)("div",{className:"bwf-card-header"},Object(r.createElement)("span",{className:"bwf-form-title"},Object(n.__)("Review & Schedule","wp-marketing-automations-crm"))),Object(r.createElement)("div",{className:"bwf-p-gap"},Object(r.createElement)("div",{className:"bwf-p-gap bwf-border"},Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Information","wp-marketing-automations-crm")),Object(r.createElement)(c.CardBody,null,Object(r.createElement)("div",{className:"bwf-report-row",key:1},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Title","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Z.title)),Object(r.createElement)("div",{className:"bwf-report-row",key:2},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Type","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},X[te].label)),!!Z.description&&Object(r.createElement)("div",{className:"bwf-report-row",key:3},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Description","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Z.description)))))),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-p-gap bwf-border"},Object(r.createElement)(r.Fragment,null,Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Contacts","wp-marketing-automations-crm")),Object(r.createElement)(c.CardBody,null,Object(r.createElement)("div",{className:"bwf-report-row",key:1},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Total","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Object(r.createElement)("b",null,ne))),Z.data.hasOwnProperty("filters")&&!Object(p.isEmpty)(Z.data.filters)&&Object(r.createElement)("div",{className:"bwf-report-row",key:2},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Segments","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Object(O.b)(Z.data.filters)))))))),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-p-gap bwf-border"},Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Content","wp-marketing-automations-crm")),Object(r.createElement)(c.CardBody,null,te&&1==te&&Z.data.hasOwnProperty("senders_name")&&!Object(p.isEmpty)(Z.data.senders_name)&&Object(r.createElement)("div",{className:"bwf-report-row",key:1},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("From Name","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Z.data.senders_name)),te&&1==te&&Z.data.hasOwnProperty("senders_email")&&!Object(p.isEmpty)(Z.data.senders_email)&&Object(r.createElement)("div",{className:"bwf-report-row",key:2},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("From Email","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Z.data.senders_email)),te&&1==te&&Z.data.hasOwnProperty("replyto")&&!Object(p.isEmpty)(Z.data.replyto)&&Object(r.createElement)("div",{className:"bwf-report-row",key:3},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Reply-To Email","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Z.data.replyto)),Z.data&&Z.data.content&&Z.data.content.map((function(e,t){return Object(r.createElement)("div",{className:"bwf-report-row",key:6},Object(r.createElement)("div",{className:"bwf-report-row-label"},Z.data.content.length>1?Object(n.__)("Content #","wp-marketing-automations-crm")+(parseInt(t)+1):Object(n.__)("Content","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value bwf-report-value-modal"},te&&e.subject&&Object(r.createElement)("span",null,e.subject),Object(r.createElement)(c.Button,{isSecondary:!0,className:"bwf-a-no-underline",style:{height:"auto",padding:"10px 20px"},onClick:function(){q(!0),[2,3].includes(parseInt(te))?H(!0):H(!1),G(e)}},Object(n.__)("View details","wp-marketing-automations-crm"))))})),Y&&Object(r.createElement)(c.Modal,{title:"Details",onRequestClose:function(){return q(!1)},className:"bwf-message-preview-modal bwf-admin-modal bwf-admin-modal-xl"},(ae=V,re="",ce=!0,3==te&&ae.hasOwnProperty("whatsAppImage")&&ae.whatsAppImage&&ae.hasOwnProperty("whatsAppImageSetting")&&ae.whatsAppImageSetting.hasOwnProperty("position")&&!Object(p.isEmpty)(ae.whatsAppImageSetting.position)&&ae.whatsAppImageSetting.hasOwnProperty("imageURL")&&!Object(p.isEmpty)(ae.whatsAppImageSetting.imageURL)&&(re="before"===ae.whatsAppImageSetting.position?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("img",{src:ae.whatsAppImageSetting.imageURL,width:50,height:50}),Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:ae.body}})):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:ae.body}}),Object(r.createElement)("img",{src:ae.whatsAppImageSetting.imageURL,width:50,height:50})),ce=!1),ce&&(re=Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:"editor"===ae.type?ae.editor.body:ae.body}})),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-message-wrap"},Object(r.createElement)("div",{className:"bwf-section"},1==te&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("Subject","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_align_center"},ae.subject)),1==te&&ae.hasOwnProperty("preheader")&&!Object(p.isEmpty)(ae.preheader)&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("Mail Pre-header","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_align_center"},ae.preheader)),1==te&&ae.hasOwnProperty("type")&&!Object(p.isEmpty)(ae.type)&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("Mail Type","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_align_center"},W[ae.type])),ae.hasOwnProperty("utm")&&!Object(p.isEmpty)(ae.utm)&&function(e){var t=[];return t.push(Object(n.__)("Source","wp-marketing-automations-crm")+": "+e.source),t.push(Object(n.__)("Medium","wp-marketing-automations-crm")+": "+e.medium),e.hasOwnProperty("name")&&!Object(p.isEmpty)(e.name)&&t.push(Object(n.__)("Name","wp-marketing-automations-crm")+": "+e.name),e.hasOwnProperty("content")&&!Object(p.isEmpty)(e.content)&&t.push(Object(n.__)("Content","wp-marketing-automations-crm")+": "+e.content),e.hasOwnProperty("term")&&!Object(p.isEmpty)(e.term)&&t.push(Object(n.__)("Term","wp-marketing-automations-crm")+": "+e.term),Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("UTM Details","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_align_center"},Object(r.createElement)("div",{className:"bwf-p"},t.join(" | "))))}(ae.utm),F&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-report-row-value"},re)),Object(r.createElement)("div",{className:"bwf-p-15 bwf-t-center"},Object(r.createElement)("a",{className:"bwf-model-link",onClick:function(){return H(!F)}},F?Object(n.__)("Less Details","wp-marketing-automations-crm"):Object(n.__)("More Details","wp-marketing-automations-crm")))))))))))),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-crm-campaign-navigation"},Object(r.createElement)(c.Button,{isSecondary:!0,className:"bwf-crm-navigation-previous bwf-big-button",onClick:function(){Q("step",3)}},Object(n.__)("Previous","wp-marketing-automations-crm")),Object(r.createElement)(c.Button,{className:"bwf-crm-navigation-next bwf-big-button",isPrimary:!0,onClick:function(){C(!1),b(!0)}},Object(n.__)("Schedule","wp-marketing-automations-crm")))),s&&Object(r.createElement)(c.Modal,{title:ne>0?Object(n.__)("Ready to Send ?","wp-marketing-automations-crm"):"",onRequestClose:function(){return b(!1)},className:"bwf-campaign-review-broadcast-model bwf-admin-modal bwf-admin-modal-medium",shouldCloseOnClickOutside:!1},B.loading?B.success?Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)(f.a,null),Object(r.createElement)("div",{className:"bwf-h1"},B.message)):B.error?Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)(j.a,null),Object(r.createElement)("div",{className:"bwf-h1"},B.message)):Object(r.createElement)(g.a,null):ne>0?Object(r.createElement)("div",{className:"bwf-campaign-review-broadcast-wrap",onClick:function(){C(!1)}},Object(r.createElement)(c.ButtonGroup,{className:"bwf-crm-campaign-schedule-btn-grp bwf-alter-button bwf-t-center"},me.map((function(e){var t=e.value===I?{isPrimary:!0}:{isSecondary:!0};return Object(r.createElement)(c.Button,y({onClick:function(){T(e.value),A(w()())}},t,{className:e.className}),1==e.value?Object(r.createElement)(_.a,{icon:"broadcasts"}):"",e.label)}))),2==I&&Object(r.createElement)("div",{className:"bwf-crm-campaign-review-date-wrap"},Object(r.createElement)("div",null,Object(r.createElement)("span",{className:"bwf-mr-5"},Object(r.createElement)(_.a,{icon:"calender"})),Object(n.__)("Pick Date and Time","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-crm-campaign-review-schedule-text-box",onClick:function(e){e.stopPropagation(),C(!S)}},w()(x).format("MMMM Do YYYY, h:mm a")),S&&Object(r.createElement)("div",{className:"bwf-crm-campaign-schedule-popover",onClick:function(e){return e.stopPropagation()}},Object(r.createElement)(c.DateTimePicker,{currentDate:x,isInvalidDate:function(e){return w()(e).isBefore(new Date,"day")},onChange:function(e){new Date<new Date(e)?A(e):K({message:Object(n.__)("Select a valid date","wp-marketing-automations-crm"),type:0})},is12Hour:!0}))),Object(r.createElement)("div",{className:"bwf-crm-campaign-action-schedule"},Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(c.Button,{isSecondary:!0,className:"bwf-crm-campaign-cancel-review-schedule",onClick:function(){return b(!1)}},Object(n.__)("Cancel","wp-marketing-automations-crm")),Object(r.createElement)(c.Button,{className:"bwf-crm-campaign-save-review-schedule",isPrimary:!0,onClick:se},1==I?Object(n.__)("Send Now","wp-marketing-automations-crm"):Object(n.__)("Schedule","wp-marketing-automations-crm")))):Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)(j.a,null),Object(r.createElement)("div",{className:"bwf-h1"},Object(n.__)("No Contacts are selected.","wp-marketing-automations-crm")))),Object(r.createElement)(v.a,{message:z.message,type:z.type,removeMessage:function(){return K({message:"",type:1})}})))}}}]);