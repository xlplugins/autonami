(window.webpackJsonp=window.webpackJsonp||[]).push([[76],{224:function(e,t,a){"use strict";var r=a(0);a(257);t.a=function(e){return Object(r.useEffect)((function(){setTimeout((function(){e.removeMessage()}),5e3)}),[e.message]),Object(r.createElement)(r.Fragment,null,e.message&&Object(r.createElement)("div",{id:"bwfcrm-message-notice"},Object(r.createElement)("span",{className:"bwfcrm-message-text"},e.message)))}},257:function(e,t,a){},722:function(e,t,a){"use strict";a.r(t);var r=a(0),c=a(9),n=a(4),m=a(7),s=a(16),i=a.n(s),o=a(176),l=a(459),b=a(26),u=a.n(b),w=a(5),p=a(367),d=a(121),f=a(122),O=a(111),j=a(224),g=a(117),v=a(13);function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function _(e,t,a,r,c,n,m){try{var s=e[n](m),i=s.value}catch(e){return void a(e)}s.done?t(i):Promise.resolve(i).then(r,c)}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,c=!1,n=void 0;try{for(var m,s=e[Symbol.iterator]();!(r=(m=s.next()).done)&&(a.push(m.value),!t||a.length!==t);r=!0);}catch(e){c=!0,n=e}finally{try{r||null==s.return||s.return()}finally{if(c)throw n}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}t.default=function(e){var t=y(Object(r.useState)(!1),2),a=(t[0],t[1]),s=y(Object(r.useState)(!1),2),b=s[0],h=s[1],N=y(Object(r.useState)(1),2),k=N[0],C=N[1],S=y(Object(r.useState)(""),2),P=S[0],T=S[1],x=y(Object(r.useState)({loading:!1,error:!1,success:!1,message:""}),2),M=x[0],I=x[1],D=y(Object(r.useState)(!1),2),A=D[0],H=D[1],Y=y(Object(r.useState)(!1),2),B=Y[0],R=Y[1],q=y(Object(r.useState)({}),2),L=q[0],F=q[1],U={rich:Object(n.__)("Rich Text","wp-marketing-automations-crm"),wc:Object(n.__)("WooCommerce","wp-marketing-automations-crm"),html:Object(n.__)("HTML","wp-marketing-automations-crm"),editor:Object(n.__)("Editor","wp-marketing-automations-crm")},G=y(Object(r.useState)({message:"",type:1}),2),J=G[0],V=G[1],z=Object(l.a)().setCampaignValues,W=Object(m.j)(),$=o.a.getCampaignData(),K=o.a.getCampaignId(),Q=(o.a.getEditableMode(),parseInt($.type));Object(r.useEffect)((function(){if($)if($.hasOwnProperty("execution_time")&&!Object(w.isNull)($.execution_time))C(2),T(Object(m.q)(u()($.execution_time)).format("YYYY-MM-DDTHH:mm:ss"));else{var e=Object(m.q)(u()(new Date)).format("YYYY-MM-DDTHH:mm:ss");T(e)}}),[]),Object(r.useEffect)((function(){document.addEventListener("click",(function(e){var t=document.getElementsByClassName("bwf-crm-campaign-schedule-popover")[0],a=!0;void 0!==t&&t.contains(e.target)&&(a=!1),b&&"bwf-crm-campaign-review-schedule-text-box"!=e.target.id&&a&&h(!1)}))}));var X,Z,ee,te=$?$.count:0,ae=[{value:1,className:"bwf-crm-campaign-schedule bwf-crm-campaign-schedule-now",label:Object(n.__)("Broadcast Now","wp-marketing-automations-crm")},{value:2,className:"bwf-crm-campaign-schedule bwf-crm-campaign-schedule-later",label:Object(n.__)("Schedule For Later","wp-marketing-automations-crm")}],re=function(){var t,a=(t=regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setPending(!0),I({loading:!0,error:!1,success:!1,message:""}),!(te<=0)){t.next=6;break}return I({loading:!0,error:!0,success:!1,message:Object(n.__)("No Contacts are selected.","wp-marketing-automations-crm")}),setTimeout((function(){I({loading:!1,error:!1,success:!1,message:""})}),2e3),t.abrupt("return");case 6:if(a=Object(m.q)(u()(new Date)).format("YYYY-MM-DDTHH:mm:ss"),r=Object(m.q)(u()(P)),2!=k||r.isAfter(a)||r.isSame(a,"minute")){t.next=12;break}return I({loading:!0,error:!0,success:!1,message:Object(n.__)("Given time should exceeds the current time.","wp-marketing-automations-crm")}),setTimeout((function(){I({loading:!1,error:!1,success:!1,message:""})}),2e3),t.abrupt("return");case 12:return t.prev=12,t.next=15,i()({path:Object(m.g)("/broadcast/".concat(K)),method:"POST",data:{data:{schedule_time:Object(m.s)(P).utc().format(),modified_by:Object(m.n)()},step:4},headers:{"Content-Type":"application/json"}}).then((function(e){200==e.code&&(I({loading:!0,error:!1,success:!0,message:e.message}),setTimeout((function(){z("data",e.result),z("editableMode",!1)}),2e3))}));case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(12),I({loading:!0,error:!0,success:!1,message:t.t0.message}),setTimeout((function(){I({loading:!1,error:!1,success:!1,message:""})}),2e3);case 21:e.setPending(!1);case 22:case"end":return t.stop()}}),t,null,[[12,17]])})),function(){var e=this,a=arguments;return new Promise((function(r,c){var n=t.apply(e,a);function m(e){_(n,r,c,m,s,"next",e)}function s(e){_(n,r,c,m,s,"throw",e)}m(void 0)}))});return function(){return a.apply(this,arguments)}}();return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(g.a,null),Object(r.createElement)("div",{className:"bwf-campaign-step-div bwf-card-wrap bwf-campaign-step-4"},Object(r.createElement)("div",{className:"bwf-card-header"},Object(r.createElement)("span",{className:"bwf-form-title"},Object(n.__)("Review & Schedule","wp-marketing-automations-crm"))),Object(r.createElement)("div",{className:"bwf-p-gap"},Object(r.createElement)("div",{className:"bwf-p-gap bwf-border"},Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Information","wp-marketing-automations-crm")),Object(r.createElement)(c.CardBody,null,Object(r.createElement)("div",{className:"bwf-report-row",key:1},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Title","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},$.title)),Object(r.createElement)("div",{className:"bwf-report-row",key:2},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Type","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},W[Q].label)),!!$.description&&Object(r.createElement)("div",{className:"bwf-report-row",key:3},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Description","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},$.description)))))),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-p-gap bwf-border"},Object(r.createElement)(r.Fragment,null,Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Contacts","wp-marketing-automations-crm")),Object(r.createElement)(c.CardBody,null,Object(r.createElement)("div",{className:"bwf-report-row",key:1},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Total","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Object(r.createElement)("b",null,te))),$.data.hasOwnProperty("filters")&&!Object(w.isEmpty)($.data.filters)&&Object(r.createElement)("div",{className:"bwf-report-row",key:2},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Segments","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Object(p.b)($.data.filters)))))))),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-p-gap bwf-border"},Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Content","wp-marketing-automations-crm")),Object(r.createElement)(c.CardBody,null,Q&&1==Q&&$.data.hasOwnProperty("senders_name")&&!Object(w.isEmpty)($.data.senders_name)&&Object(r.createElement)("div",{className:"bwf-report-row",key:1},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("From Name","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},$.data.senders_name)),Q&&1==Q&&$.data.hasOwnProperty("senders_email")&&!Object(w.isEmpty)($.data.senders_email)&&Object(r.createElement)("div",{className:"bwf-report-row",key:2},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("From Email","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},$.data.senders_email)),Q&&1==Q&&$.data.hasOwnProperty("replyto")&&!Object(w.isEmpty)($.data.replyto)&&Object(r.createElement)("div",{className:"bwf-report-row",key:3},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Reply-To Email","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},$.data.replyto)),$.data&&$.data.content&&$.data.content.map((function(e,t){return Object(r.createElement)("div",{className:"bwf-report-row",key:6},Object(r.createElement)("div",{className:"bwf-report-row-label"},$.data.content.length>1?Object(n.__)("Content #","wp-marketing-automations-crm")+(parseInt(t)+1):Object(n.__)("Content","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value bwf-report-value-modal"},Q&&e.subject&&Object(r.createElement)("span",null,e.subject),Object(r.createElement)(c.Button,{isSecondary:!0,className:"bwf-a-no-underline",style:{height:"auto",padding:"10px 20px"},onClick:function(){R(!0),[2,3].includes(parseInt(Q))?H(!0):H(!1),F(e)}},Object(n.__)("View details","wp-marketing-automations-crm"))))})),B&&Object(r.createElement)(c.Modal,{title:"Details",onRequestClose:function(){return R(!1)},className:"bwf-message-preview-modal bwf-admin-modal bwf-admin-modal-xxxl"},(X=L,Z="",ee=!0,3==Q&&X.hasOwnProperty("whatsAppImage")&&X.whatsAppImage&&X.hasOwnProperty("whatsAppImageSetting")&&X.whatsAppImageSetting.hasOwnProperty("position")&&!Object(w.isEmpty)(X.whatsAppImageSetting.position)&&X.whatsAppImageSetting.hasOwnProperty("imageURL")&&!Object(w.isEmpty)(X.whatsAppImageSetting.imageURL)&&(Z="before"===X.whatsAppImageSetting.position?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("img",{src:X.whatsAppImageSetting.imageURL,width:50,height:50}),Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:X.body}})):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:X.body}}),Object(r.createElement)("img",{src:X.whatsAppImageSetting.imageURL,width:50,height:50})),ee=!1),ee&&(Z=Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:"editor"===X.type?X.editor.body:X.body}})),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-message-wrap"},Object(r.createElement)("div",{className:"bwf-section"},1==Q&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("Subject","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_align_center"},X.subject)),1==Q&&X.hasOwnProperty("preheader")&&!Object(w.isEmpty)(X.preheader)&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("Mail Pre-header","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_align_center"},X.preheader)),1==Q&&X.hasOwnProperty("type")&&!Object(w.isEmpty)(X.type)&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("Mail Type","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_align_center"},U[X.type])),X.hasOwnProperty("utm")&&!Object(w.isEmpty)(X.utm)&&function(e){var t=[];return t.push(Object(n.__)("Source","wp-marketing-automations-crm")+": "+e.source),t.push(Object(n.__)("Medium","wp-marketing-automations-crm")+": "+e.medium),e.hasOwnProperty("name")&&!Object(w.isEmpty)(e.name)&&t.push(Object(n.__)("Name","wp-marketing-automations-crm")+": "+e.name),e.hasOwnProperty("content")&&!Object(w.isEmpty)(e.content)&&t.push(Object(n.__)("Content","wp-marketing-automations-crm")+": "+e.content),e.hasOwnProperty("term")&&!Object(w.isEmpty)(e.term)&&t.push(Object(n.__)("Term","wp-marketing-automations-crm")+": "+e.term),Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("UTM Details","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_align_center"},Object(r.createElement)("div",{className:"bwf-p"},t.join(" | "))))}(X.utm),A&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-report-row-value"},Z)),Object(r.createElement)("div",{className:"bwf-p-15 bwf-t-center"},Object(r.createElement)("a",{className:"bwf-model-link",onClick:function(){return H(!A)}},A?Object(n.__)("Less Details","wp-marketing-automations-crm"):Object(n.__)("More Details","wp-marketing-automations-crm")))))))))))),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-p-gap bwf-border"},Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Schedule","wp-marketing-automations-crm")),Object(r.createElement)(c.CardBody,{className:"bwf-crm-overview-schedule-section"},Object(r.createElement)("div",{className:"bwf-campaign-review-broadcast-wrap",onClick:function(){h(!1)}},Object(r.createElement)(c.ButtonGroup,{className:"bwf-crm-campaign-schedule-btn-grp bwf-alter-button"},ae.map((function(e){var t=e.value===k?{isPrimary:!0}:{isSecondary:!0};return Object(r.createElement)(c.Button,E({onClick:function(){C(e.value)}},t,{className:e.className}),1==e.value?Object(r.createElement)(v.a,{icon:"broadcasts",color:e.value===k?"#fff":"#000"}):Object(r.createElement)(v.a,{icon:"timer",color:e.value===k?"#fff":"#000"}),e.label)}))),2==k&&Object(r.createElement)("div",{className:"bwf-crm-campaign-review-date-wrap"},Object(r.createElement)("div",null,Object(r.createElement)("span",{className:"bwf-mr-5"},Object(r.createElement)(v.a,{icon:"calender"})),Object(n.__)("Pick Date and Time","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-crm-campaign-review-schedule-text-box",id:"bwf-crm-campaign-review-schedule-text-box",onClick:function(e){e.stopPropagation(),h(!b)}},Object(m.C)(u()(P))),b&&Object(r.createElement)("div",{className:"bwf-crm-campaign-schedule-popover",onClick:function(e){return e.stopPropagation()}},Object(r.createElement)(c.DateTimePicker,{currentDate:P,isInvalidDate:function(e){return Object(m.q)(e).isBefore(Object(m.q)(u()()),"day")},onChange:function(e,t){var a=Object(m.q)(u()(new Date)).format("YYYY-MM-DDTHH:mm:ss"),r=Object(m.q)(u()(e));r.isAfter(a)||r.isSame(a,"minute")?T(e):V({message:Object(n.__)("Given time should exceeds the current time.","wp-marketing-automations-crm"),type:0})},is12Hour:!0}),Object(r.createElement)("div",{className:"bwf-p bwf-display-flex"},"Current Store Time: ",Object(m.C)(Object(m.q)(u()().tz("UTC"))))))))))),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-crm-campaign-navigation"},Object(r.createElement)(c.Button,{isSecondary:!0,className:"bwf-crm-navigation-previous bwf-big-button",onClick:function(){z("step",3)}},Object(n.__)("Previous","wp-marketing-automations-crm")),Object(r.createElement)(c.Button,{className:"bwf-crm-navigation-next bwf-big-button",isPrimary:!0,onClick:function(){re()}},Object(n.__)("Schedule","wp-marketing-automations-crm")))),M.loading&&Object(r.createElement)(c.Modal,{title:te>0?Object(n.__)("Ready to Send ?","wp-marketing-automations-crm"):"",onRequestClose:function(){return a(!1)},className:"bwf-campaign-review-broadcast-model bwf-admin-modal bwf-admin-modal-medium bwf-admin-modal-no-header",shouldCloseOnClickOutside:!1},M.success?Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)(d.a,null),Object(r.createElement)("div",{className:"bwf-h1"},M.message)):M.error?Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)(f.a,null),Object(r.createElement)("div",{className:"bwf-h1"},M.message)):Object(r.createElement)(O.a,null)),Object(r.createElement)(j.a,{message:J.message,type:J.type,removeMessage:function(){return V({message:"",type:1})}})))}}}]);