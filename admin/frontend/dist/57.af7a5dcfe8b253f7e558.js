(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{109:function(e,t,n){"use strict";var r=n(0);n(133);t.a=function(e){var t=e.size,n=void 0===t?"xl":t;return Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf_clear_30"}),Object(r.createElement)("div",{className:"bwf-spin-loader bwf-spin-loader-".concat(n)}),Object(r.createElement)("div",{className:"bwf_clear_30"}))}},112:function(e,t,n){"use strict";var r=n(25),a=n(48);t.a=function(e){var t=Object(r.b)(),n=Object(a.a)(e),o=n.setLoading,c=n.fetch,i=n.clearError,u=n.setStateProp;return{setLoading:function(e){return t(o(e))},fetch:function(e,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return t(c(e,n,r,a))},clearError:function(){return t(i())},setStateProp:function(e,n){return t(u(e,n))}}}},114:function(e,t,n){"use strict";var r=n(112),a=n(44);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.a=function(){var e=Object(r.a)("menu").setStateProp,t=(0,Object(a.a)().getActive)();return{setActive:function(n,r){return e("active",c(c({},t),{},i({},n,r)))},setActiveMultiple:function(t){return e("active",t)},setBackLink:function(t){return e("backLink",t)},setL2Title:function(t){return e("l2Title",t)},setL2PostTitle:function(t){return e("l2PostTitle",t)},setL2Nav:function(t){return e("l2Nav",t)},setL2NavType:function(t){return e("l2NavType",t)},setL2Content:function(t){return e("l2Content",t)},setL2NavAlign:function(t){return e("l2NavAlign",t)},setPageHeader:function(t){return e("pageHeader",t)},setBackLinkLabel:function(t){return e("backLinkLabel",t)},setPageCountData:function(t){return e("pageCountData",t)},resetHeaderMenu:function(){e("backLink",""),e("l2Title",""),e("l2PostTitle",""),e("l2Nav",{}),e("l2NavType",""),e("active",{leftNav:"",rightNav:""}),e("l2Content",""),e("l2NavAlign","left"),e("pageHeader","")},setContactL2Menu:function(){return e("l2Nav")}}}},117:function(e,t,n){"use strict";var r=n(0),a=n(8),o=n.n(a);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var a=f(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,n,a,o=l(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this,e)).scrollTo=t.scrollTo.bind(m(t)),t}return t=c,(n=[{key:"componentDidMount",value:function(){setTimeout(this.scrollTo,250)}},{key:"scrollTo",value:function(){var e=this.props.offset;this.ref.current?window.scrollTo(0,parseInt(e,10)):setTimeout(this.scrollTo,250)}},{key:"render",value:function(){var e=this.props.children;return this.ref=Object(r.createRef)(),Object(r.createElement)("div",{ref:this.ref},e)}}])&&i(t.prototype,n),a&&i(t,a),c}(r.Component);b.propTypes={offset:o.a.string},b.defaultProps={offset:"0"},t.a=b},120:function(e,t,n){"use strict";var r=n(0);n(135);t.a=function(e){return Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf_align_center"},Object(r.createElement)("div",{className:"bwf-w-100",dangerouslySetInnerHTML:{__html:bwfcrm_contacts_data.icons.success}})))}},121:function(e,t,n){"use strict";var r=n(0);n(136);t.a=function(e){return Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf_align_center"},Object(r.createElement)("div",{className:"bwf-w-100",dangerouslySetInnerHTML:{__html:bwfcrm_contacts_data.icons.error}})))}},133:function(e,t,n){},135:function(e,t,n){},136:function(e,t,n){},137:function(e,t,n){"use strict";var r=n(0),a=n(109),o=n(120),c=n(121),i=n(9),u=n(4);t.a=function(e){var t=e.confirmText,n=void 0===t?"":t,l=e.confirmButtonText,s=void 0===l?"":l,m=e.cancelButtonText,f=void 0===m?"":m,b=e.onConfirm,d=void 0===b?function(){}:b,p=e.isLoading,g=void 0!==p&&p,O=e.successMessage,y=void 0===O?"":O,j=e.errorMessage,w=void 0===j?"":j,v=e.onRequestClose,h=e.isOpen,_=void 0!==h&&h,E=e.confirmDescription,S=void 0===E?"":E,C=e.isDelete,k=void 0!==C&&C;Object(r.useEffect)((function(){(y||w)&&setTimeout((function(){v&&v()}),2e3)}),[y,w]);return _?Object(r.createElement)(i.Modal,{title:"",onRequestClose:function(){return v()},className:"bwf-c-s-delete-model bwf-admin-modal bwf-admin-modal-small bwf-admin-modal-no-header"},k&&Object(r.createElement)("div",{className:"bwf-h4"},Object(u.__)("Delete","wp-marketing-automations-crm")),g&&Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.a,null)),!!y&&Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)(o.a,null),Object(r.createElement)("div",{className:"bwf-h1"},y)),!!w&&Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)(c.a,null),Object(r.createElement)("div",{className:"bwf-h1"},w)),!g&&!y&&!w&&Object(r.createElement)("div",{className:"bwf-t-center bwf-form-buttons"},k?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-h2"},Object(u.__)("Are you sure?","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_clear_15"}),Object(r.createElement)("div",{className:"bwf-h4 bwf-h4-grey"},Object(u.__)("Once you delete this item. It will no longer available.","wp-marketing-automations-crm"))):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-h1"},n),!!S&&Object(r.createElement)("p",null,S)),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:k?"bwf_text_right":""},Object(r.createElement)(i.Button,{isTertiary:!0,style:{marginRight:"20px"},onClick:function(){v&&v()}},f),Object(r.createElement)(i.Button,{isPrimary:!0,onClick:function(){d&&d()},className:k?"bwf-delete-btn":""},s)))):null}},478:function(e,t,n){"use strict";var r=n(0),a=n(9),o=n(15),c=n.n(o);n(479);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.a=function(e){var t=e.icon,n=e.children,o=e.isSelected,l=e.upperText,s=e.upperTextColor,m=e.onLowerClick,f=e.lowerText,b=e.lowerTextColor,d=e.onClick,p=e.isDisabled,g=e.alterButton,O=void 0!==g&&g,y=o?{isPrimary:!0}:{isSecondary:!0};p&&(y.disabled=!0);var j=c()(u({"bwf-c-upper-banner":!0},s,!0)),w=c()(u({"bwf-c-lower-banner":!0},b,!0)),v=function(e){m(),e.preventDefault()};return Object(r.createElement)("div",{className:c()("bwf-c-big-icon-button",{"bwf-alter-button":O})},l&&Object(r.createElement)("span",{className:j},l),Object(r.createElement)(a.Button,i({icon:t},y,{onClick:d||function(){},className:"bwf-display-flex"}),Object(r.createElement)("span",null,n)),f&&Object(r.createElement)("span",{onClick:v||function(){},className:w},f))}},479:function(e,t,n){},552:function(e,t,n){"use strict";var r=n(114),a=n(0);t.a=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=bwfcrm_contacts_data&&bwfcrm_contacts_data.header_data?bwfcrm_contacts_data.header_data:{},o=Object(r.a)(),c=o.setActiveMultiple,i=o.setL2NavType,u=o.setL2Nav,l=o.resetHeaderMenu,s=o.setPageHeader,m=o.setPageCountData,f=o.setL2Content;return Object(a.useEffect)((function(){l(),c({leftNav:"templates",rightNav:"templates"}),i("menu"),u(n.templates_nav),s("Templates"),m({templates:t}),e&&f(e)}),[t]),!0}},555:function(e,t,n){},557:function(e,t,n){"use strict";var r=n(0),a=n(9),o=n(4),c=n(332),i=n(7),u=n(5),l=n(485),s=n(109),m=function(e){if(!e||!e.editor||!e.editor.design)return!1;var t=JSON.parse(e.editor.design);return!!t&&!!t.body&&Array.isArray(t.body.rows)&&t.body.rows.length>0},f=function(e){var t=Object(r.useCallback)((function(t){return t&&e&&e[t]?e[t]:null}),[e]),n=e.mode;return{getEmailContent:function(){var e=parseInt(t("currentEmail")),n=t("data");return n&&e in n?n[e]:{}},getCurrentEmail:function(){return parseInt(t("currentEmail"))},getEmails:function(){return t("emails")},getAllEmailContent:function(){return t("data")},getShowValidationFlag:function(){return t("showValidation")},emailsValidToSubmit:function(){var e=t("data");return!!t("emails").map((function(t){var r=e[t];if(!r)return!1;var a=!!r.utmEnabled,o=r.utm?r.utm:{},c={subject:1!==n||r.subject&&r.subject.length>0,content:"editor"!==r.type?r.body&&r.body.length>0:m(r),type:1!==n||r.type&&r.type.length>0,utmSource:!a||o.source&&o.source.length>0,utmMedium:!a||o.medium&&o.medium.length>0};return!!Object.keys(c).map((function(e){return c[e]})).reduce((function(e,t){return e&&t}),!0)})).reduce((function(e,t){return e&&t}),!0)&&e},getValidEmails:function(){var e=t("data"),r=t("emails"),a={};return r.map((function(t){var r=e[t];if(r){var o=!!r.utmEnabled,c=r.utm?r.utm:{},i={subject:1!==n||r.subject&&r.subject.length>0,content:"editor"!==r.type?r.body&&r.body.length>0:m(r),type:1!==n||r.type&&r.type.length>0,utmSource:!o||c.source&&c.source.length>0,utmMedium:!o||c.medium&&c.medium.length>0};a[t]=!!Object.keys(i).map((function(e){return i[e]})).reduce((function(e,t){return e&&t}),!0)}})),a},getEmailsToSubmit:function(){var e=t("data");return t("emails").map((function(t){var n=e[t];return n||!1})).filter(Boolean)},getCurrentEmailIndex:function(){var e=parseInt(t("currentEmail")),n=t("emails");return Array.isArray(n)&&n.includes(e)?n.indexOf(e):1},validateCurrentEmail:function(){var e=t("data"),r=parseInt(t("currentEmail"));if(!e||!e[r])return!1;var a=e[r];if(a){var o=!!a.utmEnabled,c=a.utm?a.utm:{};return{subject:1!==n||a.subject&&a.subject.length>0,content:"editor"!==a.type?a.body&&a.body.length>0:m(a),type:1!==n||a.type&&a.type.length>0,utmSource:!o||c.source&&c.source.length>0,utmMedium:!o||c.medium&&c.medium.length>0}}},getSmartSendSettings:function(){return t("smartSend")},getSaveContentStatus:function(){return t("saveContentStatus")},getSendTestEmailStatus:function(){return t("sendTestEmailStatus")},getUploadImageStatus:function(){return t("uploadImageStatus")},getUploadImageURL:function(){return t("uploadImageURL")},getFromEmail:function(){return t("from_email")},getFromName:function(){return t("from_name")},getReplyTo:function(){return t("reply_to")},getMode:function(){return t("mode")},getABType:function(){return t("ab_type")},getObjectId:function(){return t("objectId")},getMergeTagsContext:function(){return t("mergeTagsContext")}}};function b(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){b(o,r,a,c,i,"next",e)}function i(e){b(o,r,a,c,i,"throw",e)}c(void 0)}))}}function p(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e,t,n){var a,c,i,l,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{sendTestEmail:function(){},saveEditorContent:function(){},uploadImage:function(){},fetchCurrentMailEditorContent:function(){}},m=Object(r.useCallback)((function(t){e(n.setStateProps(t))}),[e,n]),f=t.getAllEmailContent,b=t.getCurrentEmail,g=t.getEmails,O=t.getSmartSendSettings,w=t.getEmailContent,v=t.getEmailsToSubmit,h=f(),_=b(),E=g(),S=O(),C=w(),k=v(),T=function(e){return"type"in e?e:y(y({},e),{},{type:"rich"})};return{setEmailContentByKey:function(e,t){var n=T(_ in h?y(y({},h[_]),{},j({},e,t)):j({},e,t)),r=y(y({},h),{},j({},_,n));m({data:r})},setEmailUtmByKey:function(e,t){var n=T(_ in h?y({},h[_]):{}),r="utm"in n?y(y({},n.utm),{},j({},e,t)):j({},e,t),a=y(y({},h),{},j({},_,y(y({},n),{},{utm:y(y({},r),{},j({},e,t))})));m({data:a})},setMultipleUtm:function(e){if(e){var t=T(_ in h?y({},h[_]):{}),n=y(y({},h),{},j({},_,y(y({},t),{},{utm:y(y({},t.utm),e)})));m({data:n})}},setCurrentEmail:function(e){E.includes(e)&&m({currentEmail:e})},addEmail:function(){if(Array.isArray(E)&&E.length<3){var e=Math.max.apply(Math,p(E))+1;m({emails:[].concat(p(E),[e]),currentEmail:e,showValidation:!1,data:y(y({},h),{},j({},e,E[0]in h?h[E[0]]:{}))})}},showValidation:function(e){return m({showValidation:e})},deleteEmail:function(e){if(E.length>1){var t=E.filter((function(t){return t!==e}));m({emails:t,currentEmail:t[t.length-1]})}},initContent:function(e,t){if(Array.isArray(e)&&0!==Object(u.size)(e)){var n={};for(var r in e){var a=parseInt(r)+1;n[a]=h[a]?y(y({},T(h[a])),e[r]):e[r]}var c={data:n,emails:Object.keys(n).map((function(e){return parseInt(e)}))};t&&0!==Object.keys(t).length&&(c.smartSend=t),m(c)}else m({data:{1:{body:Object(o.__)("Hi","wp-marketing-automations-crm")+" {{contact_first_name}}"}},emails:[1],currentEmail:1})},fetchCurrentMailEditorContent:(l=d(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m({isLoading:!0}),e.next=3,s.fetchCurrentMailEditorContent();case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:m({isLoading:!1,data:y(y({},h),{},j({},_,y(y({},h[_]?h[_]:{}),{},{editor:t})))});case 7:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)}),sendTestEmail:(i=d(regeneratorRuntime.mark((function e(t,n){var r,a,o,c,i,u,l,f,b,d,p,g,O,y,j=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=j.length>2&&void 0!==j[2]?j[2]:"",a=j.length>3&&void 0!==j[3]?j[3]:"",o=j.length>4&&void 0!==j[4]?j[4]:"",c="",i="",u="rich",l="",C&&(f=C.body?C.body:"",b=C.editor?C.editor:{},d=b.body?b.body:"",u=C.type?C.type:u,c="editor"===u?d:f,i=C.subject?C.subject:"",l=C.preheader?C.preheader:""),p=a||c,g=r||i,O=o||u,m({sendTestEmailStatus:1}),e.next=14,s.sendTestEmail(t,g,p,O,n,l);case 14:y=e.sent,m({sendTestEmailStatus:parseInt(y)});case 16:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)}),setSmartSendByKey:function(e,t){return m({smartSend:y(y({},S),{},j({},e,t))})},saveEmailContent:(c=d(regeneratorRuntime.mark((function e(t){var n,r,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m({saveContentStatus:1}),n=Array.isArray(t)&&t.length>0?t:k,e.next=4,s.saveEditorContent(n);case 4:r=e.sent,a={},n.map((function(e,t){a=T(_ in h?y(y({},h[_]),{},j({},t,e)):j({},t,e))})),o=y(y({},h),{},j({},_,a)),m({data:o}),m({saveContentStatus:r});case 10:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)}),uploadImage:(a=d(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return m({uploadImageStatus:1}),e.next=5,s.uploadImage(t);case 5:n=e.sent,m({uploadImageStatus:n?2:3,uploadImageURL:n});case 7:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),resetSaveContentStatus:function(){return m({saveContentStatus:null})},resetSendTestEmailStatus:function(){return m({sendTestEmailStatus:null})},overrideCurrentContent:function(e){var t=T(_ in h?y({},h[_]):{}),n=y(y({},h),{},j({},_,y(y({},t),e)));m({data:n})},resetUploadImageStatus:function(){m({uploadImageStatus:null,uploadImageURL:""})},setFromEmail:function(e){return m({from_email:e})},setFromName:function(e){return m({from_name:e})},setReplyTo:function(e){return m({reply_to:e})},setMode:function(e){return m({mode:e})}}};function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C={mode:1,data:{1:{body:Object(o.__)("Hi","wp-marketing-automations-crm")+" {{contact_first_name}}"}},currentEmail:1,emails:[1],showValidation:!1,from_name:Object(i.r)("from_name"),from_email:Object(i.r)("from_email"),reply_to:Object(i.r)("reply_to_email"),ab_type:"standard",objectId:"",smartSend:{enable:!1,percent:15,hours:3},saveContentStatus:null,sendTestEmailStatus:null,uploadImageStatus:null,uploadImageURL:"",mergeTagsContext:""},k={setStateProps:function(e){return{type:"setStateProps",payload:e}}},T=function(e,t){if(!t||!t.type)return e;switch(t.type){case"setStateProps":if(t.payload)return E(E({},e),t.payload)}return e},P=Object(r.createContext)(),N=function(e,t){var n,a=v(Object(r.useReducer)(T,C,(n=e,function(e){if(!n)return e;var t=!n.ab_type||"ab"===n.ab_type,r=n.content?n.content:[];r=Array.isArray(r)&&!t?[r[0]]:r;var a,o=n.smart_send&&t?n.smart_send:{},c={};if(Array.isArray(r)&&0!==Object(u.size)(r))for(var i in r)c[parseInt(i)+1]=E({},"type"in(a=r[i])?a:E(E({},a),{},{type:"rich"}));return E(E({},e),{},{data:E(E({},e.data),c),emails:Object.keys(E(E({},e.data),c)).map((function(e){return parseInt(e)})),smartSend:E(E({},e.smartSend),{},{sendSmartData:o}),from_name:n&&n.from_name?n.from_name:e.from_name,from_email:n&&n.from_email?n.from_email:e.from_email,reply_to:n&&n.reply_to?n.reply_to:e.reply_to,ab_type:n.ab_type?n.ab_type:e.ab_type,objectId:n.objectId?n.objectId:e.objectId,mergeTagsContext:n.mergeTagsContext?n.mergeTagsContext:e.mergeTagsContext})})),2),o=a[0],c=a[1],i=f(o);return[i,w(c,i,k,t)]};function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},M=function(e){var t=Object(r.useContext)(P),n=t.selectors,a=t.dispatchers.sendTestEmail,o=(0,n.getSendTestEmailStatus)(),c=x(Object(r.useState)("http://app.getautonami.com"),2),i=c[0],u=c[1],l=Object(r.useRef)();Object(r.useEffect)((function(){l.current=e}),[e]);var s=function(t){if(-1!==t.origin.indexOf("app.getautonami.com")&&t.data&&t.data.action&&"send_test_email"===t.data.action&&t.data.token===A.editor_nonce&&t.data.data){var n=t.data.data,r=n.email,o=n.body,c=n.subject;r&&o&&c&&(u(t.origin),a(r,e,c,o))}};return Object(r.useEffect)((function(){return window.addEventListener("message",s),function(){return window.removeEventListener("message",s)}}),[]),Object(r.useEffect)((function(){if(o&&1!==o){var e=2===o,t=document.getElementById("bwf_email_editor_frame");t&&t.contentWindow.postMessage({token:A.editor_nonce,action:"send_test_email",data:{isSent:e}},i)}}),[o]),!0};function D(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||R(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||R(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){if(e){if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var B=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},U=function(e){var t=Object(r.useContext)(P),n=t.selectors,a=t.dispatchers.saveEmailContent,o=n.getSaveContentStatus,c=n.getEmailsToSubmit,i=n.getCurrentEmailIndex,u=o(),l=c(),s=i(),m=Object(r.useRef)(l),f=Object(r.useRef)(s);Object(r.useEffect)((function(){m.current=l,f.current=s}),[l,s]);var b=L(Object(r.useState)("http://app.getautonami.com"),2),d=b[0],p=b[1],g=function(e){if(-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"save_design"===e.data.action&&e.data.token===B.editor_nonce&&e.data.data){var t=e.data.data,n=t.body,r=t.design;if(n&&r){p(e.origin);var o=D(l);o[s].editor={body:n,design:r},a(o)}}};return Object(r.useEffect)((function(){return window.addEventListener("message",g),function(){return window.removeEventListener("message",g)}}),[]),Object(r.useEffect)((function(){if(u&&1!==u&&e){var t=2===u,n=document.getElementById("bwf_email_editor_frame");n&&n.contentWindow.postMessage({token:B.editor_nonce,action:"save_design",data:{isSaved:t}},d)}}),[u]),!0};function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var q=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},$=function(){var e=V(Object(r.useState)("http://app.getautonami.com"),2),t=e[0],n=e[1],a=function(e){-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"wp_image_upload"===e.data.action&&e.data.token===q.editor_nonce&&e.data.data&&(n(e.origin),s())},c=Object(r.useRef)(),i=V(Object(r.useState)(""),2),u=i[0],l=i[1],s=function(){if(!wp||!wp.media)return"";c.current||(c.current=wp.media({title:Object(o.__)("Select or Upload Media","wp-marketing-automations-crm"),button:{text:"Select Image"},multiple:!1}),c.current.on("select",(function(){var e=c.current.state().get("selection").first().toJSON();l(e.url)}))),c.current.open()};return Object(r.useEffect)((function(){return window.addEventListener("message",a),function(){return window.removeEventListener("message",a)}}),[]),Object(r.useEffect)((function(){if(u){var e=document.getElementById("bwf_email_editor_frame");e&&e.contentWindow.postMessage({token:q.editor_nonce,action:"wp_image_upload",data:{isUploaded:!0,imageURL:u}},t)}}),[u]),!0},W=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},z=function(e){var t=Object(r.useContext)(P).selectors.getEmailContent(),n=Object(r.useRef)(),a=Object(r.useRef)();Object(r.useEffect)((function(){n.current=t,a.current=function(e){var t={};for(var n in e){var r=e[n];if(r){var a={};for(var o in r)a[o]={name:r[o],value:"{{".concat(o,"}}")};var c="";switch(n){case"contact":c="Contact";break;case"contact_fields":c="Fields";break;case"general":c="General"}t[n]={name:c,mergeTags:a}}}return t}(e)}),[t,e]);var o=function(e){if(-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"get_design"===e.data.action&&e.data.token===W.editor_nonce){var t=n.current&&n.current.editor&&n.current.editor.design?n.current.editor.design:"",r=document.getElementById("bwf_email_editor_frame");r&&r.contentWindow.postMessage({token:W.editor_nonce,action:"get_design",data:{gotDesign:!0,json:t,subject:n.current&&n.current.subject?n.current.subject:"",mergeTags:a.current}},e.origin)}};return Object(r.useEffect)((function(){return window.addEventListener("message",o),function(){return window.removeEventListener("message",o)}}),[]),!0},K=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},J=function(e){var t=function(t){-1!==t.origin.indexOf("app.getautonami.com")&&t.data&&t.data.action&&"open_merge_tags"===t.data.action&&t.data.token===K.editor_nonce&&t.data.data&&e&&e()};return Object(r.useEffect)((function(){return window.addEventListener("message",t),function(){return window.removeEventListener("message",t)}}),[]),!0},G=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},Q=function(e){var t=function(t){-1!==t.origin.indexOf("app.getautonami.com")&&t.data&&t.data.action&&"close_editor"===t.data.action&&t.data.token===G.editor_nonce&&t.data.data&&e&&e()};return Object(r.useEffect)((function(){return window.addEventListener("message",t),function(){return window.removeEventListener("message",t)}}),[]),!0},X=n(13);function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ee=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},te=function(){return Object(r.createElement)("div",{className:"bwf-c-save-content-loading"},Object(r.createElement)(s.a,null),Object(r.createElement)("h3",null,Object(o.__)("Loading Drag and Drop Builder","wp-marketing-automations-crm")))},ne=function(e){var t=e.iframeRef,n=e.editorSrc;return Object(r.createElement)("iframe",{ref:t,title:Object(o.__)("Email Editor","wp-marketing-automations"),src:n,id:"bwf_email_editor_frame",style:{width:"100%",height:"100%"}})},re=function(e){var t=Object(r.useContext)(P),n=t.selectors,c=t.dispatchers,i=Y(Object(r.useState)(!1),2),u=i[0],l=i[1],s=e.openMergeTags,m=e.mailData,f=e.mergeTags,b=ee.license,d=ee.editor_nonce,p=ee.url,g=c.fetchCurrentMailEditorContent,O=c.saveEmailContent,y=c.resetSaveContentStatus,j=n.getSaveContentStatus(),w=n.getObjectId(),v=Y(Object(r.useState)(!1),2),h=v[0],_=v[1];Object(r.useEffect)((function(){h||2!==j&&3!==j||(_(!0),y())}),[j]);var E=Object(r.useCallback)((function(){l(!1),g()}));z(f||[]),M(m),U(h),$(),J(s),Q(E);var S="//app.getautonami.com/get/".concat(b,"/").concat(d,"/").concat(p,"/").concat(w),C=Object(r.useRef)();return Object(r.useEffect)((function(){u?(O(),document.body.classList.add("bwf-c-modal-open")):(_(!1),document.body.classList.remove("bwf-c-modal-open"))}),[u]),Object(r.createElement)(r.Fragment,null,u&&Object(r.createElement)("div",{className:"bwf-c-editor-modal-wrapper"},Object(r.createElement)("div",{className:"bwf-c-editor-modal bwf-c-editor-modal-full-width"},!h&&Object(r.createElement)(te,null),!!h&&Object(r.createElement)(ne,{iframeRef:C,editorSrc:S}))),Object(r.createElement)("div",{className:"bwf-c-editor-button-wrapper"},Object(r.createElement)(X.a,{icon:"launch-editor",size:50}),Object(r.createElement)("div",{className:"bwf-h1"},"Launch Editor"),Object(r.createElement)("div",{className:"bwf-h5"},"Visually get email with drop & drop builder"),Object(r.createElement)(a.Button,{isSecondary:!0,onClick:function(){return l(!0)}},Object(o.__)("Start","wp-marketing-automations-crm"))))},ae=n(516),oe=n(224),ce=n(16),ie=n.n(ce);function ue(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var me=function(e){var t=e.setPreview,n=e.content,c=e.type,u=le(Object(r.useState)(""),2),l=u[0],m=u[1],f=le(Object(r.useState)(!0),2),b=f[0],d=f[1];Object(r.useEffect)((function(){p()}),[]);var p=function(){var e,t=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=4;break}return m(""),d(!1),e.abrupt("return");case 4:return e.prev=4,e.next=7,ie()({path:Object(i.g)("/broadcast/email-preview"),method:"POST",data:{content:n,type:c}}).then((function(e){m(e.result.body.replace(/\\/g,"")),d(!1)}));case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:case"end":return e.stop()}}),e,null,[[4,9]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){ue(o,r,a,c,i,"next",e)}function i(e){ue(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(r.createElement)(a.Modal,{title:Object(o.__)("Preview","wp-marketing-automations-crm"),onRequestClose:function(){return t(!1)},className:"bwf-admin-modal bwf-admin-modal-xxxl"},b?Object(r.createElement)(s.a,null):Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:l}}))},fe=(n(478),n(517)),be=n(520),de=n(124);function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){Oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return je(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return je(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var we=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},ve=function(){var e=ye(Object(r.useState)(!1),2),t=e[0],n=e[1],a=ye(Object(r.useState)(!1),2),o=a[0],c=a[1],u=Object(de.a)(Object(i.H)()).formatAmount,l=Object(r.useCallback)((function(e){var t=document.getElementById("bwf_email_editor_frame");t&&t.contentWindow.postMessage({token:we.editor_nonce,action:"select_product_for_tool",data:{product:ge(ge({},e),{},{formattedPrice:u(e.price)})}},o),n(!1)}),[o]),s=Object(r.useCallback)((function(e){-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"select_product_for_tool"===e.data.action&&e.data.token===we.editor_nonce&&(c(e.origin),n(!0))}),[n]);return Object(r.useEffect)((function(){return window.addEventListener("message",s),function(){return window.removeEventListener("message",s)}}),[]),t&&Object(r.createElement)(be.a,{onRequestClose:function(){return n(!1)},onProductSelected:l})};function he(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _e(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ee=Object(i.I)(),Se=[{label:Object(o.__)("Text","wp-marketing-automations-crm"),value:"rich",templateIcon:"rich-text",className:"bwf-display-flex bwf-campaign-template-type "},Ee.includes("wc")&&{label:Object(o.__)("WooCommerce","wp-marketing-automations-crm"),value:"wc",templateIcon:"woocommerce",className:"bwf-display-flex bwf-campaign-template-type "},{label:Object(o.__)("HTML","wp-marketing-automations-crm"),value:"html",templateIcon:"html",className:"bwf-display-flex bwf-campaign-template-type"},{label:Object(o.__)("Drag and Drop","wp-marketing-automations-crm"),value:"editor",templateIcon:"html",className:"bwf-display-flex bwf-campaign-template-type"}].filter(Boolean),Ce={rich:Object(o.__)("Text","wp-marketing-automations-crm"),wc:Object(o.__)("WooCommerce","wp-marketing-automations-crm"),html:Object(o.__)("HTML","wp-marketing-automations-crm"),editor:Object(o.__)("Drag and Drop","wp-marketing-automations-crm")},ke=function(e){var t=e.showSaveTemplate,n=e.showTypeSelector,s=Object(r.useContext)(P),m=s.selectors,f=s.dispatchers,b={senders_email:m.getFromEmail(),senders_name:m.getFromName(),reply_to:m.getReplyTo()},d=m.getObjectId(),p=m.getMergeTagsContext(),g=parseInt(m.getMode()),O=Object(i.j)(),y=f.setEmailContentByKey,j=f.setEmailUtmByKey,w=f.setMultipleUtm,v=f.sendTestEmail,h=f.resetSendTestEmailStatus,_=m.getEmailContent()?m.getEmailContent():{},E="utm"in _?_.utm:{},S=he(Object(r.useState)(!1),2),C=S[0],k=S[1],T=he(Object(r.useState)(""),2),N=T[0],x=T[1],I="subject"in _?_.subject:"",A="preheader"in _?_.preheader:"",M="type"in _?_.type:"rich",D="utmEnabled"in _&&_.utmEnabled,L=he(Object(r.useState)({message:"",type:1}),2),R=L[0],F=L[1],B="source"in E?E.source:"",U="medium"in E?E.medium:"",V="name"in E?E.name:"",H="content"in E?E.content:"",q="term"in E?E.term:"",$=he(Object(r.useState)(!1),2),W=$[0],z=$[1],K=m.getShowValidationFlag(),J=he(Object(r.useState)(!1),2),G=J[0],Q=J[1],X=he(Object(r.useState)("content"),2),Y=X[0],Z=X[1],ee=he(Object(r.useState)([]),2),te=ee[0],ne=ee[1],ce=m.getCurrentEmailIndex(),ie=_&&_.body?_.body:"",ue="editor"in _?_.editor:{},le=ue&&ue.body?ue.body:"",se="editor"===M?le:ie;Object(r.useEffect)((function(){if(D){var e={};!B&&(e.source=Object(o.__)("newsletter","wp-marketing-automations-crm")),!U&&(e.medium=O[g].label.toLowerCase()),w(e)}}),[D]);var be=m.validateCurrentEmail(),de=1===g?Object(o.__)("Place your HTML here","wp-marketing-automations-crm"):Object(o.__)("Enter the SMS body","wp-marketing-automations-crm"),pe=function(){return"editor"==_.type?_.hasOwnProperty("editor")&&_.editor.hasOwnProperty("body")?_.editor.body:_.hasOwnProperty("editor")&&_.editor.hasOwnProperty("editor")?_.editor.editor:"":_.body},ge=m.getSendTestEmailStatus();Object(r.useEffect)((function(){null!==ge&&setTimeout((function(){h(),F({message:"",type:1})}),2e3),2===ge&&F({message:Object(o.__)("Test mail sent successfully.","wp-marketing-automations-crm"),type:1}),3===ge&&F({message:Object(o.__)("Test mail failed to send","wp-marketing-automations-crm"),type:1})}),[ge]);var Oe=K&&!be.subject?" bwf-field-error":"",ye=K&&!be.content?" bwf-field-error-textarea":"",je=K&&!be.utmSource?" bwf-field-error":"",we=K&&!be.utmMedium?" bwf-field-error":"";return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-c-campaign-body"},1===g&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(a.TextControl,{value:I,onChange:function(e){return y("subject",e)},label:Object(o.__)("Subject","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter Subject","wp-marketing-automations-crm"),className:"bwf-field-m0"+Oe}),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-campaign-mail-headers-wrap"},Object(r.createElement)(a.TextControl,{value:A,placeholder:Object(o.__)("Enter Preview Text","wp-marketing-automations-crm"),label:Object(o.__)("Preview Text","wp-marketing-automations-crm"),onChange:function(e){return y("preheader",e)}})),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.Flex,{align:"flex-end"},Object(r.createElement)(a.FlexBlock,null,n?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-p"},Object(o.__)("Template Type","wp-marketing-automations-crm")),Object(r.createElement)("div",null,Object(r.createElement)(a.ButtonGroup,null,Se.map((function(e){return Object(r.createElement)(a.Button,{key:e.value,isPrimary:M&&e.value==M,isSecondary:M&&e.value!=M,onClick:function(){return y("type",e.value)}},e.label)}))))):Object(r.createElement)("div",{className:"bwf-p"},Object(o.__)("Template Type","wp-marketing-automations-crm")," ",":"," ",Ce.hasOwnProperty(M)?Ce[M]:Ce.rich)),"editor"!==M&&Object(r.createElement)(a.FlexItem,null,Object(r.createElement)(a.Button,{isSecondary:!0,className:"bwf-big-button",onClick:function(){Z("content"),Q(!0)}},Object(o.__)("Merge Tags","wp-marketing-automations-crm"))))),Object(r.createElement)("div",{className:"bwf_clear_15"}),Object(r.createElement)("div",{className:ye},1===g&&("rich"===M||"wc"===M)&&Object(r.createElement)(l.a,{content:se,keyid:"bwf-campaign-email-editor",setContent:function(e){return y("body",e)}}),("html"===M||2===g)&&Object(r.createElement)(a.TextareaControl,{value:se,onChange:function(e){return y("body",e)},placeholder:de,rows:2===g?5:30}),"editor"===M&&Object(r.createElement)(re,{objectId:d,contentNumber:parseInt(ce),openMergeTags:function(){return Q(!0)},mailData:b,mergeTags:te})),Object(r.createElement)("div",{className:"bwf_clear_20"}),"editor"!==M&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexItem,null,Object(r.createElement)("a",{isTertiary:!0,className:"bwf-a-no-underline",onClick:function(e){e.preventDefault(),Z("content");var t=2===g?bwfanParams.bwfan_global_settings.bwfan_sms_unsubscribe_text:bwfanParams.bwfan_global_settings.bwfan_email_footer_setting;y("body","".concat(se||""," \n").concat(t))}},Object(o.__)("Add Unsubscribe Text","wp-marketing-automations-crm")))),Object(r.createElement)("div",{className:"bwf_clear_20"})),Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexItem,null,1==g&&Object(r.createElement)(r.Fragment,null,t&&Object(r.createElement)(fe.a,{templateData:_,type:1}),Object(r.createElement)(a.Button,{className:t?"bwf-ml-5":" bwf-big-button",isSecondary:!0,onClick:function(){k(!0)}},Object(o.__)("Send Test Email","wp-marketing-automations-crm"),C&&Object(r.createElement)(a.Popover,{onFocusOutside:function(){k(!1)},onClick:function(e){return e.stopPropagation()},className:"bwf-crm-mail-comp-test-mail"},Object(r.createElement)("div",{className:"bwf-campaign-test-mail-wrap"},Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)("div",{className:"bwf-p"},Object(r.createElement)(a.TextControl,{value:N,onChange:function(e){return x(e)},placeholder:Object(o.__)("Enter email","wp-marketing-automations-crm")})),Object(r.createElement)(a.Button,{isPrimary:!0,className:"bwf-big-button",onClick:function(e){if(e.preventDefault(),n=!1,!Object(u.isEmpty)(N)&&Object(c.a)(N)&&be.subject&&be.content&&be.type&&be.utmMedium&&be.utmSource||(n=!0),n){var t="";Object(u.isEmpty)(N)&&(t=Object(o.__)("Email is required field.","wp-marketing-automations-crm")),Object(u.isEmpty)(t)&&!Object(c.a)(N)&&(t=Object(o.__)("Entered email is not valid.","wp-marketing-automations-crm")),Object(u.isEmpty)(t)&&!be.subject&&(t=Object(o.__)("Subject is required field.","wp-marketing-automations-crm")),Object(u.isEmpty)(t)&&!be.content&&(t=Object(o.__)("Mail content is required field.","wp-marketing-automations-crm")),F({message:t,type:2})}else v(N,b);var n}},Object(o.__)("Send mail","wp-marketing-automations-crm"))))),Object(r.createElement)(a.Button,{isSecondary:!0,className:"bwf-ml-5 bwf-big-button",onClick:function(){Object(u.isEmpty)(pe())?F({message:"No content available for preview.",status:2}):z(!0)}},Object(o.__)("Show Preview","wp-marketing-automations-crm")),W&&Object(r.createElement)(me,{setPreview:z,content:pe(),type:M})))),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.CheckboxControl,{checked:D,label:Object(o.__)("Automatically append UTM parameters to email links","wp-marketing-automations-crm"),className:"bwf-crm-campaign-third-step-utm",onChange:function(e){return y("utmEnabled",e)}}),D&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)("div",{className:"bwf-campaign-utm-section"},Object(r.createElement)(a.TextControl,{value:B,onChange:function(e){return j("source",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Source","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM source","wp-marketing-automations-crm"),help:Object(o.__)("Referrer: (e.g., google, newsletter)","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"+je}),Object(r.createElement)(a.TextControl,{value:U,onChange:function(e){return j("medium",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Medium","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM medium","wp-marketing-automations-crm"),help:Object(o.__)("Marketing medium: (e.g., CPC, banner, email)","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"+we}),Object(r.createElement)(a.TextControl,{value:V,onChange:function(e){return j("name",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Name","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM name","wp-marketing-automations-crm"),help:Object(o.__)("Product, promo code, or slogan (e.g., spring_sale)","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"}),Object(r.createElement)(a.TextControl,{value:q,onChange:function(e){return j("term",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Term","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM term","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"}),Object(r.createElement)(a.TextControl,{value:H,onChange:function(e){return j("content",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Content","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM content","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"}))),Object(r.createElement)(oe.a,{message:R.message,type:R.type,removeMessage:function(){return F({message:"",type:1})}})),Object(r.createElement)(ae.a,{isOpen:G,setOpenTags:Q,onMergeTagSelected:function(e){"subject"===Y&&y("subject","".concat(I||""," ").concat(e)),"content"===Y&&y("body","".concat(se||""," ").concat(e)),Q(!1)},onMergeTagsLoaded:function(e){return ne(e)},context:p}),Object(i.W)()&&Object(r.createElement)(ve,null))},Te=n(15),Pe=n.n(Te),Ne=(n(555),n(117)),xe=function(){var e=Object(r.useContext)(P),t=e.selectors,n=e.dispatchers,c=t.getSmartSendSettings(),i=c.enable,u=c.percent,l=c.hours,s=n.setSmartSendByKey,m=t.getShowValidationFlag(),f=t.getEmails();return Array.isArray(f)&&f.length>1?Object(r.createElement)(a.Card,{className:"bwf-c-campaign-email"},Object(r.createElement)("div",{className:"bwf-h4"},Object(o.__)("Smart Sending","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.ToggleControl,{label:Object(o.__)("Enable Smart Sending","wp-marketing-automations-crm"),className:"bwf-tooglecontrol-advance",checked:i,onChange:function(e){return s("enable",e)}}),i&&parseInt(u)>0&&parseInt(l)>0&&Object(r.createElement)("div",null,Object(o.sprintf)(Object(o.__)("This broadcast will be sent to %d percent of your contacts. After %d hours, open rates of all the variants would be analyzed and the one with the most opens would be sent to the remaining contacts.","wp-marketing-automations-crm"),parseInt(u),parseInt(l))),i&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.TextControl,{type:"number",value:u,onChange:function(e){return s("percent",e)},label:Object(o.__)("Sample size (in percent)","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter percent","wp-marketing-automations-crm"),className:Pe()({"bwf-field-comp-label-content":!0,"bwf-field-error":m&&!parseInt(u)})}),Object(r.createElement)(a.TextControl,{type:"number",value:l,onChange:function(e){return s("hours",e)},label:Object(o.__)("Wait time (in hours)","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter hour difference","wp-marketing-automations-crm"),className:Pe()({"bwf-field-comp-label-content":!0,"bwf-field-error":m&&!parseInt(l)})}))):null},Ie="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Ae=function(e){var t=e.showSaveTemplate,n=e.showTypeSelector,c=Object(r.useContext)(P),i=c.selectors,u=c.dispatchers,l=u.setCurrentEmail,s=u.addEmail,m=u.showValidation,f=u.deleteEmail,b=i.getEmails(),d=i.getCurrentEmail(),p=i.getSmartSendSettings(),g=i.emailsValidToSubmit(),O=i.getShowValidationFlag(),y=i.getValidEmails(),j=i.getABType(),w=!j||"ab"===j,v=Object(r.useRef)(!1),h=Object(r.useCallback)((function(e){return Pe()({active:d===e,"bwf-error-tab":!y[e]&&O})})),_=!![!p.enable||!!parseInt(p.hours)&&b.length>1,!p.enable||!!parseInt(p.percent)&&b.length>1].reduce((function(e,t){return e&&t}),!0);return Object(r.createElement)(r.Fragment,null,(!g||!_)&&O&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Ne.a,null),Object(r.createElement)(a.Notice,{className:"bwf-error-notice",status:"error",onRemove:function(){return m(!1)}},Object(o.__)("Some required fields are not filled, check below","wp-marketing-automations-crm"))),w&&Object(r.createElement)("div",{className:"bwf-c-campaign-email-tabs"},Object(r.createElement)("ul",null,b.map((function(e,t){return Object(r.createElement)("li",{onClick:function(){return function(e){!v.current&&l(e),v.current=!1}(e)},className:h(e)},Object(o.__)(0===t?"Control ":"Variant ","wp-marketing-automations-crm")," ",t>0&&Ie[parseInt(t)%Ie.length-1],t>0&&Object(r.createElement)(a.Button,{icon:"no",onClick:function(){return function(e){v.current=!0,f(e)}(e)}}))})),b.length<3&&Object(r.createElement)("li",{className:"bwf-c-campaign-email-variant"},Object(r.createElement)(a.Button,{icon:"plus",onClick:function(){return s()}},Object(o.__)("Add Variant","wp-marketing-automations-crm"))))),Object(r.createElement)(ke,{showSaveTemplate:t,showTypeSelector:n}),Object(r.createElement)(xe,null))},Me=n(518);function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){Re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fe(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}function Be(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ue(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a=function(e){var t=e.onEmailContentReady,n=e.onEmailContentError,l=e.initData,s=e.disableDefaultButtons,m=void 0!==s&&s,f=e.validateEmailContent,b=void 0!==f&&f,d=e.setPending,p=void 0===d?function(){}:d,g=e.apiMethods,O=void 0===g?{}:g,y=e.showSenderInfo,j=void 0===y||y,w=e.showTemplateTypeSelector,v=void 0===w||w,h=e.showSaveTemplate,_=void 0===h||h,E=e.returnData,S=void 0!==E&&E,C=e.showTab,k=void 0===C||C,T=e.setMailData,x=Be(N(l||{},O),2),I=x[0],A=x[1],M=I.getFromName(),D=I.getFromEmail(),L=I.getReplyTo(),R=parseInt(I.getMode()),F={name:1!==R||null===M||M.length>0,email:1!==R||null===D||Object(c.a)(D)};if(S){var B=I.getAllEmailContent();Object(r.useEffect)((function(){T(B)}),[B])}var U=I.emailsValidToSubmit(),V=I.getEmails(),H=I.getSmartSendSettings(),q=!![1!==R||M&&M.length>0,1!==R||D&&Object(c.a)(D),1!==R||Object(u.isEmpty)(L)||L&&Object(c.a)(L)].reduce((function(e,t){return e&&t}),!0),$=!![!H.enable||!!parseInt(H.hours)&&V.length>1,!H.enable||!!parseInt(H.percent)&&V.length>1].reduce((function(e,t){return e&&t}),!0),W=function(){var e,r=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:A.showValidation(!1),q&&U&&$?(p&&p(!0),t&&t(Le({content:V.map((function(e){return U[e]})),from_name:M,from_email:D,reply_to:L,modified_by:Object(i.n)()},H.enable?{smart_send:{enable:H.enable,percent:H.percent,hours:H.hours}}:{})),p&&p(!1)):(n&&n(),A.showValidation(!0));case 2:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){Fe(o,r,a,c,i,"next",e)}function i(e){Fe(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(){return r.apply(this,arguments)}}();Object(r.useEffect)((function(){b&&W()}),[b]);var z=F&&!F.email?" bwf-field-error":"",K=F&&!F.name?" bwf-field-error":"",J=Object(r.useContext)(i.b);return Object(r.createElement)(P.Provider,{value:{selectors:I,dispatchers:A}},Object(r.createElement)("div",{className:"bwf-campaign-step-div bwf-campaign-step-3"},1===R&&j&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(a.Card,{className:"bwf-p-25"},Object(r.createElement)("div",{className:"bwf-c-campaign-email"},Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.TextControl,{value:M,onChange:A.setFromName,label:Object(o.__)("From Name","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter From Name","wp-marketing-automations-crm"),className:K}))),Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.TextControl,{value:D,onChange:A.setFromEmail,label:Object(o.__)("From Email","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter From Email","wp-marketing-automations-crm"),className:z}))),Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.TextControl,{value:L,placeholder:Object(o.__)("Enter Reply-To Email","wp-marketing-automations-crm"),label:Object(o.__)("Reply-To Email","wp-marketing-automations-crm"),onChange:A.setReplyTo}))))),Object(r.createElement)("div",{className:"bwf_clear_20"})),Object(r.createElement)("div",{className:"bwf-email-editor-wrap"},1===R&&k&&Object(r.createElement)("div",{className:"bwf-c-email-editor-tabs"},Object(r.createElement)("ul",{className:"bwf-h3"},Object(o.__)("Email Settings","wp-marketing-automations-crm")),Object(r.createElement)("span",{className:"bwf-c-campaign-template-selector"},Object(r.createElement)(Me.a,{applyTemplate:function(e){A.overrideCurrentContent(e),J(Object(o.__)("Template Applied Successfully.","wp-marketing-automations-crm")),setTimeout((function(){J("")}),2e3)}}))),Object(r.createElement)(a.Card,{className:"bwf-p-25"},Object(r.createElement)(Ae,{showSaveTemplate:_,showTypeSelector:v}))),Object(r.createElement)("div",{className:"bwf_clear_20"}),!m&&Object(r.createElement)("div",{className:"bwf-crm-campaign-navigation"},Object(r.createElement)(a.Button,{isPrimary:!0,className:"bwf-crm-navigation-next bwf-big-button",disabled:!q,onClick:W},Object(o.__)("Next","wp-marketing-automations-crm")))))}},700:function(e,t,n){},792:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(7),o=n(114),c=n(20),i=n(16),u=n.n(i),l=n(112);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var d=function(){var e=Object(l.a)("singleTemplateData"),t=e.fetch,n=e.setStateProp;return m(m({},b(e,["fetch","setStateProp"])),{},{fetch:function(e){t("GET",Object(a.g)("/template/".concat(e)))},setTemplateData:function(e){n("data",e)}})},p=n(5);function g(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}function O(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){g(o,r,a,c,i,"next",e)}function i(e){g(o,r,a,c,i,"throw",e)}c(void 0)}))}}var y=function(e,t){var n,r,o,c,i=d().setTemplateData;return{sendTestEmail:(c=O(regeneratorRuntime.mark((function e(t,n,r,o,c,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u()({method:"POST",path:Object(a.g)("/send-test-email"),data:{email:t,content:{subject:n,body:r,type:o,mail_data:c,preheader:i}}});case 3:return e.abrupt("return",2);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",3);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(e,t,n,r,a,o){return c.apply(this,arguments)}),saveEditorContent:(o=O(regeneratorRuntime.mark((function n(r){var o,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(""!=r[0].editor.body){n.next=2;break}return n.abrupt("return",2);case 2:return o=t,"editor"===(c=Object(p.isEmpty)(r)?{}:r[0]).type?c.hasOwnProperty("editor")&&(c.editor.hasOwnProperty("body")&&(o.template=c.editor.body),c.editor.hasOwnProperty("design")&&(o.data.design=c.editor.design)):o.template=c.body,n.prev=5,n.next=8,u()({method:"POST",path:Object(a.g)("/template/".concat(e,"/save-email-content")),data:{template:o.template,data:o.data}}).then((function(e){200==e.code&&i(e.result)}));case 8:return n.abrupt("return",2);case 11:return n.prev=11,n.t0=n.catch(5),n.abrupt("return",3);case 14:case"end":return n.stop()}}),n,null,[[5,11]])}))),function(e){return o.apply(this,arguments)}),uploadImage:(r=O(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("image",t),e.prev=2,e.next=5,u()({method:"POST",path:Object(a.g)("/upload-image"),body:n});case 5:return r=e.sent,e.abrupt("return",r&&r.result?r.result:"");case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return","");case 12:case"end":return e.stop()}}),e,null,[[2,9]])}))),function(e){return r.apply(this,arguments)}),fetchCurrentMailEditorContent:(n=O(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","");case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})}},j=n(557),w=n(9),v=n(46);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var C={1:"rich",2:"wc",3:"html",4:"editor"},k=function(){var e=Object(v.a)("singleTemplateData"),t=e.getStateProp;return _(_({},S(e,["getStateProp"])),{},{getTemplateData:function(){return t("data")},getFormattedTemplateData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(p.isEmpty)(e))return{};var t={body:"",editor:{body:"",design:""},preheader:"",subject:"",type:"rich",utm:{source:"Newsletter",medium:"email",name:"",content:"",term:""},utmEnabled:!1};return e.hasOwnProperty("template")&&(e.hasOwnProperty("mode")&&4===parseInt(e.mode)?t.editor.body=e.template:t.body=e.template),e.hasOwnProperty("subject")&&(t.subject=e.subject),e.hasOwnProperty("mode")&&(t.type=C[e.mode]),e.hasOwnProperty("subject")&&(t.subject=e.subject),e.hasOwnProperty("data")&&(t.subject=e.subject,e.data.hasOwnProperty("preheader")&&(t.preheader=e.data.preheader),e.data.hasOwnProperty("utmEnabled")&&e.data.utmEnabled&&(t.utmEnabled=e.data.utmEnabled),e.data.hasOwnProperty("utm")&&(t.utm=e.data.utm),e.data.hasOwnProperty("design")&&4===parseInt(e.mode)&&(t.editor.design=e.data.design)),t}})},T=n(4),P=n(137),N=n(117);function x(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R=function(e){var t=e.templateId,n=d(),c=n.fetch,i=n.setTemplateData,l=k(),s=l.getLoading,m=l.getTemplateData,f=l.getFormattedTemplateData,b={rich:1,wc:2,html:3,editor:4},g=Object(o.a)().setL2Title,O=D(Object(r.useState)({loading:!1,status:!1}),2),v=O[0],h=O[1],_=D(Object(r.useState)([]),2),E=_[0],S=_[1];Object(r.useEffect)((function(){parseInt(t)>0&&c(t)}),[]);var C=s(),I=m();Object(r.useEffect)((function(){g(I.hasOwnProperty("title")?I.title:"")}),[C,I]);var M=function(){var e,n=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L()){e.next=10;break}return h({status:!0,loading:!0}),e.prev=2,e.next=5,u()({path:Object(a.g)("/template/".concat(t)),method:"POST",data:I}).then((function(e){200==e.code&&h({status:!0,success:e.message})}));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),h({status:!0,error:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[2,7]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){x(o,r,a,c,i,"next",e)}function i(e){x(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(){return n.apply(this,arguments)}}(),L=function(){var e=!1,t=[];return I.hasOwnProperty("title")&&!Object(p.isEmpty)(I.title)||(e=!0,t.push(Object(T.__)("Title is required field.","wp-marketing-automations-crm"))),I.hasOwnProperty("subject")&&!Object(p.isEmpty)(I.subject)||(e=!0,t.push(Object(T.__)("Subject is required field.","wp-marketing-automations-crm"))),I.hasOwnProperty("template")&&!Object(p.isEmpty)(I.template)||(e=!0,t.push(Object(T.__)("Email content cannot be empty.","wp-marketing-automations-crm"))),S(t),e},R=Object(r.createElement)(w.Card,{className:"bwf-template-card bwf-p-15 bwf-template-placeholder"},[1,2,3].map((function(e){return Object(r.createElement)("div",{key:e,className:"bwf-placeholder-temp"})})),Object(r.createElement)("div",{className:"bwf-btn-section"},Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-btn bwf-h-zero"}),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-btn"})),Object(r.createElement)("div",{key:4,className:"bwf-editor-placeholder"}),Object(r.createElement)("div",{className:"bwf-btn-section"},Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-btn"}),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-btn"})),Object(r.createElement)("div",{key:5,className:"bwf-placeholder-temp"}));return Object(r.createElement)("div",{className:"bwfcrm-overview-wrap bwf-crm-single-template-section"},C||Object(p.isEmpty)(I)?R:Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-template-card"},Object(r.createElement)("div",{className:"bwf-template-card-header bwf-h4"},Object(T.__)("Template","wp-marketing-automations-crm")),Object(r.createElement)(w.Card,{className:"bwf-name-card bwf-p-25"},!Object(p.isEmpty)(E)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(N.a,null),Object(r.createElement)(w.Notice,{status:"error",isDismissible:!1,className:"bwf-mtb-10"},E.map((function(e){return Object(r.createElement)(r.Fragment,null,e,Object(r.createElement)("br",null))})))),Object(r.createElement)(w.TextControl,{label:Object(T.__)("Name","wp-marketing-automations-crm"),placeholder:Object(T.__)("Enter Template Name","wp-marketing-automations-crm"),value:I.hasOwnProperty("title")?I.title:"",autocomplete:"off",onChange:function(e){i(A(A({},I),{},{title:e}))}})),Object(r.createElement)(j.a,{disableDefaultButtons:!0,initData:{content:[f(I)]},validateEmailContent:!1,apiMethods:y?y(t,I):{},showSenderInfo:!1,showSaveTemplate:!1,showTemplateTypeSelector:!0,returnData:!0,setMailData:function(e){var t=I;(e=e[1]).hasOwnProperty("subject")&&(t.subject=e.subject),e.hasOwnProperty("preheader")&&(t.data=A(A({},t.data),{},{preheader:e.preheader})),e.hasOwnProperty("type")&&b.hasOwnProperty(e.type)&&(t.mode=b[e.type]),e.hasOwnProperty("utmEnabled")&&(t.data=A(A({},t.data),{},{utmEnabled:e.utmEnabled})),e.hasOwnProperty("utm")&&(t.data=A(A({},t.data),{},{utm:e.utm})),"editor"===e.type?e.hasOwnProperty("editor")&&(e.editor.hasOwnProperty("body")&&(t.template=e.editor.body),e.editor.hasOwnProperty("design")&&(t.data.design=e.editor.design)):t.template=e.body,i(A(A({},I),t))},showTab:!1})),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-crm-stepper-navigation bwf_text_right"},Object(r.createElement)(w.Button,{isPrimary:!0,className:"bwf-crm-navigation-next bwf-big-button",onClick:function(){M()}},Object(T.__)("Save","wp-marketing-automations-crm")))),Object(r.createElement)(P.a,{confirmText:v.confirmText,confirmButtonText:v.buttonConfirm,cancelButtonText:v.buttonCancel,onConfirm:v.onConfirm,isLoading:v.loading,successMessage:v.success,errorMessage:v.error,onRequestClose:function(){return h({status:!1})},isOpen:v.status}))},F=n(552);n(700),t.default=function(e){var t=e.match.params.id,n=Object(c.h)(),i=Object(o.a)(),u=i.setBackLink,l=i.setBackLinkLabel,s=i.setL2Nav;return Object(F.a)(Object(T.__)("Templates","wp-marketing-automations-crm")),Object(r.useEffect)((function(){Object(a.d)("Template #"+t),s(""),u(Object(c.f)({},"/templates",n)),l("All Templates")})),Object(r.createElement)(R,{templateId:t,query:n})}}}]);