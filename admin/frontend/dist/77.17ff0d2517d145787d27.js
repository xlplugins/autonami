(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{224:function(e,t,a){"use strict";var r=a(0);a(257);t.a=function(e){return Object(r.useEffect)((function(){setTimeout((function(){e.removeMessage()}),5e3)}),[e.message]),Object(r.createElement)(r.Fragment,null,e.message&&Object(r.createElement)("div",{id:"bwfcrm-message-notice"},Object(r.createElement)("span",{className:"bwfcrm-message-text"},e.message)))}},257:function(e,t,a){},723:function(e,t,a){"use strict";a.r(t);var r=a(0),c=a(9),n=a(4),m=a(7),s=a(16),i=a.n(s),o=a(176),l=a(460),b=a(30),w=a.n(b),p=a(5),u=a(20),d=a(17),f=a(368),O=a(120),j=a(121),g=a(109),v=a(224),E=a(117),_=a(13);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function y(e,t,a,r,c,n,m){try{var s=e[n](m),i=s.value}catch(e){return void a(e)}s.done?t(i):Promise.resolve(i).then(r,c)}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,c=!1,n=void 0;try{for(var m,s=e[Symbol.iterator]();!(r=(m=s.next()).done)&&(a.push(m.value),!t||a.length!==t);r=!0);}catch(e){c=!0,n=e}finally{try{r||null==s.return||s.return()}finally{if(c)throw n}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return k(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}t.default=function(e){var t=location&&location.search?Object(d.parse)(location.search.substring(1)):{},a=N(Object(r.useState)(!1),2),s=(a[0],a[1]),b=N(Object(r.useState)(!1),2),k=b[0],S=b[1],C=N(Object(r.useState)(1),2),P=C[0],I=C[1],x=N(Object(r.useState)(""),2),T=x[0],M=x[1],A=N(Object(r.useState)({loading:!1,error:!1,success:!1,message:""}),2),D=A[0],B=A[1],R=N(Object(r.useState)(!1),2),L=R[0],F=R[1],H=N(Object(r.useState)(!1),2),U=H[0],Y=H[1],q=N(Object(r.useState)({}),2),J=q[0],V=q[1],G={rich:Object(n.__)("Rich Text","wp-marketing-automations-crm"),wc:Object(n.__)("WooCommerce","wp-marketing-automations-crm"),html:Object(n.__)("HTML","wp-marketing-automations-crm"),editor:Object(n.__)("Editor","wp-marketing-automations-crm")},W=N(Object(r.useState)({message:"",type:1}),2),$=W[0],z=W[1],K=Object(l.a)().setCampaignValues,Q=Object(m.j)(),X=o.a.getCampaignData(),Z=o.a.getCampaignId(),ee=parseInt(X.type);Object(r.useEffect)((function(){if(X)if(X.hasOwnProperty("execution_time")&&!Object(p.isNull)(X.execution_time)){var e=new Date(Object(m.q)(X.execution_time));I(2),M(e)}else{var t=new Date;M(t)}}),[]),Object(r.useEffect)((function(){document.addEventListener("click",(function(e){var t=document.getElementsByClassName("bwf-crm-campaign-schedule-popover")[0],a=!0;void 0!==t&&t.contains(e.target)&&(a=!1),k&&"bwf-crm-campaign-review-schedule-text-box"!=e.target.id&&a&&S(!1)}))}));var te,ae,re,ce=X?X.count:0,ne=[{value:1,className:"bwf-crm-campaign-schedule bwf-crm-campaign-schedule-now",label:Object(n.__)("Broadcast Now","wp-marketing-automations-crm")},{value:2,className:"bwf-crm-campaign-schedule bwf-crm-campaign-schedule-later",label:Object(n.__)("Schedule For Later","wp-marketing-automations-crm")}],me=function(){var a,r=(a=regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.setPending(!0),B({loading:!0,error:!1,success:!1,message:""}),!(ce<=0)){a.next=6;break}return B({loading:!0,error:!0,success:!1,message:Object(n.__)("No Contacts are selected.","wp-marketing-automations-crm")}),setTimeout((function(){B({loading:!1,error:!1,success:!1,message:""})}),2e3),a.abrupt("return");case 6:return a.prev=6,a.next=9,i()({path:Object(m.g)("/broadcast/".concat(Z)),method:"POST",data:{data:{schedule_time:w()(T).utc().format(),modified_by:Object(m.n)()},step:4},headers:{"Content-Type":"application/json"}}).then((function(e){200==e.code&&(K("data",e.result),B({loading:!0,error:!1,success:!0,message:e.message}),2==P&&setTimeout((function(){Object(u.j)({page:t.page,path:"/broadcast/"+Z},"/",{})}),2e3))}));case 9:a.next=15;break;case 11:a.prev=11,a.t0=a.catch(6),B({loading:!0,error:!0,success:!1,message:a.t0.message}),setTimeout((function(){B({loading:!1,error:!1,success:!1,message:""})}),2e3);case 15:e.setPending(!1);case 16:case"end":return a.stop()}}),a,null,[[6,11]])})),function(){var e=this,t=arguments;return new Promise((function(r,c){var n=a.apply(e,t);function m(e){y(n,r,c,m,s,"next",e)}function s(e){y(n,r,c,m,s,"throw",e)}m(void 0)}))});return function(){return r.apply(this,arguments)}}();return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(E.a,null),Object(r.createElement)("div",{className:"bwf-campaign-step-div bwf-card-wrap bwf-campaign-step-4"},Object(r.createElement)("div",{className:"bwf-card-header"},Object(r.createElement)("span",{className:"bwf-form-title"},Object(n.__)("Review & Schedule","wp-marketing-automations-crm"))),Object(r.createElement)("div",{className:"bwf-p-gap"},Object(r.createElement)("div",{className:"bwf-p-gap bwf-border"},Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Information","wp-marketing-automations-crm")),Object(r.createElement)(c.CardBody,null,Object(r.createElement)("div",{className:"bwf-report-row",key:1},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Title","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},X.title)),Object(r.createElement)("div",{className:"bwf-report-row",key:2},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Type","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Q[ee].label)),!!X.description&&Object(r.createElement)("div",{className:"bwf-report-row",key:3},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Description","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},X.description)))))),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-p-gap bwf-border"},Object(r.createElement)(r.Fragment,null,Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Contacts","wp-marketing-automations-crm")),Object(r.createElement)(c.CardBody,null,Object(r.createElement)("div",{className:"bwf-report-row",key:1},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Total","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Object(r.createElement)("b",null,ce))),X.data.hasOwnProperty("filters")&&!Object(p.isEmpty)(X.data.filters)&&Object(r.createElement)("div",{className:"bwf-report-row",key:2},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Segments","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Object(f.b)(X.data.filters)))))))),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-p-gap bwf-border"},Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Content","wp-marketing-automations-crm")),Object(r.createElement)(c.CardBody,null,ee&&1==ee&&X.data.hasOwnProperty("senders_name")&&!Object(p.isEmpty)(X.data.senders_name)&&Object(r.createElement)("div",{className:"bwf-report-row",key:1},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("From Name","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},X.data.senders_name)),ee&&1==ee&&X.data.hasOwnProperty("senders_email")&&!Object(p.isEmpty)(X.data.senders_email)&&Object(r.createElement)("div",{className:"bwf-report-row",key:2},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("From Email","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},X.data.senders_email)),ee&&1==ee&&X.data.hasOwnProperty("replyto")&&!Object(p.isEmpty)(X.data.replyto)&&Object(r.createElement)("div",{className:"bwf-report-row",key:3},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Reply-To Email","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value"},X.data.replyto)),X.data&&X.data.content&&X.data.content.map((function(e,t){return Object(r.createElement)("div",{className:"bwf-report-row",key:6},Object(r.createElement)("div",{className:"bwf-report-row-label"},X.data.content.length>1?Object(n.__)("Content #","wp-marketing-automations-crm")+(parseInt(t)+1):Object(n.__)("Content","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-report-row-value bwf-report-value-modal"},ee&&e.subject&&Object(r.createElement)("span",null,e.subject),Object(r.createElement)(c.Button,{isSecondary:!0,className:"bwf-a-no-underline",style:{height:"auto",padding:"10px 20px"},onClick:function(){Y(!0),[2,3].includes(parseInt(ee))?F(!0):F(!1),V(e)}},Object(n.__)("View details","wp-marketing-automations-crm"))))})),U&&Object(r.createElement)(c.Modal,{title:"Details",onRequestClose:function(){return Y(!1)},className:"bwf-message-preview-modal bwf-admin-modal bwf-admin-modal-xl"},(te=J,ae="",re=!0,3==ee&&te.hasOwnProperty("whatsAppImage")&&te.whatsAppImage&&te.hasOwnProperty("whatsAppImageSetting")&&te.whatsAppImageSetting.hasOwnProperty("position")&&!Object(p.isEmpty)(te.whatsAppImageSetting.position)&&te.whatsAppImageSetting.hasOwnProperty("imageURL")&&!Object(p.isEmpty)(te.whatsAppImageSetting.imageURL)&&(ae="before"===te.whatsAppImageSetting.position?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("img",{src:te.whatsAppImageSetting.imageURL,width:50,height:50}),Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:te.body}})):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:te.body}}),Object(r.createElement)("img",{src:te.whatsAppImageSetting.imageURL,width:50,height:50})),re=!1),re&&(ae=Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:"editor"===te.type?te.editor.body:te.body}})),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-message-wrap"},Object(r.createElement)("div",{className:"bwf-section"},1==ee&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("Subject","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_align_center"},te.subject)),1==ee&&te.hasOwnProperty("preheader")&&!Object(p.isEmpty)(te.preheader)&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("Mail Pre-header","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_align_center"},te.preheader)),1==ee&&te.hasOwnProperty("type")&&!Object(p.isEmpty)(te.type)&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("Mail Type","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_align_center"},G[te.type])),te.hasOwnProperty("utm")&&!Object(p.isEmpty)(te.utm)&&function(e){var t=[];return t.push(Object(n.__)("Source","wp-marketing-automations-crm")+": "+e.source),t.push(Object(n.__)("Medium","wp-marketing-automations-crm")+": "+e.medium),e.hasOwnProperty("name")&&!Object(p.isEmpty)(e.name)&&t.push(Object(n.__)("Name","wp-marketing-automations-crm")+": "+e.name),e.hasOwnProperty("content")&&!Object(p.isEmpty)(e.content)&&t.push(Object(n.__)("Content","wp-marketing-automations-crm")+": "+e.content),e.hasOwnProperty("term")&&!Object(p.isEmpty)(e.term)&&t.push(Object(n.__)("Term","wp-marketing-automations-crm")+": "+e.term),Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("UTM Details","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_align_center"},Object(r.createElement)("div",{className:"bwf-p"},t.join(" | "))))}(te.utm),L&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-report-row-value"},ae)),Object(r.createElement)("div",{className:"bwf-p-15 bwf-t-center"},Object(r.createElement)("a",{className:"bwf-model-link",onClick:function(){return F(!L)}},L?Object(n.__)("Less Details","wp-marketing-automations-crm"):Object(n.__)("More Details","wp-marketing-automations-crm")))))))))))),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-p-gap bwf-border"},Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Schedule","wp-marketing-automations-crm")),Object(r.createElement)(c.CardBody,{className:"bwf-crm-overview-schedule-section"},Object(r.createElement)("div",{className:"bwf-campaign-review-broadcast-wrap",onClick:function(){S(!1)}},Object(r.createElement)(c.ButtonGroup,{className:"bwf-crm-campaign-schedule-btn-grp bwf-alter-button"},ne.map((function(e){var t=e.value===P?{isPrimary:!0}:{isSecondary:!0};return Object(r.createElement)(c.Button,h({onClick:function(){I(e.value),M(w()())}},t,{className:e.className}),1==e.value?Object(r.createElement)(_.a,{icon:"broadcasts",color:e.value===P?"#fff":"#000"}):Object(r.createElement)(_.a,{icon:"timer",color:e.value===P?"#fff":"#000"}),e.label)}))),2==P&&Object(r.createElement)("div",{className:"bwf-crm-campaign-review-date-wrap"},Object(r.createElement)("div",null,Object(r.createElement)("span",{className:"bwf-mr-5"},Object(r.createElement)(_.a,{icon:"calender"})),Object(n.__)("Pick Date and Time","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf-crm-campaign-review-schedule-text-box",id:"bwf-crm-campaign-review-schedule-text-box",onClick:function(e){e.stopPropagation(),S(!k)}},w()(T).format("MMMM Do YYYY, h:mm a")),k&&Object(r.createElement)("div",{className:"bwf-crm-campaign-schedule-popover",onClick:function(e){return e.stopPropagation()}},Object(r.createElement)(c.DateTimePicker,{currentDate:T,isInvalidDate:function(e){return w()(e).isBefore(new Date,"day")},onChange:function(e,t){new Date<new Date(e)?M(e):z({message:Object(n.__)("Select a valid date","wp-marketing-automations-crm"),type:0})},is12Hour:!0})))))))),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-crm-campaign-navigation"},Object(r.createElement)(c.Button,{isSecondary:!0,className:"bwf-crm-navigation-previous bwf-big-button",onClick:function(){K("step",3)}},Object(n.__)("Previous","wp-marketing-automations-crm")),Object(r.createElement)(c.Button,{className:"bwf-crm-navigation-next bwf-big-button",isPrimary:!0,onClick:function(){me()}},Object(n.__)("Schedule","wp-marketing-automations-crm")))),D.loading&&Object(r.createElement)(c.Modal,{title:ce>0?Object(n.__)("Ready to Send ?","wp-marketing-automations-crm"):"",onRequestClose:function(){return s(!1)},className:"bwf-campaign-review-broadcast-model bwf-admin-modal bwf-admin-modal-medium bwf-admin-modal-no-header",shouldCloseOnClickOutside:!1},D.success?Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)(O.a,null),Object(r.createElement)("div",{className:"bwf-h1"},D.message)):D.error?Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)(j.a,null),Object(r.createElement)("div",{className:"bwf-h1"},D.message)):Object(r.createElement)(g.a,null)),Object(r.createElement)(v.a,{message:$.message,type:$.type,removeMessage:function(){return z({message:"",type:1})}})))}}}]);