(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{117:function(e,t,n){"use strict";var r=n(0),a=n(8),o=n.n(a);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var a=d(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(c,e);var t,n,a,o=s(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this,e)).scrollTo=t.scrollTo.bind(m(t)),t}return t=c,(n=[{key:"componentDidMount",value:function(){setTimeout(this.scrollTo,250)}},{key:"scrollTo",value:function(){var e=this.props.offset;this.ref.current?window.scrollTo(0,parseInt(e,10)):setTimeout(this.scrollTo,250)}},{key:"render",value:function(){var e=this.props.children;return this.ref=Object(r.createRef)(),Object(r.createElement)("div",{ref:this.ref},e)}}])&&i(t.prototype,n),a&&i(t,a),c}(r.Component);f.propTypes={offset:o.a.string},f.defaultProps={offset:"0"},t.a=f},120:function(e,t,n){"use strict";var r=n(0);n(135);t.a=function(e){return Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf_align_center"},Object(r.createElement)("div",{className:"bwf-w-100",dangerouslySetInnerHTML:{__html:bwfcrm_contacts_data.icons.success}})))}},121:function(e,t,n){"use strict";var r=n(0);n(136);t.a=function(e){return Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf_align_center"},Object(r.createElement)("div",{className:"bwf-w-100",dangerouslySetInnerHTML:{__html:bwfcrm_contacts_data.icons.error}})))}},135:function(e,t,n){},136:function(e,t,n){},541:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(150),a={"am-AM":/^(\+?374|0)((10|[9|7][0-9])\d{6}$|[2-4]\d{7}$)/,"ar-AE":/^((\+?971)|0)?5[024568]\d{7}$/,"ar-BH":/^(\+?973)?(3|6)\d{7}$/,"ar-DZ":/^(\+?213|0)(5|6|7)\d{8}$/,"ar-LB":/^(\+?961)?((3|81)\d{6}|7\d{7})$/,"ar-EG":/^((\+?20)|0)?1[0125]\d{8}$/,"ar-IQ":/^(\+?964|0)?7[0-9]\d{8}$/,"ar-JO":/^(\+?962|0)?7[789]\d{7}$/,"ar-KW":/^(\+?965)[569]\d{7}$/,"ar-LY":/^((\+?218)|0)?(9[1-6]\d{7}|[1-8]\d{7,9})$/,"ar-MA":/^(?:(?:\+|00)212|0)[5-7]\d{8}$/,"ar-SA":/^(!?(\+?966)|0)?5\d{8}$/,"ar-SY":/^(!?(\+?963)|0)?9\d{8}$/,"ar-TN":/^(\+?216)?[2459]\d{7}$/,"az-AZ":/^(\+994|0)(5[015]|7[07]|99)\d{7}$/,"bs-BA":/^((((\+|00)3876)|06))((([0-3]|[5-6])\d{6})|(4\d{7}))$/,"be-BY":/^(\+?375)?(24|25|29|33|44)\d{7}$/,"bg-BG":/^(\+?359|0)?8[789]\d{7}$/,"bn-BD":/^(\+?880|0)1[13456789][0-9]{8}$/,"ca-AD":/^(\+376)?[346]\d{5}$/,"cs-CZ":/^(\+?420)? ?[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$/,"da-DK":/^(\+?45)?\s?\d{2}\s?\d{2}\s?\d{2}\s?\d{2}$/,"de-DE":/^(\+49)?0?[1|3]([0|5][0-45-9]\d|6([23]|0\d?)|7([0-57-9]|6\d))\d{7}$/,"de-AT":/^(\+43|0)\d{1,4}\d{3,12}$/,"de-CH":/^(\+41|0)(7[5-9])\d{1,7}$/,"de-LU":/^(\+352)?((6\d1)\d{6})$/,"el-GR":/^(\+?30|0)?(69\d{8})$/,"en-AU":/^(\+?61|0)4\d{8}$/,"en-GB":/^(\+?44|0)7\d{9}$/,"en-GG":/^(\+?44|0)1481\d{6}$/,"en-GH":/^(\+233|0)(20|50|24|54|27|57|26|56|23|28)\d{7}$/,"en-HK":/^(\+?852[-\s]?)?[456789]\d{3}[-\s]?\d{4}$/,"en-MO":/^(\+?853[-\s]?)?[6]\d{3}[-\s]?\d{4}$/,"en-IE":/^(\+?353|0)8[356789]\d{7}$/,"en-IN":/^(\+?91|0)?[6789]\d{9}$/,"en-KE":/^(\+?254|0)(7|1)\d{8}$/,"en-MT":/^(\+?356|0)?(99|79|77|21|27|22|25)[0-9]{6}$/,"en-MU":/^(\+?230|0)?\d{8}$/,"en-NG":/^(\+?234|0)?[789]\d{9}$/,"en-NZ":/^(\+?64|0)[28]\d{7,9}$/,"en-PK":/^((\+92)|(0092))-{0,1}\d{3}-{0,1}\d{7}$|^\d{11}$|^\d{4}-\d{7}$/,"en-PH":/^(09|\+639)\d{9}$/,"en-RW":/^(\+?250|0)?[7]\d{8}$/,"en-SG":/^(\+65)?[689]\d{7}$/,"en-SL":/^(?:0|94|\+94)?(7(0|1|2|5|6|7|8)( |-)?\d)\d{6}$/,"en-TZ":/^(\+?255|0)?[67]\d{8}$/,"en-UG":/^(\+?256|0)?[7]\d{8}$/,"en-US":/^((\+1|1)?( |-)?)?(\([2-9][0-9]{2}\)|[2-9][0-9]{2})( |-)?([2-9][0-9]{2}( |-)?[0-9]{4})$/,"en-ZA":/^(\+?27|0)\d{9}$/,"en-ZM":/^(\+?26)?09[567]\d{7}$/,"en-ZW":/^(\+263)[0-9]{9}$/,"es-AR":/^\+?549(11|[2368]\d)\d{8}$/,"es-BO":/^(\+?591)?(6|7)\d{7}$/,"es-CO":/^(\+?57)?([1-8]{1}|3[0-9]{2})?[2-9]{1}\d{6}$/,"es-CL":/^(\+?56|0)[2-9]\d{1}\d{7}$/,"es-CR":/^(\+506)?[2-8]\d{7}$/,"es-DO":/^(\+?1)?8[024]9\d{7}$/,"es-HN":/^(\+?504)?[9|8]\d{7}$/,"es-EC":/^(\+?593|0)([2-7]|9[2-9])\d{7}$/,"es-ES":/^(\+?34)?[6|7]\d{8}$/,"es-PE":/^(\+?51)?9\d{8}$/,"es-MX":/^(\+?52)?(1|01)?\d{10,11}$/,"es-PA":/^(\+?507)\d{7,8}$/,"es-PY":/^(\+?595|0)9[9876]\d{7}$/,"es-UY":/^(\+598|0)9[1-9][\d]{6}$/,"et-EE":/^(\+?372)?\s?(5|8[1-4])\s?([0-9]\s?){6,7}$/,"fa-IR":/^(\+?98[\-\s]?|0)9[0-39]\d[\-\s]?\d{3}[\-\s]?\d{4}$/,"fi-FI":/^(\+?358|0)\s?(4(0|1|2|4|5|6)?|50)\s?(\d\s?){4,8}\d$/,"fj-FJ":/^(\+?679)?\s?\d{3}\s?\d{4}$/,"fo-FO":/^(\+?298)?\s?\d{2}\s?\d{2}\s?\d{2}$/,"fr-FR":/^(\+?33|0)[67]\d{8}$/,"fr-GF":/^(\+?594|0|00594)[67]\d{8}$/,"fr-GP":/^(\+?590|0|00590)[67]\d{8}$/,"fr-MQ":/^(\+?596|0|00596)[67]\d{8}$/,"fr-RE":/^(\+?262|0|00262)[67]\d{8}$/,"he-IL":/^(\+972|0)([23489]|5[012345689]|77)[1-9]\d{6}$/,"hu-HU":/^(\+?36)(20|30|70)\d{7}$/,"id-ID":/^(\+?62|0)8(1[123456789]|2[1238]|3[1238]|5[12356789]|7[78]|9[56789]|8[123456789])([\s?|\d]{5,11})$/,"it-IT":/^(\+?39)?\s?3\d{2} ?\d{6,7}$/,"it-SM":/^((\+378)|(0549)|(\+390549)|(\+3780549))?6\d{5,9}$/,"ja-JP":/^(\+81[ \-]?(\(0\))?|0)[6789]0[ \-]?\d{4}[ \-]?\d{4}$/,"ka-GE":/^(\+?995)?(5|79)\d{7}$/,"kk-KZ":/^(\+?7|8)?7\d{9}$/,"kl-GL":/^(\+?299)?\s?\d{2}\s?\d{2}\s?\d{2}$/,"ko-KR":/^((\+?82)[ \-]?)?0?1([0|1|6|7|8|9]{1})[ \-]?\d{3,4}[ \-]?\d{4}$/,"lt-LT":/^(\+370|8)\d{8}$/,"ms-MY":/^(\+?6?01){1}(([0145]{1}(\-|\s)?\d{7,8})|([236789]{1}(\s|\-)?\d{7}))$/,"nb-NO":/^(\+?47)?[49]\d{7}$/,"ne-NP":/^(\+?977)?9[78]\d{8}$/,"nl-BE":/^(\+?32|0)4?\d{8}$/,"nl-NL":/^(((\+|00)?31\(0\))|((\+|00)?31)|0)6{1}\d{8}$/,"nn-NO":/^(\+?47)?[49]\d{7}$/,"pl-PL":/^(\+?48)? ?[5-8]\d ?\d{3} ?\d{2} ?\d{2}$/,"pt-BR":/^((\+?55\ ?[1-9]{2}\ ?)|(\+?55\ ?\([1-9]{2}\)\ ?)|(0[1-9]{2}\ ?)|(\([1-9]{2}\)\ ?)|([1-9]{2}\ ?))((\d{4}\-?\d{4})|(9[2-9]{1}\d{3}\-?\d{4}))$/,"pt-PT":/^(\+?351)?9[1236]\d{7}$/,"ro-RO":/^(\+?4?0)\s?7\d{2}(\/|\s|\.|\-)?\d{3}(\s|\.|\-)?\d{3}$/,"ru-RU":/^(\+?7|8)?9\d{9}$/,"sl-SI":/^(\+386\s?|0)(\d{1}\s?\d{3}\s?\d{2}\s?\d{2}|\d{2}\s?\d{3}\s?\d{3})$/,"sk-SK":/^(\+?421)? ?[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$/,"sq-AL":/^(\+355|0)6[789]\d{6}$/,"sr-RS":/^(\+3816|06)[- \d]{5,9}$/,"sv-SE":/^(\+?46|0)[\s\-]?7[\s\-]?[02369]([\s\-]?\d){7}$/,"th-TH":/^(\+66|66|0)\d{9}$/,"tr-TR":/^(\+?90|0)?5\d{9}$/,"uk-UA":/^(\+?38|8)?0\d{9}$/,"uz-UZ":/^(\+?998)?(6[125-79]|7[1-69]|88|9\d)\d{7}$/,"vi-VN":/^(\+?84|0)((3([2-9]))|(5([2689]))|(7([0|6-9]))|(8([1-6|89]))|(9([0-9])))([0-9]{7})$/,"zh-CN":/^((\+|00)86)?1([3568][0-9]|4[579]|6[67]|7[01235678]|9[012356789])[0-9]{8}$/,"zh-TW":/^(\+?886\-?|0)?9\d{8}$/};function o(e,t,n){if(Object(r.a)(e),n&&n.strictMode&&!e.startsWith("+"))return!1;if(Array.isArray(t))return t.some((function(t){if(a.hasOwnProperty(t)&&a[t].test(e))return!0;return!1}));if(t in a)return a[t].test(e);if(!t||"any"===t){for(var o in a){if(a.hasOwnProperty(o))if(a[o].test(e))return!0}return!1}throw new Error("Invalid locale '".concat(t,"'"))}a["en-CA"]=a["en-US"],a["fr-CA"]=a["en-CA"],a["fr-BE"]=a["nl-BE"],a["zh-HK"]=a["en-HK"],a["zh-MO"]=a["en-MO"],a["ga-IE"]=a["en-IE"];Object.keys(a)},721:function(e,t,n){},722:function(e,t,n){},733:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(9),o=n(4),c=n(332),i=n(176),l=n(460),s=n(16),u=n.n(s),m=n(20),d=n(7),f=n(17),b=n(5),p=n(224),g=n(486),O=n(112),y=n(46),j=n(56);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var E=function(e){if(!e||!e.editor||!e.editor.design)return!1;var t=JSON.parse(e.editor.design);return!!t&&!!t.body&&Array.isArray(t.body.rows)&&t.body.rows.length>0},S=function(){var e=Object(y.a)(j.a.campaignContent),t=e.getStateProp,n=h(e,["getStateProp"]),r=i.a.getCampaignData(),a=parseInt(r.type);return v(v({},n),{},{getEmailContent:function(){var e=parseInt(t("currentEmail")),n=t("data");return n&&e in n?n[e]:{}},getCurrentEmail:function(){return parseInt(t("currentEmail"))},getEmails:function(){return t("emails")},getAllEmailContent:function(){return t("data")},getShowValidationFlag:function(){return t("showValidation")},emailsValidToSubmit:function(){var e=t("data");return!!t("emails").map((function(t){var n=e[t];if(!n)return!1;var r=!!n.utmEnabled,o=n.utm?n.utm:{},c={subject:1!==a||n.subject&&n.subject.length>0,content:"editor"!==n.type?n.body&&n.body.length>0:E(n),type:1!==a||n.type&&n.type.length>0,utmSource:!r||o.source&&o.source.length>0,utmMedium:!r||o.medium&&o.medium.length>0};return!!Object.keys(c).map((function(e){return c[e]})).reduce((function(e,t){return e&&t}),!0)})).reduce((function(e,t){return e&&t}),!0)&&e},getValidEmails:function(){var e=t("data"),n=t("emails"),r={};return n.map((function(t){var n=e[t];if(n){var o=!!n.utmEnabled,c=n.utm?n.utm:{},i={subject:1!==a||n.subject&&n.subject.length>0,content:"editor"!==n.type?n.body&&n.body.length>0:E(n),type:1!==a||n.type&&n.type.length>0,utmSource:!o||c.source&&c.source.length>0,utmMedium:!o||c.medium&&c.medium.length>0};r[t]=!!Object.keys(i).map((function(e){return i[e]})).reduce((function(e,t){return e&&t}),!0)}})),r},getEmailsToSubmit:function(){var e=t("data");return t("emails").map((function(t){var n=e[t];return n||!1})).filter(Boolean)},getCurrentEmailIndex:function(){var e=parseInt(t("currentEmail")),n=t("emails");return Array.isArray(n)&&n.includes(e)?n.indexOf(e):1},validateCurrentEmail:function(){var e=t("data"),n=parseInt(t("currentEmail"));if(!e||!e[n])return!1;var r=e[n];if(r){var o=!!r.utmEnabled,c=r.utm?r.utm:{};return{subject:1!==a||r.subject&&r.subject.length>0,content:"editor"!==r.type?r.body&&r.body.length>0:E(r),type:1!==a||r.type&&r.type.length>0,utmSource:!o||c.source&&c.source.length>0,utmMedium:!o||c.medium&&c.medium.length>0}}},getSmartSendSettings:function(){return t("smartSend")},getSaveContentStatus:function(){return t("saveContentStatus")},getSendTestEmailStatus:function(){return t("sendTestEmailStatus")},getUploadImageStatus:function(){return t("uploadImageStatus")},getUploadImageURL:function(){return t("uploadImageURL")}})};function k(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var N=function(){var e=Object(O.a)(j.a.campaignContent),t=e.fetch,n=e.setStateProp,r=P(e,["fetch","setStateProp"]),a=S(),c=a.getAllEmailContent,l=a.getCurrentEmail,s=a.getEmails,u=a.getSmartSendSettings,m=a.getCurrentEmailIndex,f=a.getEmailsToSubmit,p=a.getEmailContent,g=c(),y=l(),w=m(),v=s(),_=u(),h=p(),E=f(),C=i.a.getCampaignId(),$=i.a.getCampaignData().type,N=function(e){return"type"in e?e:I(I({},e),{},{type:"rich"})};return I(I({},r),{},{setEmailContentByKey:function(e,t){var r=N(y in g?I(I({},g[y]),{},T({},e,t)):T({},e,t)),a=I(I({},g),{},T({},y,r));n("data",a)},setEmailUtmByKey:function(e,t){var r=N(y in g?I({},g[y]):{}),a="utm"in r?I(I({},r.utm),{},T({},e,t)):T({},e,t),o=I(I({},g),{},T({},y,I(I({},r),{},{utm:I(I({},a),{},T({},e,t))})));n("data",o)},setMultipleUtm:function(e){if(e){var t=N(y in g?I({},g[y]):{}),r=I(I({},g),{},T({},y,I(I({},t),{},{utm:I(I({},t.utm),e)})));n("data",r)}},setCurrentEmail:function(e){v.includes(e)&&n("currentEmail",e)},addEmail:function(){if(Array.isArray(v)&&v.length<3){var e=Math.max.apply(Math,k(v))+1;n("emails",[].concat(k(v),[e])),n("currentEmail",e),n("showValidation",!1),n("data",I(I({},g),{},T({},e,v[0]in g?g[v[0]]:{})))}},showValidation:function(e){return n("showValidation",e)},deleteEmail:function(e){if(v.length>1){var t=v.filter((function(t){return t!==e}));n("emails",t),n("currentEmail",t[t.length-1])}},initContent:function(e,t){if(!Array.isArray(e)||0===Object(b.size)(e))return n("data",{1:{body:Object(o.__)("Hi","wp-marketing-automations-crm")+" {{contact_first_name}}"}}),n("emails",[1]),void n("currentEmail",1);var r={};for(var a in e){var c=parseInt(a)+1;r[c]=g[c]?I(I({},N(g[c])),e[a]):e[a]}n("data",r),n("emails",Object.keys(r).map((function(e){return parseInt(e)}))),t&&0!==Object.keys(t).length&&n("smartSend",t)},fetchCurrentMailEditorContent:function(){t("GET",Object(d.f)("/broadcast/".concat(C,"/content/").concat(w)),{},{email:y})},sendTestEmail:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",c="",i="",l="rich",s="";if(h){var u=h.body?h.body:"",m=h.editor?h.editor:{},f=m.body?m.body:"";c="editor"===(l=h.type?h.type:l)?f:u,i=h.subject?h.subject:"",s=h.preheader?h.preheader:""}var p=a||c,g=r||i,O=o||l,y="",j={};1==$?(y=Object(d.f)("/send-test-email"),j={email:e,content:{subject:g,body:p,type:O,preheader:s,mail_data:n}}):2==$?(y=Object(d.f)("/send-test-sms"),j={phone:e,sms_body:p}):3==$&&(y=Object(d.f)("/send-test-whatsapp-message"),j={phone:e,sms_body:h}),Object(b.isEmpty)(j)||Object(b.isEmpty)(y)||t("POST",y,j,{sendTestEmail:!0})},setSmartSendByKey:function(e,t){return n("smartSend",I(I({},_),{},T({},e,t)))},saveBroadcastContent:function(e){n("saveContentStatus",1),t("POST",Object(d.f)("/broadcast/".concat(C,"/save-content")),{content:Array.isArray(e)&&e.length>0?e:E},{saveBroadcastContent:!0})},uploadImage:function(e){if(e){n("uploadImageStatus",1);var r=new FormData;r.append("image",e),t("POST",Object(d.f)("/upload-image"),r,{uploadImage:!0,isFormData:!0})}},resetSaveContentStatus:function(){return n("saveContentStatus",null)},resetSendTestEmailStatus:function(){return n("sendTestEmailStatus",null)},resetUploadImageStatus:function(){n("uploadImageStatus",null),n("uploadImageStatusURL","")},overrideCurrentContent:function(e){var t=N(y in g?I({},g[y]):{}),r=I(I({},g),{},T({},y,I(I({},t),e)));n("data",r)}})},A=n(109);function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},B=function(e){var t=N().sendTestEmail,n=(0,S().getSendTestEmailStatus)(),a=x(Object(r.useState)("http://app.getautonami.com"),2),c=a[0],i=a[1],l=Object(r.useRef)();Object(r.useEffect)((function(){l.current=e}),[e]);var s=function(e){if(-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"send_test_email"===e.data.action&&e.data.token===R.editor_nonce&&e.data.data){var n=e.data.data,r=n.email,a=n.body,c=n.subject;r&&a&&(i(e.origin),t(r,l,c||Object(o.__)("This is a fake subject line, enter subject to fix it","wp-marketing-automations-crm"),a))}};return Object(r.useEffect)((function(){return window.addEventListener("message",s),function(){return window.removeEventListener("message",s)}}),[]),Object(r.useEffect)((function(){if(n&&1!==n){var e=2===n,t=document.getElementById("bwf_email_editor_frame");t&&t.contentWindow.postMessage({token:R.editor_nonce,action:"send_test_email",data:{isSent:e}},c)}}),[n]),!0};function L(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||D(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||D(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){if(e){if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var V=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},G=function(e){var t=N().saveBroadcastContent,n=S(),a=n.getSaveContentStatus,o=n.getEmailsToSubmit,c=n.getCurrentEmailIndex,i=a(),l=o(),s=c(),u=Object(r.useRef)(l),m=Object(r.useRef)(s);Object(r.useEffect)((function(){u.current=l,m.current=s}),[l,s]);var d=U(Object(r.useState)("http://app.getautonami.com"),2),f=d[0],b=d[1],p=function(e){if(-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"save_design"===e.data.action&&e.data.token===V.editor_nonce&&e.data.data){var n=e.data.data,r=n.body,a=n.design;if(r&&a){b(e.origin);var o=L(u.current);o[m.current].editor={body:r,design:a},t(o)}}};return Object(r.useEffect)((function(){return window.addEventListener("message",p),function(){return window.removeEventListener("message",p)}}),[]),Object(r.useEffect)((function(){if(i&&1!==i&&e){var t=2===i,n=document.getElementById("bwf_email_editor_frame");n&&n.contentWindow.postMessage({token:V.editor_nonce,action:"save_design",data:{isSaved:t}},f)}}),[i]),!0};function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var W=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},q=function(){var e=H(Object(r.useState)("http://app.getautonami.com"),2),t=e[0],n=e[1],a=function(e){-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"wp_image_upload"===e.data.action&&e.data.token===W.editor_nonce&&e.data.data&&(n(e.origin),u())},c=Object(r.useRef)(),i=H(Object(r.useState)(""),2),l=i[0],s=i[1],u=function(){if(!wp||!wp.media)return"";c.current||(c.current=wp.media({title:Object(o.__)("Select or Upload Media","wp-marketing-automations-crm"),button:{text:"Select Image"},multiple:!1}),c.current.on("select",(function(){var e=c.current.state().get("selection").first().toJSON();s(e.url)}))),c.current.open()};return Object(r.useEffect)((function(){return window.addEventListener("message",a),function(){return window.removeEventListener("message",a)}}),[]),Object(r.useEffect)((function(){if(l){var e=document.getElementById("bwf_email_editor_frame");e&&e.contentWindow.postMessage({token:W.editor_nonce,action:"wp_image_upload",data:{isUploaded:!0,imageURL:l}},t)}}),[l]),!0},Z=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},z=function(e){var t=(0,S().getEmailContent)(),n=Object(r.useRef)(),a=Object(r.useRef)();Object(r.useEffect)((function(){n.current=t,a.current=function(e){var t={};for(var n in e){var r=e[n];if(r){var a={};for(var o in r)a[o]={name:r[o],value:"{{".concat(o,"}}")};var c="";switch(n){case"contact":c="Contact";break;case"contact_fields":c="Fields";break;case"general":c="General"}t[n]={name:c,mergeTags:a}}}return t}(e)}),[t,e]);var o=function(e){if(-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"get_design"===e.data.action&&e.data.token===Z.editor_nonce){var t=n.current&&n.current.editor&&n.current.editor.design?n.current.editor.design:"",r=document.getElementById("bwf_email_editor_frame");r&&r.contentWindow.postMessage({token:Z.editor_nonce,action:"get_design",data:{gotDesign:!0,json:t,subject:n.current&&n.current.subject?n.current.subject:"",mergeTags:a.current}},e.origin)}};return Object(r.useEffect)((function(){return window.addEventListener("message",o),function(){return window.removeEventListener("message",o)}}),[]),!0},J=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},Y=function(e){var t=function(t){-1!==t.origin.indexOf("app.getautonami.com")&&t.data&&t.data.action&&"open_merge_tags"===t.data.action&&t.data.token===J.editor_nonce&&t.data.data&&e&&e()};return Object(r.useEffect)((function(){return window.addEventListener("message",t),function(){return window.removeEventListener("message",t)}}),[]),!0},Q=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},X=function(e){var t=function(t){-1!==t.origin.indexOf("app.getautonami.com")&&t.data&&t.data.action&&"close_editor"===t.data.action&&t.data.token===Q.editor_nonce&&t.data.data&&e&&e()};return Object(r.useEffect)((function(){return window.addEventListener("message",t),function(){return window.removeEventListener("message",t)}}),[]),!0};function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return te(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ne=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},re=function(){return Object(r.createElement)("div",{className:"bwf-c-save-content-loading"},Object(r.createElement)(A.a,null),Object(r.createElement)("h3",null,Object(o.__)("Loading Drag and Drop Builder","wp-marketing-automations-crm")))},ae=function(e){var t=e.iframeRef,n=e.editorSrc;return Object(r.createElement)("iframe",{ref:t,title:Object(o.__)("Email Editor","wp-marketing-automations"),src:n,id:"bwf_email_editor_frame",style:{width:"100%",height:"100%"}})},oe=function(e){var t=ee(Object(r.useState)(!1),2),n=t[0],c=t[1],i=e.broadcastId,l=e.contentNumber,s=e.openMergeTags,u=e.mailData,m=e.mergeTags,d=ne.license,f=ne.editor_nonce,b=ne.url,p=N(),g=p.fetchCurrentMailEditorContent,O=p.saveBroadcastContent,y=p.resetSaveContentStatus,j=S().getSaveContentStatus(),w=ee(Object(r.useState)(!1),2),v=w[0],_=w[1];Object(r.useEffect)((function(){v||2!==j&&3!==j||(_(!0),y())}),[j]);var h=Object(r.useCallback)((function(){c(!1),g()}));z(m||[]),B(u),G(v),q(),Y(s),X(h);var E="//app.getautonami.com/get/".concat(d,"/").concat(f,"/").concat(b,"/crm.broadcast.").concat(i,".content.").concat(l),k=Object(r.useRef)();return Object(r.useEffect)((function(){n?(O(),document.body.classList.add("bwf-c-modal-open")):(_(!1),document.body.classList.remove("bwf-c-modal-open"))}),[n]),Object(r.createElement)(r.Fragment,null,n&&Object(r.createElement)("div",{className:"bwf-c-editor-modal-wrapper"},Object(r.createElement)("div",{className:"bwf-c-editor-modal bwf-c-editor-modal-full-width"},!v&&Object(r.createElement)(re,null),!!v&&Object(r.createElement)(ae,{iframeRef:k,editorSrc:E}))),Object(r.createElement)("div",{className:"bwf-c-editor-button-wrapper"},Object(r.createElement)(a.Button,{isPrimary:!0,onClick:function(){return c(!0)}},Object(o.__)("Launch Editor","wp-marketing-automations-crm"))))},ce=n(517),ie=n(541);function le(e,t,n,r,a,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}function se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ue(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var me=function(e){var t=e.setPreview,n=e.content,c=e.type,i=se(Object(r.useState)(""),2),l=i[0],s=i[1],m=se(Object(r.useState)(!0),2),f=m[0],b=m[1];Object(r.useEffect)((function(){p()}),[]);var p=function(){var e,t=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=4;break}return s(""),b(!1),e.abrupt("return");case 4:return e.prev=4,e.next=7,u()({path:Object(d.f)("/broadcast/email-preview"),method:"POST",data:{content:n,type:c}}).then((function(e){s(e.result.body.replace(/\\/g,"")),b(!1)}));case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:case"end":return e.stop()}}),e,null,[[4,9]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){le(o,r,a,c,i,"next",e)}function i(e){le(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(r.createElement)(a.Modal,{title:Object(o.__)("Preview","wp-marketing-automations-crm"),onRequestClose:function(){return t(!1)},className:"bwf-admin-modal bwf-admin-modal-xxl"},f?Object(r.createElement)(A.a,null):Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:l}}))},de=(n(13),n(518)),fe=n(15),be=n.n(fe);n(721);function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_e(e);if(t){var a=_e(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return we(this,n)}}function we(e,t){return!t||"object"!==pe(t)&&"function"!=typeof t?ve(e):t}function ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _e(e){return(_e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var he=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(l,e);var t,n,c,i=je(l);function l(){var e;return ge(this,l),(e=i.apply(this,arguments)).state={frame:!1},e.openModal=e.openModal.bind(ve(e)),e.handleImageSelect=e.handleImageSelect.bind(ve(e)),e.removeImage=e.removeImage.bind(ve(e)),e}return t=l,(n=[{key:"openModal",value:function(){if(this.state.frame)this.state.frame.open();else{var e=wp.media({title:Object(o.__)("Select or upload image","wp-marketing-automations-crm"),button:{text:Object(o.__)("Select","wp-marketing-automations-crm")},library:{type:"image"},multiple:!1});e.on("select",this.handleImageSelect),e.open(),this.setState({frame:e})}}},{key:"handleImageSelect",value:function(){(0,this.props.onChange)(this.state.frame.state().get("selection").first().toJSON())}},{key:"removeImage",value:function(){(0,this.props.onChange)(null)}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.image;return Object(r.createElement)(r.Fragment,null,!!n&&Object(r.createElement)("div",{className:be()("bwfcrm-image-upload","has-image",t)},Object(r.createElement)("div",{className:"bwfcrm-image-upload__image-preview"},Object(r.createElement)("img",{src:n.url,alt:""})),Object(r.createElement)(a.Button,{isSecondary:!0,className:"bwfcrm-image-upload__remove-image",onClick:this.removeImage},Object(o.__)("Remove image","wp-marketing-automations-crm"))),!n&&Object(r.createElement)("div",{className:be()("bwfcrm-image-upload","no-image",t)},Object(r.createElement)(a.Button,{className:"bwfcrm-image-upload__addwp-marketing-automations-crm-image",onClick:this.openModal,isSecondary:!0},Object(r.createElement)(a.Icon,{icon:"upload"}),Object(o.__)("Add an image","wp-marketing-automations-crm"))))}}])&&Oe(t.prototype,n),c&&Oe(t,c),l}(r.Component),Ee=function(e){var t=e.enable,n=e.position,c=e.imageURL,i=e.setData;return Object(r.createElement)("div",{className:"bwf-c-campaign-email"},Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.ToggleControl,{label:Object(o.__)("Enable Image Sending","wp-marketing-automations-crm"),className:"bwf-tooglecontrol-advance",checked:t,onChange:function(e){return i("enable",e)}}),t&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.RadioControl,{className:"bwfcrm-inline-option",selected:n,label:Object(o.__)("Select Image Position","wp-marketing-automations-crm"),options:[{value:"after",label:Object(o.__)("After","wp-marketing-automations-crm")},{value:"before",label:Object(o.__)("Before","wp-marketing-automations-crm")}],onChange:function(e){return i("position",e)}}),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(he,{image:c?{url:c}:"",onChange:function(e){!Object(b.isNull)(e)&&e.hasOwnProperty("url")?i("imageURL",e.url):i("imageURL","")}})))},Se=n(521),ke=n(124);function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ne=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},Ae=function(){var e=Te(Object(r.useState)(!1),2),t=e[0],n=e[1],a=Te(Object(r.useState)(!1),2),o=a[0],c=a[1],i=Object(ke.a)(Object(d.F)()).formatAmount,l=Object(r.useCallback)((function(e){var t=document.getElementById("bwf_email_editor_frame");t&&t.contentWindow.postMessage({token:Ne.editor_nonce,action:"select_product_for_tool",data:{product:$e($e({},e),{},{formattedPrice:i(e.price)})}},o),n(!1)}),[o]),s=Object(r.useCallback)((function(e){-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"select_product_for_tool"===e.data.action&&e.data.token===Ne.editor_nonce&&(c(e.origin),n(!0))}),[n]);return Object(r.useEffect)((function(){return window.addEventListener("message",s),function(){return window.removeEventListener("message",s)}}),[]),t&&Object(r.createElement)(Se.a,{onRequestClose:function(){return n(!1)},onProductSelected:l})};function xe(){return(xe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Re(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Be=Object(d.G)(),Le=[{label:Object(o.__)("Text","wp-marketing-automations-crm"),value:"rich",templateIcon:"rich-text",className:"bwf-display-flex bwf-campaign-template-type "},Be.includes("wc")&&{label:Object(o.__)("WooCommerce","wp-marketing-automations-crm"),value:"wc",templateIcon:"woocommerce",className:"bwf-display-flex bwf-campaign-template-type "},{label:Object(o.__)("HTML","wp-marketing-automations-crm"),value:"html",templateIcon:"html",className:"bwf-display-flex bwf-campaign-template-type"},{label:Object(o.__)("Drag and Drop","wp-marketing-automations-crm"),value:"editor",templateIcon:"html",className:"bwf-display-flex bwf-campaign-template-type"}].filter(Boolean),Ue=function(e){var t=e.maildata,n=i.a.getCampaignData(),l=parseInt(n.type),s=Object(d.i)(),u=N(),m=u.setEmailContentByKey,f=u.setEmailUtmByKey,O=u.setMultipleUtm,y=u.sendTestEmail,j=u.resetSendTestEmailStatus,w=S(),v=w.getEmailContent()?w.getEmailContent():{},_="utm"in v?v.utm:{},h=Me(Object(r.useState)(!1),2),E=h[0],k=h[1],C=Me(Object(r.useState)(""),2),$=C[0],I=C[1],T="subject"in v?v.subject:"",P="preheader"in v?v.preheader:"",A="type"in v?v.type:"rich",x="utmEnabled"in v&&v.utmEnabled,M=Me(Object(r.useState)({message:"",type:1}),2),R=M[0],B=M[1],L="whatsAppImage"in v&&v.whatsAppImage,U="whatsAppImageSetting"in v?v.whatsAppImageSetting:{},D="position"in U?U.position:"after",F="imageURL"in U?U.imageURL:"",V="source"in _?_.source:"",G="medium"in _?_.medium:"",H="name"in _?_.name:"",K="content"in _?_.content:"",W="term"in _?_.term:"",q=Me(Object(r.useState)(!1),2),Z=q[0],z=q[1],J=w.getShowValidationFlag(),Y=Me(Object(r.useState)(!1),2),Q=Y[0],X=Y[1],ee=Me(Object(r.useState)("content"),2),te=ee[0],ne=ee[1],re=Me(Object(r.useState)([]),2),ae=re[0],le=re[1],se=w.getCurrentEmailIndex(),ue=v&&v.body?v.body:"",fe="editor"in v?v.editor:{},be=fe&&fe.body?fe.body:"",pe="editor"===A?be:ue;Object(r.useEffect)((function(){if(x){var e={};!V&&(e.source=Object(o.__)("Newsletter","wp-marketing-automations-crm")),!G&&(e.medium=s[l].label.toLowerCase()),!H&&(e.name=Object(b.trim)(n.title).toLowerCase().replace(/\s/g,"-")),O(e)}}),[x]);var ge=w.validateCurrentEmail(),Oe={1:Object(o.__)("Place your HTML here","wp-marketing-automations-crm"),2:Object(o.__)("Enter the SMS Body","wp-marketing-automations-crm"),3:Object(o.__)("Place your message here","wp-marketing-automations-crm")},ye={1:Object(o.__)("Send Test Email","wp-marketing-automations-crm"),2:Object(o.__)("Send Test SMS","wp-marketing-automations-crm"),3:Object(o.__)("Send Test Message","wp-marketing-automations-crm")},je={1:Object(o.__)("Send Email","wp-marketing-automations-crm"),2:Object(o.__)("Send SMS","wp-marketing-automations-crm"),3:Object(o.__)("Send Message","wp-marketing-automations-crm")},we=function(){return"editor"==v.type?v.hasOwnProperty("editor")&&v.editor.hasOwnProperty("body")?v.editor.body:"":v.body},ve=w.getSendTestEmailStatus();Object(r.useEffect)((function(){null!==ve&&setTimeout((function(){j(),B({message:"",type:1})}),2e3),2===ve&&B({message:1==l?Object(o.__)("Test email sent","wp-marketing-automations-crm"):Object(o.__)("Test message sent","wp-marketing-automations-crm"),type:1}),3===ve&&B({message:1==l?Object(o.__)("Unable to send mail","wp-marketing-automations-crm"):Object(o.__)("Unable to send message","wp-marketing-automations-crm"),type:1})}),[ve]);var _e=J&&!ge.subject?" bwf-field-error":"",he=J&&!ge.content?" bwf-field-error-textarea":"",Se=J&&!ge.utmSource?" bwf-field-error":"",ke=J&&!ge.utmMedium?" bwf-field-error":"";return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(a.Card,{className:"bwf-c-campaign-body"},1===l&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(a.TextControl,{value:T,onChange:function(e){return m("subject",e)},label:Object(o.__)("Subject","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter subject","wp-marketing-automations-crm"),className:"bwf-field-m0"+_e}),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-campaign-mail-headers-wrap"},Object(r.createElement)(a.TextControl,{value:P,placeholder:Object(o.__)("Enter preview text","wp-marketing-automations-crm"),label:Object(o.__)("Preview Text","wp-marketing-automations-crm"),onChange:function(e){return m("preheader",e)}})),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.Flex,{align:"flex-end"},Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)("div",{className:"bwf-p"},Object(o.__)("Template Type","wp-marketing-automations-crm")),Object(r.createElement)("div",null,Le.map((function(e){var t=e.value===A?{isPrimary:!0}:{};return Object(r.createElement)("div",{className:"bwf-c-big-icon-button bwf-alter-button"},Object(r.createElement)(a.Button,xe({onClick:function(){return m("type",e.value)}},t,{className:e.className}),e.label))})))),"editor"!==A&&Object(r.createElement)(a.FlexItem,null,Object(r.createElement)(a.Button,{isSecondary:!0,className:"bwf-big-button",onClick:function(){ne("content"),X(!0)}},Object(o.__)("Merge Tags","wp-marketing-automations-crm"))))),Object(r.createElement)("div",{className:"bwf_clear_15"}),Object(r.createElement)("div",{className:he},1===l&&("rich"===A||"wc"===A)&&Object(r.createElement)(g.a,{content:pe,keyid:"bwf-campaign-email-editor",setContent:function(e){return m("body",e)}}),("html"===A||2===l||3===l)&&Object(r.createElement)(a.TextareaControl,{value:pe,onChange:function(e){return m("body",e)},placeholder:Oe[l],rows:[2,3].includes(l)?5:30}),"editor"===A&&Object(r.createElement)(oe,{broadcastId:n.id,contentNumber:parseInt(se),openMergeTags:function(){return X(!0)},mailData:t,mergeTags:ae})),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexItem,null,"editor"!==A&&3!==l&&Object(r.createElement)(a.Button,{isTertiary:!0,className:"bwf-big-button",onClick:function(e){ne("content");var t=2===l?bwfanParams.bwfan_global_settings.bwfan_sms_unsubscribe_text:bwfanParams.bwfan_global_settings.bwfan_email_footer_setting;m("body","".concat(pe||""," \n").concat(t))}},Object(o.__)("Add Unsubscribe Text","wp-marketing-automations-crm"))),Object(r.createElement)(a.FlexItem,null,1==l&&Object(r.createElement)(de.a,{templateData:v,type:1}),Object(r.createElement)(a.Button,{className:"bwf-ml-5 bwf-big-button",isSecondary:!0,onClick:function(){k(!0)}},ye.hasOwnProperty(l)?ye[l]:Object(o.__)("Send Test Email","wp-marketing-automations-crm")),E&&Object(r.createElement)(a.Popover,{onFocusOutside:function(){k(!1)},onClick:function(e){return e.stopPropagation()}},Object(r.createElement)("div",{className:"bwf-campaign-test-mail-wrap"},Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)("div",{className:"bwf-p"},Object(r.createElement)(a.TextControl,{value:$,onChange:function(e){return I(e)},placeholder:1==l?Object(o.__)("Enter email","wp-marketing-automations-crm"):Object(o.__)("Enter phone no.","wp-marketing-automations-crm")})),Object(r.createElement)(a.Button,{isPrimary:!0,className:"bwf-big-button",onClick:function(e){if(e.preventDefault(),r=!1,!(Object(b.isEmpty)($)||![2,3].includes(l)&&!Object(c.a)($)||![2,3].includes(l)&&!ge.subject||[2,3].includes(l)&&!Object(ie.a)($))&&ge.content&&ge.type&&ge.utmMedium&&ge.utmSource||(r=!0),r){var n="";Object(b.isEmpty)($)&&(n=[2,3].includes(l)?Object(o.__)("Phone is required field.","wp-marketing-automations-crm"):Object(o.__)("Email is required field.","wp-marketing-automations-crm")),Object(b.isEmpty)(n)&&([2,3].includes(l)?Object(ie.a)($)||(n=Object(o.__)("Entered phone is not valid.","wp-marketing-automations-crm")):Object(c.a)($)||(n=Object(o.__)("Entered email is not valid.","wp-marketing-automations-crm"))),!Object(b.isEmpty)(n)||[2,3].includes(l)||ge.subject||(n=Object(o.__)("Subject is required field.","wp-marketing-automations-crm")),Object(b.isEmpty)(n)&&!ge.content&&(n=Object(o.__)("Content is required field.","wp-marketing-automations-crm")),B({message:n,type:2})}else y($,t,"","");var r}},je.hasOwnProperty(l)?je[l]:Object(o.__)("Send Mail","wp-marketing-automations-crm")))),1==l&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(a.Button,{isSecondary:!0,className:"bwf-ml-5 bwf-big-button",onClick:function(){Object(b.isEmpty)(we())?B({message:"No content available for preview.",status:2}):z(!0)}},Object(o.__)("Show Preview","wp-marketing-automations-crm")),Z&&Object(r.createElement)(me,{setPreview:z,content:we(),type:A})))),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.CheckboxControl,{checked:x,label:Object(o.__)("Automatically append UTM parameters to email links","wp-marketing-automations-crm"),className:"bwf-crm-campaign-third-step-utm",onChange:function(e){return m("utmEnabled",e)}}),x&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)("div",{className:"bwf-campaign-utm-section"},Object(r.createElement)(a.TextControl,{value:V,onChange:function(e){return f("source",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Source","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM source","wp-marketing-automations-crm"),help:Object(o.__)("Referrer: (e.g., google, newsletter)","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"+Se}),Object(r.createElement)(a.TextControl,{value:G,onChange:function(e){return f("medium",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Medium","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM medium","wp-marketing-automations-crm"),help:Object(o.__)("Marketing medium: (e.g., CPC, banner, email)","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"+ke}),Object(r.createElement)(a.TextControl,{value:H,onChange:function(e){return f("name",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Name","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM name","wp-marketing-automations-crm"),help:Object(o.__)("Product, promo code, or slogan (e.g., spring_sale)","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"}),Object(r.createElement)(a.TextControl,{value:W,onChange:function(e){return f("term",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Term","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM term","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"}),Object(r.createElement)(a.TextControl,{value:K,onChange:function(e){return f("content",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Content","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM content","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"}))),3==l&&Object(r.createElement)(Ee,{enable:L,position:D,imageURL:F,setData:function(e,t){if("enable"==e)m("whatsAppImage",t);else if(["position","imageURL"].includes(e)){var n={position:D,imageURL:F};n[e]=t,m("whatsAppImageSetting",n)}}}),Object(r.createElement)(p.a,{message:R.message,type:R.type,removeMessage:function(){return B({message:"",type:1})}})),Object(r.createElement)(ce.a,{isOpen:Q,setOpenTags:X,onMergeTagSelected:function(e){"subject"===te&&m("subject","".concat(T||""," ").concat(e)),"content"===te&&m("body","".concat(pe||""," ").concat(e)),X(!1)},onMergeTagsLoaded:function(e){return le(e)}}),Object(d.V)()&&Object(r.createElement)(Ae,null))},De=n(519),Fe=(n(722),n(117)),Ve=function(e){var t=N(),n=S(),c=n.getSmartSendSettings(),i=c.enable,l=c.percent,s=c.hours,u=t.setSmartSendByKey,m=n.getShowValidationFlag(),d=n.getEmails();return Array.isArray(d)&&d.length>1?Object(r.createElement)(a.Card,{className:"bwf-c-campaign-email"},Object(r.createElement)("div",{className:"bwf-h4"},Object(o.__)("Smart Sending","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.ToggleControl,{label:Object(o.__)("Enable Smart Sending","wp-marketing-automations-crm"),className:"bwf-tooglecontrol-advance",checked:i,onChange:function(e){return u("enable",e)}}),i&&parseInt(l)>0&&parseInt(s)>0&&Object(r.createElement)("div",null,Object(o.sprintf)(Object(o.__)("This broadcast will be sent to %d percent of your contacts. After %d hours, open rates of all the variants would be analyzed and the one with the most opens would be sent to the remaining contacts.","wp-marketing-automations-crm"),parseInt(l),parseInt(s))),i&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.TextControl,{type:"number",value:l,onChange:function(e){return u("percent",e)},label:Object(o.__)("Sample size (in percent)","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter percent","wp-marketing-automations-crm"),className:be()({"bwf-field-comp-label-content":!0,"bwf-field-error":m&&!parseInt(l)})}),Object(r.createElement)(a.TextControl,{type:"number",value:s,onChange:function(e){return u("hours",e)},label:Object(o.__)("Wait time (in hours)","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter hour difference","wp-marketing-automations-crm"),className:be()({"bwf-field-comp-label-content":!0,"bwf-field-error":m&&!parseInt(s)})}))):null},Ge="ABCDEFGHIJKLMNOPQRSTUVWXYZ",He=function(e){var t=e.mailData,n=N(),c=S(),l=n.setCurrentEmail,s=n.addEmail,u=n.showValidation,m=n.deleteEmail,f=n.overrideCurrentContent,b={1:Object(o.__)("Email","wp-marketing-automations.crm"),2:Object(o.__)("SMS","wp-marketing-automations.crm"),3:Object(o.__)("WhatsApp","wp-marketing-automations.crm")},p=c.getEmails(),g=c.getCurrentEmail(),O=c.getSmartSendSettings(),y=c.emailsValidToSubmit(),j=c.getShowValidationFlag(),w=c.getValidEmails(),v=i.a.getCampaignData(),_=!(v&&v.data&&v.data.ab_type)||"ab"===v.data.ab_type,h=Object(r.useRef)(!1),E=Object(r.useCallback)((function(e){return be()({active:g===e,"bwf-error-tab":!w[e]&&j})})),k=!![!O.enable||!!parseInt(O.hours)&&p.length>1,!O.enable||!!parseInt(O.percent)&&p.length>1].reduce((function(e,t){return e&&t}),!0),C=Object(r.useContext)(d.b),$=function(e){f(e),C(Object(o.__)("Template Applied Successfully.","wp-marketing-automations-crm")),setTimeout((function(){C("")}),2e3)};return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-p-gap bwf-border"},(!y||!k)&&j&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Fe.a,null),Object(r.createElement)(a.Notice,{className:"bwf-error-notice",status:"error",onRemove:function(){return u(!1)}},Object(o.__)("Some required fields are not filled, check below","wp-marketing-automations-crm"))),_?Object(r.createElement)("div",{className:"bwf-c-campaign-email-tabs"},Object(r.createElement)("ul",null,p.map((function(e,t){return Object(r.createElement)("li",{onClick:function(){return function(e){!h.current&&l(e),h.current=!1}(e)},className:E(e)},Object(o.__)(0===t?"Control ":"Variant ","wp-marketing-automations-crm")," ",t>0&&Ge[parseInt(t)%Ge.length-1],t>0&&Object(r.createElement)(a.Button,{icon:"no",onClick:function(){return function(e){h.current=!0,m(e)}(e)}}))})),p.length<3&&Object(r.createElement)("li",{className:"bwf-c-campaign-email-variant"},Object(r.createElement)(a.Button,{icon:"plus",onClick:function(){return s()}},Object(o.__)("Add Variant","wp-marketing-automations-crm")))),1===parseInt(v.type)&&Object(r.createElement)("span",{className:"bwf-c-campaign-template-selector"},Object(r.createElement)(De.a,{applyTemplate:$}))):Object(r.createElement)("div",{className:"bwf-c-campaign-email-tabs"},Object(r.createElement)("ul",null,Object(r.createElement)("li",{style:{borderBottom:"2px solid #1daafc"}},b.hasOwnProperty(v.type)?b[v.type]:Object(o.__)("Email","wp-marketing-automations-crm"))),1===parseInt(v.type)&&Object(r.createElement)("span",{className:"bwf-c-campaign-template-selector"},Object(r.createElement)(De.a,{applyTemplate:$}))),Object(r.createElement)(Ue,{maildata:t}),Object(r.createElement)(Ve,null)))};function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){qe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ze(e,t,n,r,a,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Je(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Je(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.default=function(e){var t=location&&location.search?Object(f.parse)(location.search.substring(1)):{},n=ze(Object(r.useState)({message:"",type:1}),2),s=n[0],g=n[1],O=ze(Object(r.useState)([]),2),y=O[0],j=O[1],w=ze(Object(r.useState)(Object(d.q)("from_name")),2),v=w[0],_=w[1],h=ze(Object(r.useState)(Object(d.q)("from_email")),2),E=h[0],k=h[1],C=ze(Object(r.useState)(Object(d.q)("reply_to_email")),2),$=C[0],I=C[1],T=Object(l.a)().setCampaignValues,P=i.a.getCampaignId(),A=i.a.getCampaignData(),x=parseInt(A.type);Object(r.useEffect)((function(){A&&!Object(b.isNull)(A.data)&&(A.data.hasOwnProperty("content")&&!Object(b.isEmpty)(A.data.content)?j(A.data.content):j(1==x?[{subject:"",preheader:"",type:"rich",body:"",utm:{}}]:[{body:"",utm:{}}]),A.data.hasOwnProperty("senders_name")&&_(A.data.senders_name),A.data.hasOwnProperty("senders_email")&&k(A.data.senders_email),A.data.hasOwnProperty("replyto")&&!Object(b.isEmpty)(A.data.replyto)&&I(A.data.replyto))}),[]);var M={name:1!==x||null===v||v.length>0,email:1!==x||null===E||Object(c.a)(E),content:null===y||y.length>0},R=S(),B=R.emailsValidToSubmit(),L=R.getEmails(),U=R.getSmartSendSettings(),D=N();Object(r.useEffect)((function(){if(A&&A.data){var e=!A.data.ab_type||"ab"===A.data.ab_type,t=A.data.content?Array.isArray(A.data.content)&&!e?[A.data.content[0]]:A.data.content:[],n=A.data.smart_send&&e?A.data.smart_send:{};D.initContent(t,n)}}),[P]);var F=!![1!==x||v&&v.length>0,1!==x||E&&Object(c.a)(E),1!==x||Object(b.isEmpty)($)||$&&Object(c.a)($)].reduce((function(e,t){return e&&t}),!0),V=!![!U.enable||!!parseInt(U.hours)&&L.length>1,!U.enable||!!parseInt(U.percent)&&L.length>1].reduce((function(e,t){return e&&t}),!0),G=function(){var t,n=(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(D.showValidation(!1),!(F&&B&&V)){t.next=14;break}return e.setPending(!0),t.prev=3,t.next=6,u()({path:Object(d.f)("/broadcast/".concat(P)),method:"POST",data:{data:We({content:L.map((function(e){return B[e]})),senders_name:v,senders_email:E,replyto:$,modified_by:Object(d.m)()},U.enable?{smart_send:{enable:U.enable,percent:U.percent,hours:U.hours}}:{}),step:3},headers:{"Content-Type":"application/json"}}).then((function(e){200===e.code&&(T("data",e.result),T("step",4))}));case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),g({message:t.t0.message,type:0});case 11:e.setPending(!1),t.next=15;break;case 14:D.showValidation(!0);case 15:case"end":return t.stop()}}),t,null,[[3,8]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function c(e){Ze(o,r,a,c,i,"next",e)}function i(e){Ze(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(){return n.apply(this,arguments)}}(),H=M&&!M.email?" bwf-field-error":"",K=M&&!M.name?" bwf-field-error":"";return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Fe.a,null),Object(r.createElement)("div",{className:"bwf-campaign-step-div bwf-card-wrap bwf-campaign-step-3"},Object(r.createElement)("div",{className:"bwf-card-header"},Object(r.createElement)("span",{className:"bwf-form-title"},Object(o.__)("Content","wp-marketing-automations-crm"))),1===x&&Object(r.createElement)("div",{className:"bwf-p-gap"},Object(r.createElement)(a.Card,{className:"bwf-c-campaign-email"},Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.TextControl,{value:v,onChange:_,label:Object(o.__)("From Name","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter From Name","wp-marketing-automations-crm"),className:K}))),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.TextControl,{value:E,onChange:k,label:Object(o.__)("From Email","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter From Email","wp-marketing-automations-crm"),className:H})),Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.TextControl,{value:$,placeholder:Object(o.__)("Enter Reply-To Email","wp-marketing-automations-crm"),label:Object(o.__)("Reply-To Email","wp-marketing-automations-crm"),onChange:I}))))),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)(He,{mailData:{reply_to:$,senders_email:E,senders_name:v}}),Object(r.createElement)(p.a,{message:s.message,type:s.type,removeMessage:function(){return g({message:"",type:1})}})),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-crm-campaign-navigation"},Object(r.createElement)(a.Button,{className:"bwf-crm-navigation-previous bwf-big-button",isSecondary:!0,onClick:function(){var e=A.data&&!Object(b.isNull)(A.data)&&A.data.hasOwnProperty("filters")?A.data.filters:{};Object(b.isEmpty)(e)||Object(m.j)(e,"/",t),T("step",2)}},Object(o.__)("Previous","wp-marketing-automations-crm")),Object(r.createElement)(a.Button,{isPrimary:!0,className:"bwf-crm-navigation-next bwf-big-button",disabled:!F,onClick:G},Object(o.__)("Next","wp-marketing-automations-crm"))))))}}}]);