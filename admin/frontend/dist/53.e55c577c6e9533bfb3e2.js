(window.webpackJsonp=window.webpackJsonp||[]).push([[53,15],{123:function(e,t,n){"use strict";var r=n(0),a=n(4),o=n(5),c=n(8),i=n.n(c),l=n(15),u=n.n(l),s=(n(134),n(160));function m(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t,n,r,a,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w(e);if(t){var a=w(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return y(this,n)}}function y(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?j(e):t}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(i,e);var t,n,o,c=O(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=c.call(this,e)).state={options:[]},t.appendFreeTextSearch=t.appendFreeTextSearch.bind(j(t)),t.fetchOptions=t.fetchOptions.bind(j(t)),t.updateSelected=t.updateSelected.bind(j(t)),t}return t=i,(n=[{key:"getAutocompleter",value:function(){return this.props.autocompleter&&"object"===d(this.props.autocompleter)?this.props.autocompleter:{}}},{key:"getFormattedOptions",value:function(e,t){var n=this.getAutocompleter(),r=[];return e.forEach((function(e){var a={key:n.getOptionIdentifier(e),label:n.getOptionLabel(e,t),keywords:n.getOptionKeywords(e).filter(Boolean),value:e};r.push(a)})),r}},{key:"fetchOptions",value:function(e,t){var n=this;return this.props.bwfEnableEmptySearch||t?this.getAutocompleter().options(t).then(function(){var e,r=(e=regeneratorRuntime.mark((function e(r){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getFormattedOptions(r,t),n.setState({options:a}),e.abrupt("return",a);case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){f(o,r,a,c,i,"next",e)}function i(e){f(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(e){return r.apply(this,arguments)}}()):[]}},{key:"updateSelected",value:function(e){var t=this.props.onChange,n=this.getAutocompleter();t(e.map((function(e){return!e.notFound&&(e.value?n.getOptionCompletion(e.value):e)})).filter(Boolean))}},{key:"appendFreeTextSearch",value:function(e,t){var n=this.props.allowFreeTextSearch;if(!t||!t.length)return[];if(!n)return e.length>0?e:[{label:Object(a.__)("Not Found","wp-marketing-automations-crm"),key:"",notFound:!0}];var r=this.getAutocompleter();return[].concat(m(r.getFreeTextOptions(t,e)),m(e))}},{key:"render",value:function(){var e=this.getAutocompleter(),t=this.props,n=t.className,a=t.inlineTags,o=t.placeholder,c=t.selected,i=t.showClearButton,l=t.staticResults,m=t.disabled,b=(t.multiple,this.state.options),f=e.inputType?e.inputType:"text";return Object(r.createElement)("div",null,Object(r.createElement)(s.a,{className:u()("bwf-search",n,{"is-static-results":l}),disabled:m,hideBeforeSearch:!1,inlineTags:a,isSearchable:!0,label:o,getSearchExpression:e.getSearchExpression,multiple:!0,placeholder:o,onChange:this.updateSelected,onFilter:this.appendFreeTextSearch,onSearch:this.fetchOptions,options:b,remove:this.props.onRemoveTag,searchDebounceTime:500,searchInputType:f,selected:c,showClearButton:i,bwfMaintainSingleTerm:this.props.bwfMaintainSingleTerm}))}}])&&p(t.prototype,n),o&&p(t,o),i}(r.Component);v.propTypes={allowFreeTextSearch:i.a.bool,className:i.a.string,onChange:i.a.func,autocompleter:i.a.object,placeholder:i.a.string,selected:i.a.arrayOf(i.a.shape({key:i.a.oneOfType([i.a.number,i.a.string]).isRequired,label:i.a.string})),inlineTags:i.a.bool,showClearButton:i.a.bool,staticResults:i.a.bool,disabled:i.a.bool,bwfMaintainSingleTerm:i.a.bool,bwfEnableEmptySearch:i.a.bool},v.defaultProps={allowFreeTextSearch:!1,onChange:o.noop,selected:[],inlineTags:!1,showClearButton:!1,staticResults:!1,disabled:!1,bwfMaintainSingleTerm:!1,bwfEnableEmptySearch:!1},t.a=v},134:function(e,t,n){},137:function(e,t,n){"use strict";var r=n(0),a=n(109),o=n(120),c=n(121),i=n(9),l=n(4);t.a=function(e){var t=e.confirmText,n=void 0===t?"":t,u=e.confirmButtonText,s=void 0===u?"":u,m=e.cancelButtonText,b=void 0===m?"":m,f=e.onConfirm,d=void 0===f?function(){}:f,p=e.isLoading,g=void 0!==p&&p,O=e.successMessage,y=void 0===O?"":O,j=e.errorMessage,w=void 0===j?"":j,v=e.onRequestClose,h=e.isOpen,E=void 0!==h&&h,_=e.confirmDescription,S=void 0===_?"":_,k=e.isDelete,C=void 0!==k&&k;Object(r.useEffect)((function(){(y||w)&&setTimeout((function(){v&&v()}),2e3)}),[y,w]);return E?Object(r.createElement)(i.Modal,{title:"",onRequestClose:function(){return v()},className:"bwf-c-s-delete-model bwf-admin-modal bwf-admin-modal-small bwf-admin-modal-no-header"},C&&Object(r.createElement)("div",{className:"bwf-h4"},Object(l.__)("Delete","wp-marketing-automations-crm")),g&&Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.a,null)),!!y&&Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)(o.a,null),Object(r.createElement)("div",{className:"bwf-h1"},y)),!!w&&Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)(c.a,null),Object(r.createElement)("div",{className:"bwf-h1"},w)),!g&&!y&&!w&&Object(r.createElement)("div",{className:"bwf-t-center bwf-form-buttons"},C?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-h2"},Object(l.__)("Are you sure?","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_clear_15"}),Object(r.createElement)("div",{className:"bwf-h4 bwf-h4-grey"},Object(l.__)("Once you delete this item. It will no longer available.","wp-marketing-automations-crm"))):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-h1"},n),!!S&&Object(r.createElement)("p",null,S)),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:C?"bwf_text_right":""},Object(r.createElement)(i.Button,{isTertiary:!0,style:{marginRight:"20px"},onClick:function(){v&&v()}},b),Object(r.createElement)(i.Button,{isPrimary:!0,onClick:function(){d&&d()},className:C?"bwf-delete-btn":""},s)))):null}},146:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},178:function(e,t,n){"use strict";var r=n(0),a=n(4),o=n(9),c=n(15),i=n.n(c),l=n(8),u=n.n(l),s=n(5),m=n(186),b=n(195),f=n(196);n(182);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w(e);if(t){var a=w(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return y(this,n)}}function y(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?j(e):t}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=[10,25,50,75,100],h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(u,e);var t,n,c,l=O(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=l.call(this,e)).state={inputValue:t.props.page},t.previousPage=t.previousPage.bind(j(t)),t.nextPage=t.nextPage.bind(j(t)),t.onInputChange=t.onInputChange.bind(j(t)),t.onInputBlur=t.onInputBlur.bind(j(t)),t.perPageChange=t.perPageChange.bind(j(t)),t.selectInputValue=t.selectInputValue.bind(j(t)),t}return t=u,(n=[{key:"previousPage",value:function(e){e.stopPropagation();var t=this.props,n=t.page,r=t.onPageChange;n-1<1||r(n-1,"previous")}},{key:"nextPage",value:function(e){e.stopPropagation();var t=this.props,n=t.page,r=t.onPageChange;n+1>this.pageCount||r(n+1,"next")}},{key:"perPageChange",value:function(e){var t=this.props,n=t.onPerPageChange,r=t.onPageChange,a=t.total,o=t.page;n(parseInt(e,10));var c=Math.ceil(a/parseInt(e,10));o>c&&r(c)}},{key:"onInputChange",value:function(e){this.setState({inputValue:e.target.value})}},{key:"onInputBlur",value:function(e){var t=this.props,n=t.onPageChange,r=t.page,a=parseInt(e.target.value,10);a!==r&&Number.isFinite(a)&&a>0&&this.pageCount&&this.pageCount>=a&&n(a,"goto")}},{key:"selectInputValue",value:function(e){e.target.select()}},{key:"renderPageArrows",value:function(){var e=this.props,t=e.page,n=e.showPageArrowsLabel;if(this.pageCount<=1)return null;var c=i()("bwf-pagination-link",{"is-active":t>1}),l=i()("bwf-pagination-link",{"is-active":t<this.pageCount});return Object(r.createElement)("div",{className:"bwf-pagination-page-arrows"},n&&Object(r.createElement)("span",{className:"bwf-pagination-page-arrows-label",role:"status","aria-live":"polite"},Object(a.sprintf)(Object(a.__)("Page %d of %d","wp-marketing-automations-crm"),t,this.pageCount)),Object(r.createElement)("div",{className:"bwf-pagination-page-arrows-buttons"},Object(r.createElement)(o.Button,{className:c,disabled:!(t>1),onClick:this.previousPage,label:Object(a.__)("Previous Page","wp-marketing-automations-crm")},Object(r.createElement)(m.a,{icon:b.a})),Object(r.createElement)(o.Button,{className:l,disabled:!(t<this.pageCount),onClick:this.nextPage,label:Object(a.__)("Next Page","wp-marketing-automations-crm")},Object(r.createElement)(m.a,{icon:f.a}))))}},{key:"renderPagePicker",value:function(){var e=this.props.page,t=this.state.inputValue,n=e<1||e>this.pageCount,o=i()("bwf-pagination-page-picker-input",{"has-error":n}),c=Object(s.uniqueId)("bwf-pagination-page-picker-");return Object(r.createElement)("div",{className:"bwf-pagination-page-picker"},Object(r.createElement)("label",{htmlFor:c,className:"bwf-pagination-page-picker-label"},Object(a.__)("Go to page","wp-marketing-automations-crm"),Object(r.createElement)("input",{id:c,className:o,"aria-invalid":n,type:"number",onClick:this.selectInputValue,onChange:this.onInputChange,onBlur:this.onInputBlur,value:t,min:1,max:this.pageCount})))}},{key:"renderPerPagePicker",value:function(){var e=v.map((function(e){return{value:e,label:e}}));return Object(r.createElement)("div",{className:"bwf-pagination-per-page-picker"},Object(r.createElement)(o.SelectControl,{label:Object(a.__)("Rows per page","wp-marketing-automations-crm"),value:this.props.perPage,onChange:this.perPageChange,options:e,labelPosition:"side"}))}},{key:"render",value:function(){var e=this.props,t=e.total,n=e.perPage,a=e.className,o=e.showPagePicker,c=e.showPerPagePicker;this.pageCount=Math.ceil(t/n);var l=i()("bwf-pagination",a);return this.pageCount<=1?t>v[0]&&Object(r.createElement)("div",{className:l},this.renderPerPagePicker())||null:Object(r.createElement)("div",{className:l},this.renderPageArrows(),o&&this.renderPagePicker(),c&&this.renderPerPagePicker())}}])&&p(t.prototype,n),c&&p(t,c),u}(r.Component);h.propTypes={page:u.a.number.isRequired,onPageChange:u.a.func,perPage:u.a.number.isRequired,onPerPageChange:u.a.func,total:u.a.number.isRequired,className:u.a.string,showPagePicker:u.a.bool,showPerPagePicker:u.a.bool,showPageArrowsLabel:u.a.bool},h.defaultProps={onPageChange:s.noop,onPerPageChange:s.noop,showPagePicker:!0,showPerPagePicker:!0,showPageArrowsLabel:!0},t.a=h},182:function(e,t,n){},224:function(e,t,n){"use strict";var r=n(0);n(257);t.a=function(e){return Object(r.useEffect)((function(){setTimeout((function(){e.removeMessage()}),5e3)}),[e.message]),Object(r.createElement)(r.Fragment,null,e.message&&Object(r.createElement)("div",{id:"bwfcrm-message-notice"},Object(r.createElement)("span",{className:"bwfcrm-message-text"},e.message)))}},257:function(e,t,n){},323:function(e,t,n){"use strict";var r=n(0),a=n(15),o=n.n(a);n(324);t.a=function(e){var t=e.white,n=void 0!==t&&t,a=e.image,c=void 0!==a&&a,i=e.long,l=void 0!==i&&i,u=e.width,s=void 0===u?0:u,m=e.height,b=void 0===m?0:m,f=o()({"bwf-placeholder-loader":!0,"is-white":!!n,"is-image":!!c,"is-long":!!l}),d=Object(r.useCallback)((function(){var e={width:s?"".concat(s,"px"):"120px"};return b&&(e.height="".concat(b,"px")),e}),[s]);return Object(r.createElement)("p",{className:f,style:d()})}},324:function(e,t,n){},361:function(e,t,n){"use strict";var r=n(0),a=n(123),o=n(4),c=n(139);t.a=function(e){var t=e.selected,n=e.onTagsChange;return Object(r.createElement)("div",{className:"bwf-c-field-mapper-terms"},Object(r.createElement)("div",{className:"bwf-input-label"},Object(o.__)("Add Tags","wp-marketing-automations-crm")),Object(r.createElement)(a.a,{autocompleter:c.b,multiple:!1,allowFreeTextSearch:!0,inlineTags:!1,selected:t,onChange:function(e){n(e)},onRemoveTag:function(e,r){var a=t.filter((function(t){return!(t.key==e&&t.label==r)}));n(a)},placeholder:Object(o.__)("Search by tag name","wp-marketing-automations-crm"),showClearButton:!0,disabled:!1}))}},478:function(e,t,n){"use strict";var r=n(0),a=n(9),o=n(15),c=n.n(o);n(479);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.a=function(e){var t=e.icon,n=e.children,o=e.isSelected,u=e.upperText,s=e.upperTextColor,m=e.onLowerClick,b=e.lowerText,f=e.lowerTextColor,d=e.onClick,p=e.isDisabled,g=e.alterButton,O=void 0!==g&&g,y=o?{isPrimary:!0}:{isSecondary:!0};p&&(y.disabled=!0);var j=c()(l({"bwf-c-upper-banner":!0},s,!0)),w=c()(l({"bwf-c-lower-banner":!0},f,!0)),v=function(e){m(),e.preventDefault()};return Object(r.createElement)("div",{className:c()("bwf-c-big-icon-button",{"bwf-alter-button":O})},u&&Object(r.createElement)("span",{className:j},u),Object(r.createElement)(a.Button,i({icon:t},y,{onClick:d||function(){},className:"bwf-display-flex"}),Object(r.createElement)("span",null,n)),b&&Object(r.createElement)("span",{onClick:v||function(){},className:w},b))}},479:function(e,t,n){},485:function(e,t,n){"use strict";var r=n(0),a=n(9);n(99);var o=n(4);var c=Object(a.createSlotFill)("StandAloneBlockEditorSidebarInspector"),i=c.Slot,l=c.Fill;function u(){return Object(r.createElement)("div",{className:"getdavesbe-sidebar",role:"region","aria-label":Object(o.__)("Standalone Block Editor advanced settings."),tabIndex:"-1"},Object(r.createElement)(a.Panel,{header:Object(o.__)("Inspector")},Object(r.createElement)(i,{bubblesVirtually:!0})))}u.InspectorFill=l;n(100),n(101),n(102);var s=n(103);Object(s.registerCoreBlocks)();var m=n(29),b=n(5);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=function(e){var t=e.content,n=void 0===t?"":t,a=e.setContent,o=e.keyid,c=Object(r.useRef)(!1),i=Object(r.useRef)(n),l=g(Object(r.useState)(n),2),u=l[0],s=l[1];return Object(r.useEffect)((function(){if(c.current){var e=window.tinymce.get("editor-bwfcrm"+o);(null==e?void 0:e.getContent())!==n&&(e.setContent(n||""),i.current=n||"")}}),[n]),Object(r.useEffect)((function(){a(u)}),[u]),Object(r.useEffect)((function(){function e(){var e=window.wpEditorL10n.tinymce.settings;wp.oldEditor.initialize("editor-bwfcrm"+o,{tinymce:d(d({},e),{},{inline:!1,content_css:!1,setup:t,height:400})})}function t(e){var t=Object(b.debounce)((function(){var t=e.getContent();t!==e._lastChange&&(e._lastChange=t,s(t))}),250);e.on("Paste Change input Undo Redo",t),e.on("remove",t.cancel),e.on("keydown",(function(t){m.isKeyboardEvent.primary(t,"z")&&t.stopPropagation(),t.keyCode!==m.BACKSPACE&&t.keyCode!==m.DELETE||!function(e){var t=e.getBody();return!(t.childNodes.length>1)&&(0===t.childNodes.length||!(t.childNodes[0].childNodes.length>1)&&/^\n?$/.test(t.innerText||t.textContent))}(e)||(onReplace([]),t.preventDefault(),t.stopImmediatePropagation()),t.altKey&&t.keyCode===m.F10&&t.stopPropagation()})),e.on("init",(function(){e.setContent(i.current),s(i.current)}))}function n(){"complete"===document.readyState&&e()}return c.current=!0,"complete"===document.readyState?e():document.addEventListener("readystatechange",n),function(){document.removeEventListener("readystatechange",n),wp.oldEditor.remove("editor-bwfcrm"+o)}}),[]),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",null,Object(r.createElement)("div",{key:"editor",id:"editor-bwfcrm"+o,className:"wp-block-freeform block-library-rich-text__tinymce"})))};function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}t.a=function(e){return Object(r.createElement)(y,j({},e,{keyid:e.keyid}))}},516:function(e,t,n){"use strict";var r=n(0),a=n(9),o=n(4),c=n(5),i=n(16),l=n.n(i),u=n(7),s=(n(553),n(109)),m=n(13);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a=function(e){var t=e.isOpen,n=e.setOpenTags,i=e.onMergeTagsLoaded,b=e.context,d=p(Object(r.useState)(""),2),g=d[0],O=d[1],y=p(Object(r.useState)("contact"),2),j=y[0],w=y[1],v=p(Object(r.useState)([]),2),h=v[0],E=v[1],_=p(Object(r.useState)(!0),2),S=_[0],k=_[1],C=Object(r.useContext)(u.b);Object(r.useEffect)((function(){var e=b?"?context=".concat(b):"";l()({path:Object(u.g)("/broadcast/merge-tags".concat(e)),method:"GET"}).then((function(e){200===e.code&&(E(e.result),i(e.result),k(!1))}))}),[]);Object(r.useEffect)((function(){O(""),w("general")}),[t]);var P=[{label:Object(o.__)("General","wp-marketing-automations-crm"),value:"general"},{label:Object(o.__)("Contacts","wp-marketing-automations-crm"),value:"contact"},{label:Object(o.__)("Fields","wp-marketing-automations-crm"),value:"contact_fields"}];return t?Object(r.createElement)(a.Modal,{title:Object(o.__)("Merge Tags","wp-marketing-automations-crm"),onRequestClose:function(){return n(!1)},className:"bwf-crm-merge-tag-model bwf-admin-modal bwf-admin-modal-xl bwf-admin-modal-no-header bwf-show-close"},Object(r.createElement)("div",{className:"bwf-merge-tag-header"},Object(r.createElement)("div",{className:"bwf-merge-tag-label bwf-h3"},Object(o.__)("Merge Tags","wp-marketing-automations-crm")),Object(r.createElement)(a.TextControl,{className:"bwf-merge-tag-search",value:g,onChange:function(e){return O(e)},autoComplete:"off",placeholder:Object(o.__)("Search by name","wp-marketing-automations-crm")})),Object(r.createElement)("div",{className:"bwf-merge-tab"},Object(r.createElement)("div",{className:"bwf-merge-header"},Object(r.createElement)("div",{className:"bwf-header-option "+(""===j?"active":""),onClick:function(){return w("")}},Object(r.createElement)(m.a,{icon:"merge-tag",size:18,color:""===j?"#0073aa":""}),Object(r.createElement)("span",{className:"bwf-filter-label"},Object(o.__)("All","wp-marketing-automations-crm")),""===j&&Object(r.createElement)("span",{className:"bwf-filter-arrow"},Object(r.createElement)(m.a,{icon:"tailless-arrow-forward"}))),Object(r.createElement)("div",{className:"bwf-category-label"},Object(o.__)("Filter By Category","wp-marketing-automations-crm")),P&&P.map((function(e){return Object(r.createElement)("div",{className:"bwf-header-option "+(e.value===j?"active":""),onClick:function(){return w(e.value)}},Object(r.createElement)(m.a,{icon:"merge-tag",size:18,color:j===e.value?"#0073aa":""}),Object(r.createElement)("span",{className:"bwf-filter-label"},e.label),e.value===j&&Object(r.createElement)("span",{className:"bwf-filter-arrow"},Object(r.createElement)(m.a,{icon:"tailless-arrow-forward"})))}))),S?Object(r.createElement)("div",{className:"bwf-merge-loading"},Object(r.createElement)(s.a,null)):function(){var e=[];if(Object(c.isEmpty)(j)?Object.entries(h).map((function(t){var n=p(t,2),r=(n[0],n[1]);e=f(f({},e),r)})):e=h[j],!Object(c.isEmpty)(g)){var t=[];Object.keys(e).map((function(n){if(-1!=e[n].toLowerCase().indexOf(g.toLowerCase())){var r={};r[n]=e[n],t=f(f({},t),r)}})),e=t}return Object(r.createElement)("div",{className:"bwf-merge-tag-list"},Object(r.createElement)("table",null,Object(r.createElement)("tbody",null,Object(c.isEmpty)(e)?Object(r.createElement)("tr",null,Object(r.createElement)("div",{className:"bwf-p-15 bwf-t-center"},Object(o.__)("No merge tags available","wp-marketing-automations-crm"))):Object.keys(e).map((function(t){return Object(r.createElement)("tr",null,Object(r.createElement)("td",null,Object(r.createElement)("span",{className:"bwf-tag-label"},e[t]),Object(r.createElement)("span",{className:"bwf-tag-slug"},"{{"+t+"}}")),Object(r.createElement)("td",null,Object(r.createElement)("span",{className:"bwf-tag-item-select",onClick:function(){var e,r;e="{{"+t+"}}",(r=document.createElement("textarea")).value=e,document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r),C(Object(o.__)("Merge tag copied.","wp-marketing-automations-crm")),Object(u.L)(C,2e3),n(!1)}},Object(o.__)("Copy","wp-marketing-automations-crm"))))})))))}())):""}},517:function(e,t,n){"use strict";var r=n(0),a=n(4),o=n(9),c=n(120),i=n(121),l=n(109),u=n(5),s=n(16),m=n.n(s),b=n(7);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t,n,r,a,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a=function(e){var t=e.templateData,n=e.type,s=O(Object(r.useState)(!1),2),f=s[0],p=s[1],y=O(Object(r.useState)(""),2),j=y[0],w=y[1],v=O(Object(r.useState)(!1),2),h=v[0],E=v[1],_=O(Object(r.useState)({loading:!1,success:!1,error:!1,message:""}),2),S=_[0],k=_[1],C={rich:1,wc:2,html:3,editor:4},P=function(){var e,r=(e=regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k(d(d({},S),{},{loading:!0})),!j){e.next=14;break}return r={template:"editor"===t.type?t.editor.body:t.body,title:j,subject:t.subject,type:n||2,mode:C[t.type],data:{preheader:t.hasOwnProperty("preheader")?t.preheader:"",utmEnabled:t.hasOwnProperty("utmEnabled")?t.utmEnabled:"",utm:t.hasOwnProperty("utm")?t.utm:{},design:"editor"===t.type?t.editor.design:""}},e.prev=3,e.next=6,m()({path:Object(b.g)("/template"),method:"POST",data:r}).then((function(e){200===e.code&&(k({loading:!0,success:!0,message:e.message}),setTimeout((function(){k({loading:!1,success:!1,error:!1,message:""}),p(!1)}),2e3))}));case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(3),k({loading:!0,error:!0,message:e.t0.message}),setTimeout((function(){k({loading:!1,success:!1,error:!1,message:""})}),2e3);case 12:e.next=16;break;case 14:E(!0),k({loading:!1,success:!1,error:!1,message:""});case 16:case"end":return e.stop()}}),e,null,[[3,8]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){g(o,r,a,c,i,"next",e)}function i(e){g(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(){return r.apply(this,arguments)}}();return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(o.Button,{isSecondary:!0,className:"bwf-big-button",onClick:function(){w(""),k({loading:!1,success:!1,error:!1,message:""}),p(!0)}},Object(a.__)("Save As Template","wp-marketing-automations-crm")),f&&Object(r.createElement)(o.Modal,{title:"Template",onRequestClose:function(){return p(!1)},className:"bwf-admin-modal bwf-admin-modal-medium"},S.loading?S&&S.success&&S.message?Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)(c.a,null),Object(r.createElement)("div",{className:"bwf-h1"},S.message)):S&&S.error&&S.message?Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)(i.a,null),Object(r.createElement)("div",{className:"bwf-h1"},S.message)):Object(r.createElement)(l.a,null):Object(r.createElement)("div",{onKeyPress:function(e){"Enter"===e.key&&(Object(u.isEmpty)(j)?E(!0):P())}},h&&Object(r.createElement)(o.Notice,{status:"error",onRemove:function(){return E("")}},Object(a.__)("Title is required","wp-marketing-automations-crm")),Object(r.createElement)(o.TextControl,{value:j,onChange:function(e){w(e),Object(u.isEmpty)(e)?E(!0):E(!1)},placeholder:Object(a.__)("Enter template title","wp-marketing-automations-crm")}),Object(r.createElement)("div",{className:"bwf_text_right bwf-form-buttons"},Object(r.createElement)(o.Button,{isPrimary:!0,className:"bwf-big-button",onClick:function(){return P()}},Object(a.__)("Save","wp-marketing-automations-crm"))))))}},518:function(e,t,n){"use strict";var r=n(0),a=n(9),o=(n(556),n(4)),c=n(16),i=n.n(c),l=n(7),u=n(109),s=n(5),m=n(13);function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a=function(e){var t=e.applyTemplate,n=b(Object(r.useState)(!1),2),c=n[0],f=n[1],d=b(Object(r.useState)(""),2),p=d[0],g=d[1],O=b(Object(r.useState)(""),2),y=O[0],j=O[1],w=b(Object(r.useState)([]),2),v=w[0],h=w[1],E=b(Object(r.useState)(!0),2),_=E[0],S=E[1],k=b(Object(r.useState)(!1),2),C=k[0],P=(k[1],b(Object(r.useState)(0),2)),N=(P[0],P[1],["rich","html","editor"].concat(Object(l.I)())),T=(Object(r.useContext)(l.b),function(){try{i()({method:"GET",path:Object(l.g)("/templates?limit=0&offset=0")}).then((function(e){200===e.code&&(h(e.result),S(!1))}))}catch(e){S(!1)}}),x={rich:{label:Object(o.__)("Text","wp-marketing-automations-crm"),value:1},wc:{label:Object(o.__)("WooCommerce","wp-marketing-automations-crm"),value:2},html:{label:Object(o.__)("Raw HTML","wp-marketing-automations-crm"),value:3},editor:{label:Object(o.__)("Drag and Drop","wp-marketing-automations-crm"),value:4}},A={1:"rich",2:"wc",3:"html",4:"editor"},I=function(){var e=[];return v.map((function(t){!N.includes(A[parseInt(t.mode)])||y&&parseInt(t.mode)!==parseInt(y)||p&&(!t.title||-1===t.title.toLowerCase().indexOf(p.toLowerCase()))||Object(s.isEmpty)(t.template)||Object(s.isEmpty)(t.subject)||e.push(t)})),e};return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-list-template-wrap"},Object(r.createElement)(a.Button,{isTertiary:!0,className:"bwf-display-flex",title:Object(o.__)("My Templates","wp-marketing-automations-crm"),onClick:function(){T(),g(""),j(""),f(!c)}},Object(o.__)("My Templates","wp-marketing-automations-crm"))),c&&Object(r.createElement)(a.Modal,{title:Object(o.__)("My Templates","wp-marketing-automations-crm"),onRequestClose:function(){return f(!1)},className:"bwf-admin-modal bwf-admin-modal-xl bwf-template-modal bwf-admin-modal-no-header bwf-show-close"},_?Object(r.createElement)(u.a,null):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-template-header"},Object(r.createElement)("div",{className:"bwf-template-label bwf-h4"},Object(o.__)("My Templates","wp-marketing-automations-crm")),Object(r.createElement)(a.TextControl,{className:"bwf-template-search",value:p,onChange:function(e){return g(e)},autoComplete:"off",placeholder:Object(o.__)("Search by name","wp-marketing-automations-crm")})),Object(r.createElement)("div",{className:"bwf-template-content-wrap"},Object(r.createElement)("div",{className:"bwf-filter-section"},Object(r.createElement)("div",{className:"bwf-header-option "+(""===y?"active":""),onClick:function(){return j("")}},Object(r.createElement)(m.a,{icon:"templates",size:18}),Object(r.createElement)("span",{className:"bwf-filter-label"},Object(o.__)("All","wp-marketing-automations-crm")),""===y&&Object(r.createElement)("span",{className:"bwf-filter-arrow"},Object(r.createElement)(m.a,{icon:"tailless-arrow-forward"}))),Object(r.createElement)("div",{className:"bwf-category-label"},Object(o.__)("Filter By Type","wp-marketing-automations-crm")),x&&Object.entries(x).map((function(e){var t=b(e,2),n=t[0],a=t[1];if(N.includes(n))return Object(r.createElement)("div",{className:"bwf-header-option "+(a.value===y?"active":""),onClick:function(){return j(a.value)}},Object(r.createElement)(m.a,{icon:"templates",size:18}),Object(r.createElement)("span",{className:"bwf-filter-label"},a.label),a.value===y&&Object(r.createElement)("span",{className:"bwf-filter-arrow"},Object(r.createElement)(m.a,{icon:"tailless-arrow-forward"})))}))),Object(r.createElement)("div",{className:"bwf-template-table-wrapper"},Object(r.createElement)("table",{className:"bwf-template-list-table"},Object(r.createElement)("tbody",null,I().length>0?I().map((function(e){return Object(r.createElement)("tr",null,Object(r.createElement)("td",null,Object(r.createElement)("span",{className:"bwf-template-title"},e.title?e.title:"-"),Object(r.createElement)("span",{className:"bwf-template-create-detail bwf-subject"},e.subject?Object(r.createElement)(r.Fragment,null,Object(o.__)("Subject ","wp-marketing-automations-crm")+" : "+e.subject):"-"),Object(r.createElement)("span",{className:"bwf-template-create-detail"},e.created_at?Object(r.createElement)(r.Fragment,null,Object(o.__)("Created on ","wp-marketing-automations-crm"),Object(l.B)(e.created_at)):"")),Object(r.createElement)("td",null,Object(r.createElement)("div",{className:"bwf-template-action-wrap"},Object(r.createElement)("span",{className:"bwf-template-item-apply",onClick:function(){C||(t(function(e){var t={body:4!==parseInt(e.mode)&&e.hasOwnProperty("template")?e.template:"",type:e.hasOwnProperty("mode")?A[e.mode]:1,subject:e.hasOwnProperty("subject")?e.subject:"",preheader:e.hasOwnProperty("data")&&e.data&&e.data.hasOwnProperty("preheader")?e.data.preheader:"",utmEnabled:!!(e.hasOwnProperty("data")&&e.data&&e.data.hasOwnProperty("utmEnabled"))&&e.data.utmEnabled};return t.utmEnabled&&(t.utm=e.hasOwnProperty("data")&&e.data&&e.data.hasOwnProperty("utm")?e.data.utm:{}),4===parseInt(e.mode)&&(t.editor={body:e.hasOwnProperty("template")?e.template:"",design:e.hasOwnProperty("data")&&e.data&&e.data.hasOwnProperty("design")?e.data.design:""}),t}(e)),f(!1))}},Object(o.__)("Apply","wp-marketing-automations-crm")))))})):Object(r.createElement)("span",{className:"bwf-display-flex bwf-p-15"},Object(o.__)("No Templates Found","wp-marketing-automations-crm")))))))))}},520:function(e,t,n){"use strict";var r=n(0),a=n(9),o=n(178),c=n(124),i=n(7),l=n(4),u=n(323);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var m=function(e){var t=e.size,n=void 0===t?10:t;return Object(r.createElement)("table",null,Object(r.createElement)("tbody",null,Array.from(Array(n).keys()).map((function(){return Object(r.createElement)("tr",null,Object(r.createElement)("td",null,Object(r.createElement)("div",{className:"bwf-c-product-modal-row"},Object(r.createElement)(u.a,{width:50,height:50}),Object(r.createElement)("div",{className:"bwf-c-product-modal-row-info"},Object(r.createElement)("span",{className:"bwf-tag-label"},Object(r.createElement)(u.a,{width:70})),Object(r.createElement)("span",{className:"bwf-tag-slug"},Object(r.createElement)(u.a,{width:120,height:10}))))),Object(r.createElement)("td",null,Object(r.createElement)(u.a,{width:80,height:32})))}))))},b=function(e){var t=e.products,n=e.onProductSelected,a=Object(c.a)(Object(i.H)()).formatAmount;return Object(r.createElement)("table",null,Object(r.createElement)("tbody",null,t.map((function(e){var t=[Object(l.__)("Price: ","wp-marketing-automations")+a(e.price),!!e.stock_quantity&&Object(l.__)("Stock: ","wp-marketing-automations")+e.stock_quantity,e.stock_status].filter(Boolean).join(" | ");return Object(r.createElement)("tr",null,Object(r.createElement)("td",null,Object(r.createElement)("div",{className:"bwf-c-product-modal-row"},Array.isArray(e.images)&&e.images.length>0&&Object(r.createElement)("img",s({className:"bwf-c-product-modal-image"},e.images[0])),Object(r.createElement)("div",{className:"bwf-c-product-modal-row-info"},Object(r.createElement)("span",{className:"bwf-tag-label"},e.name," ",Object(r.createElement)("span",{className:"bwf-c-product-id"},"#",e.id)),Object(r.createElement)("span",{className:"bwf-tag-slug"},t)))),Object(r.createElement)("td",null,Object(r.createElement)("span",{className:"bwf-tag-item-select",onClick:function(){return!!n&&n(e)}},Object(l.__)("Select","wp-marketing-automations-crm"))))}))))},f=n(5),d=n(16),p=n.n(d),g=n(32),O=n(798);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t,n,r,a,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}var v=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,r,a,o,c,i,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.queryKey,(r=y(n,2))[0],a=r[1],o=a.search,c=a.limit,i=a.offset,l={search:o,per_page:c,page:parseInt(i/c)+1,orderby:"popularity"},e.next=5,p()({path:Object(g.addQueryArgs)("/wc-analytics/products",l),parse:!1});case 5:return u=e.sent,e.next=8,u.json();case 8:return e.t0=e.sent,e.t1=parseInt(u.headers.get("x-wp-total"),10),e.abrupt("return",{products:e.t0,totalCount:e.t1});case 11:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){w(o,r,a,c,i,"next",e)}function i(e){w(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}(),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(O.a)(["wc-products",{search:e,limit:t,offset:n}],v,{staleTime:6e4})};n(554);function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a=function(e){var t=e.onProductSelected,n=e.onRequestClose,c=E(Object(r.useState)(""),2),i=c[0],u=c[1],s=E(Object(r.useState)(10),2),d=s[0],p=s[1],g=E(Object(r.useState)(0),2),O=g[0],y=g[1],j=Object(r.useCallback)(Object(f.debounce)((function(e){return u(e)}),700),[]),w=h(i,d,O),v=w.isLoading,_=w.data,S=(_=void 0===_?{}:_).products,k=void 0===S?[]:S,C=_.totalCount,P=void 0===C?0:C,N=w.error,T=w.isError,x=w.isSuccess;return Object(r.createElement)(a.Modal,{title:Object(l.__)("Select a Product","wp-marketing-automations-crm"),onRequestClose:function(){return!!n&&n()},className:"bwf-crm-products-model bwf-admin-modal bwf-admin-modal-xl bwf-admin-modal-no-header bwf-show-close"},Object(r.createElement)("div",{className:"bwf-products-header"},Object(r.createElement)("div",{className:"bwf-products-label bwf-h3"},Object(l.__)("Products","wp-marketing-automations-crm")),Object(r.createElement)(a.TextControl,{className:"bwf-products-search",onChange:function(e){return j(e)},placeholder:Object(l.__)("Search product","wp-marketing-automations-crm")})),Object(r.createElement)("div",{className:"bwf-merge-tab"},Object(r.createElement)("div",{className:"bwf-products-list"},v&&Object(r.createElement)(m,null),T&&Object(r.createElement)(a.Notice,{status:"error"},N),x&&Array.isArray(k)&&0===k.length&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-t-center"},Object(l.__)("No Products Available","wp-marketing-automations-crm")),x&&Array.isArray(k)&&k.length>0&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(b,{products:k,onProductSelected:t}),Object(r.createElement)(o.a,{page:parseInt(O/d)+1,onPageChange:function(e){return y((e-1)*d)},perPage:d,onPerPageChange:function(e){return p(e)},total:P,showPagePicker:!0,showPerPagePicker:!0,showPageArrowsLabel:!0})))))}},553:function(e,t,n){},554:function(e,t,n){},555:function(e,t,n){},556:function(e,t,n){},557:function(e,t,n){"use strict";var r=n(0),a=n(9),o=n(4),c=n(332),i=n(7),l=n(5),u=n(485),s=n(109),m=function(e){if(!e||!e.editor||!e.editor.design)return!1;var t=JSON.parse(e.editor.design);return!!t&&!!t.body&&Array.isArray(t.body.rows)&&t.body.rows.length>0},b=function(e){var t=Object(r.useCallback)((function(t){return t&&e&&e[t]?e[t]:null}),[e]),n=e.mode;return{getEmailContent:function(){var e=parseInt(t("currentEmail")),n=t("data");return n&&e in n?n[e]:{}},getCurrentEmail:function(){return parseInt(t("currentEmail"))},getEmails:function(){return t("emails")},getAllEmailContent:function(){return t("data")},getShowValidationFlag:function(){return t("showValidation")},emailsValidToSubmit:function(){var e=t("data");return!!t("emails").map((function(t){var r=e[t];if(!r)return!1;var a=!!r.utmEnabled,o=r.utm?r.utm:{},c={subject:1!==n||r.subject&&r.subject.length>0,content:"editor"!==r.type?r.body&&r.body.length>0:m(r),type:1!==n||r.type&&r.type.length>0,utmSource:!a||o.source&&o.source.length>0,utmMedium:!a||o.medium&&o.medium.length>0};return!!Object.keys(c).map((function(e){return c[e]})).reduce((function(e,t){return e&&t}),!0)})).reduce((function(e,t){return e&&t}),!0)&&e},getValidEmails:function(){var e=t("data"),r=t("emails"),a={};return r.map((function(t){var r=e[t];if(r){var o=!!r.utmEnabled,c=r.utm?r.utm:{},i={subject:1!==n||r.subject&&r.subject.length>0,content:"editor"!==r.type?r.body&&r.body.length>0:m(r),type:1!==n||r.type&&r.type.length>0,utmSource:!o||c.source&&c.source.length>0,utmMedium:!o||c.medium&&c.medium.length>0};a[t]=!!Object.keys(i).map((function(e){return i[e]})).reduce((function(e,t){return e&&t}),!0)}})),a},getEmailsToSubmit:function(){var e=t("data");return t("emails").map((function(t){var n=e[t];return n||!1})).filter(Boolean)},getCurrentEmailIndex:function(){var e=parseInt(t("currentEmail")),n=t("emails");return Array.isArray(n)&&n.includes(e)?n.indexOf(e):1},validateCurrentEmail:function(){var e=t("data"),r=parseInt(t("currentEmail"));if(!e||!e[r])return!1;var a=e[r];if(a){var o=!!a.utmEnabled,c=a.utm?a.utm:{};return{subject:1!==n||a.subject&&a.subject.length>0,content:"editor"!==a.type?a.body&&a.body.length>0:m(a),type:1!==n||a.type&&a.type.length>0,utmSource:!o||c.source&&c.source.length>0,utmMedium:!o||c.medium&&c.medium.length>0}}},getSmartSendSettings:function(){return t("smartSend")},getSaveContentStatus:function(){return t("saveContentStatus")},getSendTestEmailStatus:function(){return t("sendTestEmailStatus")},getUploadImageStatus:function(){return t("uploadImageStatus")},getUploadImageURL:function(){return t("uploadImageURL")},getFromEmail:function(){return t("from_email")},getFromName:function(){return t("from_name")},getReplyTo:function(){return t("reply_to")},getMode:function(){return t("mode")},getABType:function(){return t("ab_type")},getObjectId:function(){return t("objectId")},getMergeTagsContext:function(){return t("mergeTagsContext")}}};function f(e,t,n,r,a,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){f(o,r,a,c,i,"next",e)}function i(e){f(o,r,a,c,i,"throw",e)}c(void 0)}))}}function p(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e,t,n){var a,c,i,u,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{sendTestEmail:function(){},saveEditorContent:function(){},uploadImage:function(){},fetchCurrentMailEditorContent:function(){}},m=Object(r.useCallback)((function(t){e(n.setStateProps(t))}),[e,n]),b=t.getAllEmailContent,f=t.getCurrentEmail,g=t.getEmails,O=t.getSmartSendSettings,w=t.getEmailContent,v=t.getEmailsToSubmit,h=b(),E=f(),_=g(),S=O(),k=w(),C=v(),P=function(e){return"type"in e?e:y(y({},e),{},{type:"rich"})};return{setEmailContentByKey:function(e,t){var n=P(E in h?y(y({},h[E]),{},j({},e,t)):j({},e,t)),r=y(y({},h),{},j({},E,n));m({data:r})},setEmailUtmByKey:function(e,t){var n=P(E in h?y({},h[E]):{}),r="utm"in n?y(y({},n.utm),{},j({},e,t)):j({},e,t),a=y(y({},h),{},j({},E,y(y({},n),{},{utm:y(y({},r),{},j({},e,t))})));m({data:a})},setMultipleUtm:function(e){if(e){var t=P(E in h?y({},h[E]):{}),n=y(y({},h),{},j({},E,y(y({},t),{},{utm:y(y({},t.utm),e)})));m({data:n})}},setCurrentEmail:function(e){_.includes(e)&&m({currentEmail:e})},addEmail:function(){if(Array.isArray(_)&&_.length<3){var e=Math.max.apply(Math,p(_))+1;m({emails:[].concat(p(_),[e]),currentEmail:e,showValidation:!1,data:y(y({},h),{},j({},e,_[0]in h?h[_[0]]:{}))})}},showValidation:function(e){return m({showValidation:e})},deleteEmail:function(e){if(_.length>1){var t=_.filter((function(t){return t!==e}));m({emails:t,currentEmail:t[t.length-1]})}},initContent:function(e,t){if(Array.isArray(e)&&0!==Object(l.size)(e)){var n={};for(var r in e){var a=parseInt(r)+1;n[a]=h[a]?y(y({},P(h[a])),e[r]):e[r]}var c={data:n,emails:Object.keys(n).map((function(e){return parseInt(e)}))};t&&0!==Object.keys(t).length&&(c.smartSend=t),m(c)}else m({data:{1:{body:Object(o.__)("Hi","wp-marketing-automations-crm")+" {{contact_first_name}}"}},emails:[1],currentEmail:1})},fetchCurrentMailEditorContent:(u=d(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m({isLoading:!0}),e.next=3,s.fetchCurrentMailEditorContent();case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:m({isLoading:!1,data:y(y({},h),{},j({},E,y(y({},h[E]?h[E]:{}),{},{editor:t})))});case 7:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)}),sendTestEmail:(i=d(regeneratorRuntime.mark((function e(t,n){var r,a,o,c,i,l,u,b,f,d,p,g,O,y,j=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=j.length>2&&void 0!==j[2]?j[2]:"",a=j.length>3&&void 0!==j[3]?j[3]:"",o=j.length>4&&void 0!==j[4]?j[4]:"",c="",i="",l="rich",u="",k&&(b=k.body?k.body:"",f=k.editor?k.editor:{},d=f.body?f.body:"",l=k.type?k.type:l,c="editor"===l?d:b,i=k.subject?k.subject:"",u=k.preheader?k.preheader:""),p=a||c,g=r||i,O=o||l,m({sendTestEmailStatus:1}),e.next=14,s.sendTestEmail(t,g,p,O,n,u);case 14:y=e.sent,m({sendTestEmailStatus:parseInt(y)});case 16:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)}),setSmartSendByKey:function(e,t){return m({smartSend:y(y({},S),{},j({},e,t))})},saveEmailContent:(c=d(regeneratorRuntime.mark((function e(t){var n,r,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m({saveContentStatus:1}),n=Array.isArray(t)&&t.length>0?t:C,e.next=4,s.saveEditorContent(n);case 4:r=e.sent,a={},n.map((function(e,t){a=P(E in h?y(y({},h[E]),{},j({},t,e)):j({},t,e))})),o=y(y({},h),{},j({},E,a)),m({data:o}),m({saveContentStatus:r});case 10:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)}),uploadImage:(a=d(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return m({uploadImageStatus:1}),e.next=5,s.uploadImage(t);case 5:n=e.sent,m({uploadImageStatus:n?2:3,uploadImageURL:n});case 7:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),resetSaveContentStatus:function(){return m({saveContentStatus:null})},resetSendTestEmailStatus:function(){return m({sendTestEmailStatus:null})},overrideCurrentContent:function(e){var t=P(E in h?y({},h[E]):{}),n=y(y({},h),{},j({},E,y(y({},t),e)));m({data:n})},resetUploadImageStatus:function(){m({uploadImageStatus:null,uploadImageURL:""})},setFromEmail:function(e){return m({from_email:e})},setFromName:function(e){return m({from_name:e})},setReplyTo:function(e){return m({reply_to:e})},setMode:function(e){return m({mode:e})}}};function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k={mode:1,data:{1:{body:Object(o.__)("Hi","wp-marketing-automations-crm")+" {{contact_first_name}}"}},currentEmail:1,emails:[1],showValidation:!1,from_name:Object(i.r)("from_name"),from_email:Object(i.r)("from_email"),reply_to:Object(i.r)("reply_to_email"),ab_type:"standard",objectId:"",smartSend:{enable:!1,percent:15,hours:3},saveContentStatus:null,sendTestEmailStatus:null,uploadImageStatus:null,uploadImageURL:"",mergeTagsContext:""},C={setStateProps:function(e){return{type:"setStateProps",payload:e}}},P=function(e,t){if(!t||!t.type)return e;switch(t.type){case"setStateProps":if(t.payload)return _(_({},e),t.payload)}return e},N=Object(r.createContext)(),T=function(e,t){var n,a=v(Object(r.useReducer)(P,k,(n=e,function(e){if(!n)return e;var t=!n.ab_type||"ab"===n.ab_type,r=n.content?n.content:[];r=Array.isArray(r)&&!t?[r[0]]:r;var a,o=n.smart_send&&t?n.smart_send:{},c={};if(Array.isArray(r)&&0!==Object(l.size)(r))for(var i in r)c[parseInt(i)+1]=_({},"type"in(a=r[i])?a:_(_({},a),{},{type:"rich"}));return _(_({},e),{},{data:_(_({},e.data),c),emails:Object.keys(_(_({},e.data),c)).map((function(e){return parseInt(e)})),smartSend:_(_({},e.smartSend),{},{sendSmartData:o}),from_name:n&&n.from_name?n.from_name:e.from_name,from_email:n&&n.from_email?n.from_email:e.from_email,reply_to:n&&n.reply_to?n.reply_to:e.reply_to,ab_type:n.ab_type?n.ab_type:e.ab_type,objectId:n.objectId?n.objectId:e.objectId,mergeTagsContext:n.mergeTagsContext?n.mergeTagsContext:e.mergeTagsContext})})),2),o=a[0],c=a[1],i=b(o);return[i,w(c,i,C,t)]};function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},R=function(e){var t=Object(r.useContext)(N),n=t.selectors,a=t.dispatchers.sendTestEmail,o=(0,n.getSendTestEmailStatus)(),c=x(Object(r.useState)("http://app.getautonami.com"),2),i=c[0],l=c[1],u=Object(r.useRef)();Object(r.useEffect)((function(){u.current=e}),[e]);var s=function(t){if(-1!==t.origin.indexOf("app.getautonami.com")&&t.data&&t.data.action&&"send_test_email"===t.data.action&&t.data.token===I.editor_nonce&&t.data.data){var n=t.data.data,r=n.email,o=n.body,c=n.subject;r&&o&&c&&(l(t.origin),a(r,e,c,o))}};return Object(r.useEffect)((function(){return window.addEventListener("message",s),function(){return window.removeEventListener("message",s)}}),[]),Object(r.useEffect)((function(){if(o&&1!==o){var e=2===o,t=document.getElementById("bwf_email_editor_frame");t&&t.contentWindow.postMessage({token:I.editor_nonce,action:"send_test_email",data:{isSent:e}},i)}}),[o]),!0};function M(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||B(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||B(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){if(e){if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var L=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},U=function(e){var t=Object(r.useContext)(N),n=t.selectors,a=t.dispatchers.saveEmailContent,o=n.getSaveContentStatus,c=n.getEmailsToSubmit,i=n.getCurrentEmailIndex,l=o(),u=c(),s=i(),m=Object(r.useRef)(u),b=Object(r.useRef)(s);Object(r.useEffect)((function(){m.current=u,b.current=s}),[u,s]);var f=F(Object(r.useState)("http://app.getautonami.com"),2),d=f[0],p=f[1],g=function(e){if(-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"save_design"===e.data.action&&e.data.token===L.editor_nonce&&e.data.data){var t=e.data.data,n=t.body,r=t.design;if(n&&r){p(e.origin);var o=M(u);o[s].editor={body:n,design:r},a(o)}}};return Object(r.useEffect)((function(){return window.addEventListener("message",g),function(){return window.removeEventListener("message",g)}}),[]),Object(r.useEffect)((function(){if(l&&1!==l&&e){var t=2===l,n=document.getElementById("bwf_email_editor_frame");n&&n.contentWindow.postMessage({token:L.editor_nonce,action:"save_design",data:{isSaved:t}},d)}}),[l]),!0};function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},z=function(){var e=V(Object(r.useState)("http://app.getautonami.com"),2),t=e[0],n=e[1],a=function(e){-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"wp_image_upload"===e.data.action&&e.data.token===$.editor_nonce&&e.data.data&&(n(e.origin),s())},c=Object(r.useRef)(),i=V(Object(r.useState)(""),2),l=i[0],u=i[1],s=function(){if(!wp||!wp.media)return"";c.current||(c.current=wp.media({title:Object(o.__)("Select or Upload Media","wp-marketing-automations-crm"),button:{text:"Select Image"},multiple:!1}),c.current.on("select",(function(){var e=c.current.state().get("selection").first().toJSON();u(e.url)}))),c.current.open()};return Object(r.useEffect)((function(){return window.addEventListener("message",a),function(){return window.removeEventListener("message",a)}}),[]),Object(r.useEffect)((function(){if(l){var e=document.getElementById("bwf_email_editor_frame");e&&e.contentWindow.postMessage({token:$.editor_nonce,action:"wp_image_upload",data:{isUploaded:!0,imageURL:l}},t)}}),[l]),!0},K=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},W=function(e){var t=Object(r.useContext)(N).selectors.getEmailContent(),n=Object(r.useRef)(),a=Object(r.useRef)();Object(r.useEffect)((function(){n.current=t,a.current=function(e){var t={};for(var n in e){var r=e[n];if(r){var a={};for(var o in r)a[o]={name:r[o],value:"{{".concat(o,"}}")};var c="";switch(n){case"contact":c="Contact";break;case"contact_fields":c="Fields";break;case"general":c="General"}t[n]={name:c,mergeTags:a}}}return t}(e)}),[t,e]);var o=function(e){if(-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"get_design"===e.data.action&&e.data.token===K.editor_nonce){var t=n.current&&n.current.editor&&n.current.editor.design?n.current.editor.design:"",r=document.getElementById("bwf_email_editor_frame");r&&r.contentWindow.postMessage({token:K.editor_nonce,action:"get_design",data:{gotDesign:!0,json:t,subject:n.current&&n.current.subject?n.current.subject:"",mergeTags:a.current}},e.origin)}};return Object(r.useEffect)((function(){return window.addEventListener("message",o),function(){return window.removeEventListener("message",o)}}),[]),!0},H=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},G=function(e){var t=function(t){-1!==t.origin.indexOf("app.getautonami.com")&&t.data&&t.data.action&&"open_merge_tags"===t.data.action&&t.data.token===H.editor_nonce&&t.data.data&&e&&e()};return Object(r.useEffect)((function(){return window.addEventListener("message",t),function(){return window.removeEventListener("message",t)}}),[]),!0},J=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},Q=function(e){var t=function(t){-1!==t.origin.indexOf("app.getautonami.com")&&t.data&&t.data.action&&"close_editor"===t.data.action&&t.data.token===J.editor_nonce&&t.data.data&&e&&e()};return Object(r.useEffect)((function(){return window.addEventListener("message",t),function(){return window.removeEventListener("message",t)}}),[]),!0},X=n(13);function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ee=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},te=function(){return Object(r.createElement)("div",{className:"bwf-c-save-content-loading"},Object(r.createElement)(s.a,null),Object(r.createElement)("h3",null,Object(o.__)("Loading Drag and Drop Builder","wp-marketing-automations-crm")))},ne=function(e){var t=e.iframeRef,n=e.editorSrc;return Object(r.createElement)("iframe",{ref:t,title:Object(o.__)("Email Editor","wp-marketing-automations"),src:n,id:"bwf_email_editor_frame",style:{width:"100%",height:"100%"}})},re=function(e){var t=Object(r.useContext)(N),n=t.selectors,c=t.dispatchers,i=Y(Object(r.useState)(!1),2),l=i[0],u=i[1],s=e.openMergeTags,m=e.mailData,b=e.mergeTags,f=ee.license,d=ee.editor_nonce,p=ee.url,g=c.fetchCurrentMailEditorContent,O=c.saveEmailContent,y=c.resetSaveContentStatus,j=n.getSaveContentStatus(),w=n.getObjectId(),v=Y(Object(r.useState)(!1),2),h=v[0],E=v[1];Object(r.useEffect)((function(){h||2!==j&&3!==j||(E(!0),y())}),[j]);var _=Object(r.useCallback)((function(){u(!1),g()}));W(b||[]),R(m),U(h),z(),G(s),Q(_);var S="//app.getautonami.com/get/".concat(f,"/").concat(d,"/").concat(p,"/").concat(w),k=Object(r.useRef)();return Object(r.useEffect)((function(){l?(O(),document.body.classList.add("bwf-c-modal-open")):(E(!1),document.body.classList.remove("bwf-c-modal-open"))}),[l]),Object(r.createElement)(r.Fragment,null,l&&Object(r.createElement)("div",{className:"bwf-c-editor-modal-wrapper"},Object(r.createElement)("div",{className:"bwf-c-editor-modal bwf-c-editor-modal-full-width"},!h&&Object(r.createElement)(te,null),!!h&&Object(r.createElement)(ne,{iframeRef:k,editorSrc:S}))),Object(r.createElement)("div",{className:"bwf-c-editor-button-wrapper"},Object(r.createElement)(X.a,{icon:"launch-editor",size:50}),Object(r.createElement)("div",{className:"bwf-h1"},"Launch Editor"),Object(r.createElement)("div",{className:"bwf-h5"},"Visually get email with drop & drop builder"),Object(r.createElement)(a.Button,{isSecondary:!0,onClick:function(){return u(!0)}},Object(o.__)("Start","wp-marketing-automations-crm"))))},ae=n(516),oe=n(224),ce=n(16),ie=n.n(ce);function le(e,t,n,r,a,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}function ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var me=function(e){var t=e.setPreview,n=e.content,c=e.type,l=ue(Object(r.useState)(""),2),u=l[0],m=l[1],b=ue(Object(r.useState)(!0),2),f=b[0],d=b[1];Object(r.useEffect)((function(){p()}),[]);var p=function(){var e,t=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=4;break}return m(""),d(!1),e.abrupt("return");case 4:return e.prev=4,e.next=7,ie()({path:Object(i.g)("/broadcast/email-preview"),method:"POST",data:{content:n,type:c}}).then((function(e){m(e.result.body.replace(/\\/g,"")),d(!1)}));case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:case"end":return e.stop()}}),e,null,[[4,9]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){le(o,r,a,c,i,"next",e)}function i(e){le(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(r.createElement)(a.Modal,{title:Object(o.__)("Preview","wp-marketing-automations-crm"),onRequestClose:function(){return t(!1)},className:"bwf-admin-modal bwf-admin-modal-xxxl"},f?Object(r.createElement)(s.a,null):Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:u}}))},be=(n(478),n(517)),fe=n(520),de=n(124);function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){Oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return je(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return je(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var we=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},ve=function(){var e=ye(Object(r.useState)(!1),2),t=e[0],n=e[1],a=ye(Object(r.useState)(!1),2),o=a[0],c=a[1],l=Object(de.a)(Object(i.H)()).formatAmount,u=Object(r.useCallback)((function(e){var t=document.getElementById("bwf_email_editor_frame");t&&t.contentWindow.postMessage({token:we.editor_nonce,action:"select_product_for_tool",data:{product:ge(ge({},e),{},{formattedPrice:l(e.price)})}},o),n(!1)}),[o]),s=Object(r.useCallback)((function(e){-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"select_product_for_tool"===e.data.action&&e.data.token===we.editor_nonce&&(c(e.origin),n(!0))}),[n]);return Object(r.useEffect)((function(){return window.addEventListener("message",s),function(){return window.removeEventListener("message",s)}}),[]),t&&Object(r.createElement)(fe.a,{onRequestClose:function(){return n(!1)},onProductSelected:u})};function he(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ee(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _e=Object(i.I)(),Se=[{label:Object(o.__)("Text","wp-marketing-automations-crm"),value:"rich",templateIcon:"rich-text",className:"bwf-display-flex bwf-campaign-template-type "},_e.includes("wc")&&{label:Object(o.__)("WooCommerce","wp-marketing-automations-crm"),value:"wc",templateIcon:"woocommerce",className:"bwf-display-flex bwf-campaign-template-type "},{label:Object(o.__)("HTML","wp-marketing-automations-crm"),value:"html",templateIcon:"html",className:"bwf-display-flex bwf-campaign-template-type"},{label:Object(o.__)("Drag and Drop","wp-marketing-automations-crm"),value:"editor",templateIcon:"html",className:"bwf-display-flex bwf-campaign-template-type"}].filter(Boolean),ke={rich:Object(o.__)("Text","wp-marketing-automations-crm"),wc:Object(o.__)("WooCommerce","wp-marketing-automations-crm"),html:Object(o.__)("HTML","wp-marketing-automations-crm"),editor:Object(o.__)("Drag and Drop","wp-marketing-automations-crm")},Ce=function(e){var t=e.showSaveTemplate,n=e.showTypeSelector,s=Object(r.useContext)(N),m=s.selectors,b=s.dispatchers,f={senders_email:m.getFromEmail(),senders_name:m.getFromName(),reply_to:m.getReplyTo()},d=m.getObjectId(),p=m.getMergeTagsContext(),g=parseInt(m.getMode()),O=Object(i.j)(),y=b.setEmailContentByKey,j=b.setEmailUtmByKey,w=b.setMultipleUtm,v=b.sendTestEmail,h=b.resetSendTestEmailStatus,E=m.getEmailContent()?m.getEmailContent():{},_="utm"in E?E.utm:{},S=he(Object(r.useState)(!1),2),k=S[0],C=S[1],P=he(Object(r.useState)(""),2),T=P[0],x=P[1],A="subject"in E?E.subject:"",I="preheader"in E?E.preheader:"",R="type"in E?E.type:"rich",M="utmEnabled"in E&&E.utmEnabled,F=he(Object(r.useState)({message:"",type:1}),2),B=F[0],D=F[1],L="source"in _?_.source:"",U="medium"in _?_.medium:"",V="name"in _?_.name:"",q="content"in _?_.content:"",$="term"in _?_.term:"",z=he(Object(r.useState)(!1),2),K=z[0],W=z[1],H=m.getShowValidationFlag(),G=he(Object(r.useState)(!1),2),J=G[0],Q=G[1],X=he(Object(r.useState)("content"),2),Y=X[0],Z=X[1],ee=he(Object(r.useState)([]),2),te=ee[0],ne=ee[1],ce=m.getCurrentEmailIndex(),ie=E&&E.body?E.body:"",le="editor"in E?E.editor:{},ue=le&&le.body?le.body:"",se="editor"===R?ue:ie;Object(r.useEffect)((function(){if(M){var e={};!L&&(e.source=Object(o.__)("newsletter","wp-marketing-automations-crm")),!U&&(e.medium=O[g].label.toLowerCase()),w(e)}}),[M]);var fe=m.validateCurrentEmail(),de=1===g?Object(o.__)("Place your HTML here","wp-marketing-automations-crm"):Object(o.__)("Enter the SMS body","wp-marketing-automations-crm"),pe=function(){return"editor"==E.type?E.hasOwnProperty("editor")&&E.editor.hasOwnProperty("body")?E.editor.body:E.hasOwnProperty("editor")&&E.editor.hasOwnProperty("editor")?E.editor.editor:"":E.body},ge=m.getSendTestEmailStatus();Object(r.useEffect)((function(){null!==ge&&setTimeout((function(){h(),D({message:"",type:1})}),2e3),2===ge&&D({message:Object(o.__)("Test mail sent successfully.","wp-marketing-automations-crm"),type:1}),3===ge&&D({message:Object(o.__)("Test mail failed to send","wp-marketing-automations-crm"),type:1})}),[ge]);var Oe=H&&!fe.subject?" bwf-field-error":"",ye=H&&!fe.content?" bwf-field-error-textarea":"",je=H&&!fe.utmSource?" bwf-field-error":"",we=H&&!fe.utmMedium?" bwf-field-error":"";return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-c-campaign-body"},1===g&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(a.TextControl,{value:A,onChange:function(e){return y("subject",e)},label:Object(o.__)("Subject","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter Subject","wp-marketing-automations-crm"),className:"bwf-field-m0"+Oe}),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-campaign-mail-headers-wrap"},Object(r.createElement)(a.TextControl,{value:I,placeholder:Object(o.__)("Enter Preview Text","wp-marketing-automations-crm"),label:Object(o.__)("Preview Text","wp-marketing-automations-crm"),onChange:function(e){return y("preheader",e)}})),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.Flex,{align:"flex-end"},Object(r.createElement)(a.FlexBlock,null,n?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-p"},Object(o.__)("Template Type","wp-marketing-automations-crm")),Object(r.createElement)("div",null,Object(r.createElement)(a.ButtonGroup,null,Se.map((function(e){return Object(r.createElement)(a.Button,{key:e.value,isPrimary:R&&e.value==R,isSecondary:R&&e.value!=R,onClick:function(){return y("type",e.value)}},e.label)}))))):Object(r.createElement)("div",{className:"bwf-p"},Object(o.__)("Template Type","wp-marketing-automations-crm")," ",":"," ",ke.hasOwnProperty(R)?ke[R]:ke.rich)),"editor"!==R&&Object(r.createElement)(a.FlexItem,null,Object(r.createElement)(a.Button,{isSecondary:!0,className:"bwf-big-button",onClick:function(){Z("content"),Q(!0)}},Object(o.__)("Merge Tags","wp-marketing-automations-crm"))))),Object(r.createElement)("div",{className:"bwf_clear_15"}),Object(r.createElement)("div",{className:ye},1===g&&("rich"===R||"wc"===R)&&Object(r.createElement)(u.a,{content:se,keyid:"bwf-campaign-email-editor",setContent:function(e){return y("body",e)}}),("html"===R||2===g)&&Object(r.createElement)(a.TextareaControl,{value:se,onChange:function(e){return y("body",e)},placeholder:de,rows:2===g?5:30}),"editor"===R&&Object(r.createElement)(re,{objectId:d,contentNumber:parseInt(ce),openMergeTags:function(){return Q(!0)},mailData:f,mergeTags:te})),Object(r.createElement)("div",{className:"bwf_clear_20"}),"editor"!==R&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexItem,null,Object(r.createElement)("a",{isTertiary:!0,className:"bwf-a-no-underline",onClick:function(e){e.preventDefault(),Z("content");var t=2===g?bwfanParams.bwfan_global_settings.bwfan_sms_unsubscribe_text:bwfanParams.bwfan_global_settings.bwfan_email_footer_setting;y("body","".concat(se||""," \n").concat(t))}},Object(o.__)("Add Unsubscribe Text","wp-marketing-automations-crm")))),Object(r.createElement)("div",{className:"bwf_clear_20"})),Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexItem,null,1==g&&Object(r.createElement)(r.Fragment,null,t&&Object(r.createElement)(be.a,{templateData:E,type:1}),Object(r.createElement)(a.Button,{className:t?"bwf-ml-5":" bwf-big-button",isSecondary:!0,onClick:function(){C(!0)}},Object(o.__)("Send Test Email","wp-marketing-automations-crm"),k&&Object(r.createElement)(a.Popover,{onFocusOutside:function(){C(!1)},onClick:function(e){return e.stopPropagation()},className:"bwf-crm-mail-comp-test-mail"},Object(r.createElement)("div",{className:"bwf-campaign-test-mail-wrap"},Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)("div",{className:"bwf-p"},Object(r.createElement)(a.TextControl,{value:T,onChange:function(e){return x(e)},placeholder:Object(o.__)("Enter email","wp-marketing-automations-crm")})),Object(r.createElement)(a.Button,{isPrimary:!0,className:"bwf-big-button",onClick:function(e){if(e.preventDefault(),n=!1,!Object(l.isEmpty)(T)&&Object(c.a)(T)&&fe.subject&&fe.content&&fe.type&&fe.utmMedium&&fe.utmSource||(n=!0),n){var t="";Object(l.isEmpty)(T)&&(t=Object(o.__)("Email is required field.","wp-marketing-automations-crm")),Object(l.isEmpty)(t)&&!Object(c.a)(T)&&(t=Object(o.__)("Entered email is not valid.","wp-marketing-automations-crm")),Object(l.isEmpty)(t)&&!fe.subject&&(t=Object(o.__)("Subject is required field.","wp-marketing-automations-crm")),Object(l.isEmpty)(t)&&!fe.content&&(t=Object(o.__)("Mail content is required field.","wp-marketing-automations-crm")),D({message:t,type:2})}else v(T,f);var n}},Object(o.__)("Send mail","wp-marketing-automations-crm"))))),Object(r.createElement)(a.Button,{isSecondary:!0,className:"bwf-ml-5 bwf-big-button",onClick:function(){Object(l.isEmpty)(pe())?D({message:"No content available for preview.",status:2}):W(!0)}},Object(o.__)("Show Preview","wp-marketing-automations-crm")),K&&Object(r.createElement)(me,{setPreview:W,content:pe(),type:R})))),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.CheckboxControl,{checked:M,label:Object(o.__)("Automatically append UTM parameters to email links","wp-marketing-automations-crm"),className:"bwf-crm-campaign-third-step-utm",onChange:function(e){return y("utmEnabled",e)}}),M&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)("div",{className:"bwf-campaign-utm-section"},Object(r.createElement)(a.TextControl,{value:L,onChange:function(e){return j("source",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Source","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM source","wp-marketing-automations-crm"),help:Object(o.__)("Referrer: (e.g., google, newsletter)","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"+je}),Object(r.createElement)(a.TextControl,{value:U,onChange:function(e){return j("medium",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Medium","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM medium","wp-marketing-automations-crm"),help:Object(o.__)("Marketing medium: (e.g., CPC, banner, email)","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"+we}),Object(r.createElement)(a.TextControl,{value:V,onChange:function(e){return j("name",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Name","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM name","wp-marketing-automations-crm"),help:Object(o.__)("Product, promo code, or slogan (e.g., spring_sale)","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"}),Object(r.createElement)(a.TextControl,{value:$,onChange:function(e){return j("term",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Term","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM term","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"}),Object(r.createElement)(a.TextControl,{value:q,onChange:function(e){return j("content",e.toLowerCase().replace(/\s/g,"-"))},label:Object(o.__)("Campaign Content","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter UTM content","wp-marketing-automations-crm"),className:"bwf-field-comp-label-content"}))),Object(r.createElement)(oe.a,{message:B.message,type:B.type,removeMessage:function(){return D({message:"",type:1})}})),Object(r.createElement)(ae.a,{isOpen:J,setOpenTags:Q,onMergeTagSelected:function(e){"subject"===Y&&y("subject","".concat(A||""," ").concat(e)),"content"===Y&&y("body","".concat(se||""," ").concat(e)),Q(!1)},onMergeTagsLoaded:function(e){return ne(e)},context:p}),Object(i.W)()&&Object(r.createElement)(ve,null))},Pe=n(15),Ne=n.n(Pe),Te=(n(555),n(117)),xe=function(){var e=Object(r.useContext)(N),t=e.selectors,n=e.dispatchers,c=t.getSmartSendSettings(),i=c.enable,l=c.percent,u=c.hours,s=n.setSmartSendByKey,m=t.getShowValidationFlag(),b=t.getEmails();return Array.isArray(b)&&b.length>1?Object(r.createElement)(a.Card,{className:"bwf-c-campaign-email"},Object(r.createElement)("div",{className:"bwf-h4"},Object(o.__)("Smart Sending","wp-marketing-automations-crm")),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.ToggleControl,{label:Object(o.__)("Enable Smart Sending","wp-marketing-automations-crm"),className:"bwf-tooglecontrol-advance",checked:i,onChange:function(e){return s("enable",e)}}),i&&parseInt(l)>0&&parseInt(u)>0&&Object(r.createElement)("div",null,Object(o.sprintf)(Object(o.__)("This broadcast will be sent to %d percent of your contacts. After %d hours, open rates of all the variants would be analyzed and the one with the most opens would be sent to the remaining contacts.","wp-marketing-automations-crm"),parseInt(l),parseInt(u))),i&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(a.TextControl,{type:"number",value:l,onChange:function(e){return s("percent",e)},label:Object(o.__)("Sample size (in percent)","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter percent","wp-marketing-automations-crm"),className:Ne()({"bwf-field-comp-label-content":!0,"bwf-field-error":m&&!parseInt(l)})}),Object(r.createElement)(a.TextControl,{type:"number",value:u,onChange:function(e){return s("hours",e)},label:Object(o.__)("Wait time (in hours)","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter hour difference","wp-marketing-automations-crm"),className:Ne()({"bwf-field-comp-label-content":!0,"bwf-field-error":m&&!parseInt(u)})}))):null},Ae="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Ie=function(e){var t=e.showSaveTemplate,n=e.showTypeSelector,c=Object(r.useContext)(N),i=c.selectors,l=c.dispatchers,u=l.setCurrentEmail,s=l.addEmail,m=l.showValidation,b=l.deleteEmail,f=i.getEmails(),d=i.getCurrentEmail(),p=i.getSmartSendSettings(),g=i.emailsValidToSubmit(),O=i.getShowValidationFlag(),y=i.getValidEmails(),j=i.getABType(),w=!j||"ab"===j,v=Object(r.useRef)(!1),h=Object(r.useCallback)((function(e){return Ne()({active:d===e,"bwf-error-tab":!y[e]&&O})})),E=!![!p.enable||!!parseInt(p.hours)&&f.length>1,!p.enable||!!parseInt(p.percent)&&f.length>1].reduce((function(e,t){return e&&t}),!0);return Object(r.createElement)(r.Fragment,null,(!g||!E)&&O&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Te.a,null),Object(r.createElement)(a.Notice,{className:"bwf-error-notice",status:"error",onRemove:function(){return m(!1)}},Object(o.__)("Some required fields are not filled, check below","wp-marketing-automations-crm"))),w&&Object(r.createElement)("div",{className:"bwf-c-campaign-email-tabs"},Object(r.createElement)("ul",null,f.map((function(e,t){return Object(r.createElement)("li",{onClick:function(){return function(e){!v.current&&u(e),v.current=!1}(e)},className:h(e)},Object(o.__)(0===t?"Control ":"Variant ","wp-marketing-automations-crm")," ",t>0&&Ae[parseInt(t)%Ae.length-1],t>0&&Object(r.createElement)(a.Button,{icon:"no",onClick:function(){return function(e){v.current=!0,b(e)}(e)}}))})),f.length<3&&Object(r.createElement)("li",{className:"bwf-c-campaign-email-variant"},Object(r.createElement)(a.Button,{icon:"plus",onClick:function(){return s()}},Object(o.__)("Add Variant","wp-marketing-automations-crm"))))),Object(r.createElement)(Ce,{showSaveTemplate:t,showTypeSelector:n}),Object(r.createElement)(xe,null))},Re=n(518);function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){Be(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function De(e,t,n,r,a,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}function Le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ue(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a=function(e){var t=e.onEmailContentReady,n=e.onEmailContentError,u=e.initData,s=e.disableDefaultButtons,m=void 0!==s&&s,b=e.validateEmailContent,f=void 0!==b&&b,d=e.setPending,p=void 0===d?function(){}:d,g=e.apiMethods,O=void 0===g?{}:g,y=e.showSenderInfo,j=void 0===y||y,w=e.showTemplateTypeSelector,v=void 0===w||w,h=e.showSaveTemplate,E=void 0===h||h,_=e.returnData,S=void 0!==_&&_,k=e.showTab,C=void 0===k||k,P=e.setMailData,x=Le(T(u||{},O),2),A=x[0],I=x[1],R=A.getFromName(),M=A.getFromEmail(),F=A.getReplyTo(),B=parseInt(A.getMode()),D={name:1!==B||null===R||R.length>0,email:1!==B||null===M||Object(c.a)(M)};if(S){var L=A.getAllEmailContent();Object(r.useEffect)((function(){P(L)}),[L])}var U=A.emailsValidToSubmit(),V=A.getEmails(),q=A.getSmartSendSettings(),$=!![1!==B||R&&R.length>0,1!==B||M&&Object(c.a)(M),1!==B||Object(l.isEmpty)(F)||F&&Object(c.a)(F)].reduce((function(e,t){return e&&t}),!0),z=!![!q.enable||!!parseInt(q.hours)&&V.length>1,!q.enable||!!parseInt(q.percent)&&V.length>1].reduce((function(e,t){return e&&t}),!0),K=function(){var e,r=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:I.showValidation(!1),$&&U&&z?(p&&p(!0),t&&t(Fe({content:V.map((function(e){return U[e]})),from_name:R,from_email:M,reply_to:F,modified_by:Object(i.n)()},q.enable?{smart_send:{enable:q.enable,percent:q.percent,hours:q.hours}}:{})),p&&p(!1)):(n&&n(),I.showValidation(!0));case 2:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){De(o,r,a,c,i,"next",e)}function i(e){De(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(){return r.apply(this,arguments)}}();Object(r.useEffect)((function(){f&&K()}),[f]);var W=D&&!D.email?" bwf-field-error":"",H=D&&!D.name?" bwf-field-error":"",G=Object(r.useContext)(i.b);return Object(r.createElement)(N.Provider,{value:{selectors:A,dispatchers:I}},Object(r.createElement)("div",{className:"bwf-campaign-step-div bwf-campaign-step-3"},1===B&&j&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(a.Card,{className:"bwf-p-25"},Object(r.createElement)("div",{className:"bwf-c-campaign-email"},Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.TextControl,{value:R,onChange:I.setFromName,label:Object(o.__)("From Name","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter From Name","wp-marketing-automations-crm"),className:H}))),Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.TextControl,{value:M,onChange:I.setFromEmail,label:Object(o.__)("From Email","wp-marketing-automations-crm"),placeholder:Object(o.__)("Enter From Email","wp-marketing-automations-crm"),className:W}))),Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.TextControl,{value:F,placeholder:Object(o.__)("Enter Reply-To Email","wp-marketing-automations-crm"),label:Object(o.__)("Reply-To Email","wp-marketing-automations-crm"),onChange:I.setReplyTo}))))),Object(r.createElement)("div",{className:"bwf_clear_20"})),Object(r.createElement)("div",{className:"bwf-email-editor-wrap"},1===B&&C&&Object(r.createElement)("div",{className:"bwf-c-email-editor-tabs"},Object(r.createElement)("ul",{className:"bwf-h3"},Object(o.__)("Email Settings","wp-marketing-automations-crm")),Object(r.createElement)("span",{className:"bwf-c-campaign-template-selector"},Object(r.createElement)(Re.a,{applyTemplate:function(e){I.overrideCurrentContent(e),G(Object(o.__)("Template Applied Successfully.","wp-marketing-automations-crm")),setTimeout((function(){G("")}),2e3)}}))),Object(r.createElement)(a.Card,{className:"bwf-p-25"},Object(r.createElement)(Ie,{showSaveTemplate:E,showTypeSelector:v}))),Object(r.createElement)("div",{className:"bwf_clear_20"}),!m&&Object(r.createElement)("div",{className:"bwf-crm-campaign-navigation"},Object(r.createElement)(a.Button,{isPrimary:!0,className:"bwf-crm-navigation-next bwf-big-button",disabled:!$,onClick:K},Object(o.__)("Next","wp-marketing-automations-crm")))))}},801:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(557),o=n(9),c=n(4),i=n(458),l=n(457),u=n(117),s=n(31),m=n(137),b=function(){var e=Object(i.a)().getUpdateStepThreeStatus,t=Object(l.a)(),n=t.resetUpdateStepThreeStatus,a=t.setEditMapMode,o=e();return Object(r.createElement)(m.a,{isLoading:1===o,successMessage:2===o?Object(c.__)("Form Updated","wp-marketing-automations-crm"):"",errorMessage:3===o?Object(c.__)("Unable to update form","wp-marketing-automations-crm"):"",onRequestClose:function(){n(),a(!1)},isOpen:!!o})},f=n(16),d=n.n(f),p=n(7);function g(e,t,n,r,a,o,c){try{var i=e[o](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}function O(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){g(o,r,a,c,i,"next",e)}function i(e){g(o,r,a,c,i,"throw",e)}c(void 0)}))}}var y=function(e){return{sendTestEmail:(a=O(regeneratorRuntime.mark((function e(t,n,r,a,o,c){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d()({method:"POST",path:Object(p.g)("/send-test-email"),data:{email:t,content:{subject:n,body:r,type:a,mail_data:o,preheader:c}}});case 3:return e.abrupt("return",2);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",3);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(e,t,n,r,o,c){return a.apply(this,arguments)}),saveEditorContent:(r=O(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d()({method:"POST",path:Object(p.g)("/form-feeds/".concat(e,"/save-email-content")),data:{content:n}});case 3:return t.abrupt("return",2);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",3);case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))),function(e){return r.apply(this,arguments)}),uploadImage:(n=O(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("image",t),e.prev=2,e.next=5,d()({method:"POST",path:Object(p.g)("/upload-image"),body:n});case 5:return r=e.sent,e.abrupt("return",r&&r.result?r.result:"");case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return","");case 12:case"end":return e.stop()}}),e,null,[[2,9]])}))),function(e){return n.apply(this,arguments)}),fetchCurrentMailEditorContent:(t=O(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d()({method:"GET",path:Object(p.g)("/form-feeds/".concat(e,"/get-email-content"))});case 3:return n=t.sent,t.abrupt("return",n&&n.result?n.result:"");case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return","");case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(){return t.apply(this,arguments)})};var t,n,r,a},j=n(361),w=n(5);function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k=function(e){var t=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings&&bwfcrm_contacts_data.editor_settings.default&&bwfcrm_contacts_data.editor_settings.default.form?bwfcrm_contacts_data.editor_settings.default.form:{};return e&&0!==Object.keys(t).length?Array.isArray(e.content)&&e.content[0]?(e.content[0].body||(e.content[0].body=t.body?t.body:""),e.content[0].editor||(e.content[0].editor=t.editor?t.editor:{}),e):_(_({},e),{},{content:[{body:t.body?t.body:"",editor:t.editor?_({},t.editor):{}}]}):e};t.default=function(e){var t,n=e.feedId,m=Object(i.a)(),f=Object(l.a)(),d=m.getFeed(),p=d&&d.status?parseInt(d.status):1,g=d&&d.data?d.data:{},O=!(!g||!("incentivize_email"in g))&&g.incentivize_email,h=!(!g||!("marketing_status"in g))&&g.marketing_status,E=!(!g||!("not_send_to_subscribed"in g))&&g.not_send_to_subscribed,S=!(!g||!("add_tag_enable"in g))&&g.add_tag_enable,C=g&&"tag_to_add"in g?g.tag_to_add:[],P=g&&"redirect_url"in g?g.redirect_url:"",N=g&&"redirect_mode"in g?g.redirect_mode:"url",T=v(Object(r.useState)(!1),2),x=T[0],A=T[1],I=v(Object(r.useState)(!1),2),R=I[0],M=I[1],F=Object(r.useCallback)((function(e){!1===O?f.updateStepThree(n,{incentivize_email:O,marketing_status:h},e):(M(e),A(!0))}),[O,h]),B=Object(r.useCallback)((function(e){f.updateStepThree(n,{incentivize_email:O,marketing_status:h,incentive_email:e,redirect_mode:N,redirect_url:P,add_tag_enable:S,tag_to_add:C,not_send_to_subscribed:E},R),A(!1)}),[O,h,R,N,P]),D={objectId:"crm.form.".concat(n),mergeTagsContext:"forms"};return Object(r.createElement)("div",{className:"bwf-crm-stepper-wrap bwf-card-wrap bwf-crm-forms-step-3"},Object(r.createElement)(u.a,null),Object(r.createElement)("div",{className:"bwf-card-header"},Object(r.createElement)("span",{className:"bwf-form-title"},Object(c.__)("Lead Notification","wp-marketing-automations-crm"))),Object(r.createElement)("div",{className:"bwf-crm-importer-wrap"},Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-crm-import-section"},Object(r.createElement)(o.ToggleControl,{label:Object(c.__)("Enable email notification","wp-marketing-automations-crm"),className:"bwf-tooglecontrol-advance",help:Object(c.__)("Note: Use {{confirmation_link}} for double optin","wp-marketing-automations-crm"),onChange:function(e){return f.setIncentivizeEmail(e)},checked:!!O})),!!O&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0 bwf-pb-0"},Object(r.createElement)(a.a,{disableDefaultButtons:!0,onEmailContentReady:B,onEmailContentError:function(){return A(!1)},initData:k(g&&"incentive_email"in g?_(_({},g.incentive_email),D):D),validateEmailContent:!!x,apiMethods:y?y(n):{}})),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)(o.Card,{className:"bwf-p-gap bwf-border"},Object(r.createElement)(o.ToggleControl,{label:Object(c.__)("Don't send email if contact is already subscribed","wp-marketing-automations-crm"),className:"bwf-tooglecontrol-advance",onChange:function(e){return f.setNotSendToSubscribed(e)},checked:!!E}),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(s.a,{gap:5,justify:"start",align:"start"},Object(r.createElement)(o.FlexItem,null,Object(r.createElement)("p",{className:"bwf-c-input-label"},Object(c.__)("Redirect After Confirmation","wp-marketing-automations-crm")),Object(r.createElement)(o.ButtonGroup,null,Object(r.createElement)(o.Button,{key:"url",isPrimary:"url"===N,isSecondary:"url"!==N,onClick:function(){return f.setRedirectMode("url")}},Object(c.__)("URL","wp-marketing-automations-crm")),Object(r.createElement)(o.Button,{key:"file",isPrimary:"file"===N,isSecondary:"file"!==N,onClick:function(){return f.setRedirectMode("file")}},Object(c.__)("File","wp-marketing-automations-crm"))))),Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)(o.TextControl,{label:"",value:P,onChange:function(e){return f.setRedirectUrl(e)},placeholder:Object(c.__)("Enter URL","wp-marketing-automations-crm")}),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(o.ToggleControl,{label:Object(c.__)("Add Tags after confirmation","wp-marketing-automations-crm"),className:"bwf-tooglecontrol-advance",onChange:function(e){return f.setAddTagEnabled(e)},checked:!!S}),S&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_10"}),Object(r.createElement)(j.a,{onTagsChange:function(e){f.setTagList(e.map((function(e){return{id:e.key,value:e.label}})))},selected:(t=[],Object(w.isEmpty)(C)||C.map((function(e){t.push({key:e.id,label:e.value})})),t)})),Object(r.createElement)("p",null,Object(c.__)("Note: The settings will work when confirmation link is clicked","wp-marketing-automations-crm"))))),Object(r.createElement)("div",{className:"bwf-crm-import-section"},Object(r.createElement)(o.ToggleControl,{label:Object(c.__)("Auto-confirm Contacts","wp-marketing-automations-crm"),help:Object(c.__)("This will automatically mark new Contacts as Subscribed","wp-marketing-automations-crm"),onChange:function(e){return f.setMarketingStatus(e)},className:"bwf-tooglecontrol-advance",checked:!!h})),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)(s.a,null,Object(r.createElement)(s.b,null,Object(r.createElement)(o.Button,{className:"bwf-display-flex",isSecondary:!0,onClick:function(){return f.setStep("mapping")}},Object(r.createElement)("span",null,Object(c.__)("Back","wp-marketing-automations-crm")))),Object(r.createElement)(s.b,{className:"bwf_text_right"},3===parseInt(p)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(o.Button,{onClick:function(){return F(p)},isSecondary:!0},Object(c.__)("Save","wp-marketing-automations-crm")),Object(r.createElement)(o.Button,{onClick:function(){return F(2)},className:"bwf-ml-10",isPrimary:!0},Object(c.__)("Save & Activate","wp-marketing-automations-crm"))),2===parseInt(p)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(o.Button,{onClick:function(){return F(3)},isSecondary:!0},Object(c.__)("Deactivate","wp-marketing-automations-crm")),Object(r.createElement)(o.Button,{onClick:function(){return F(p)},className:"bwf-ml-10",isPrimary:!0},Object(c.__)("Save","wp-marketing-automations-crm"))),1===parseInt(p)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(o.Button,{onClick:function(){return F(p)},isSecondary:!0},Object(c.__)("Save As Draft","wp-marketing-automations-crm")),Object(r.createElement)(o.Button,{onClick:function(){return F(2)},className:"bwf-ml-10",isPrimary:!0},Object(c.__)("Activate","wp-marketing-automations-crm"))))))),Object(r.createElement)(b,null))}}}]);