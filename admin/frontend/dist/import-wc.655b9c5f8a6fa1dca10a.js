(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{123:function(e,t,r){"use strict";var n=r(0),a=r(4),c=r(5),o=r(8),i=r.n(o),s=r(15),l=r.n(s),u=(r(134),r(160));function m(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var a=h(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return w(this,r)}}function w(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?g(e):t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(i,e);var t,r,c,o=v(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={options:[]},t.appendFreeTextSearch=t.appendFreeTextSearch.bind(g(t)),t.fetchOptions=t.fetchOptions.bind(g(t)),t.updateSelected=t.updateSelected.bind(g(t)),t}return t=i,(r=[{key:"getAutocompleter",value:function(){return this.props.autocompleter&&"object"===f(this.props.autocompleter)?this.props.autocompleter:{}}},{key:"getFormattedOptions",value:function(e,t){var r=this.getAutocompleter(),n=[];return e.forEach((function(e){var a={key:r.getOptionIdentifier(e),label:r.getOptionLabel(e,t),keywords:r.getOptionKeywords(e).filter(Boolean),value:e};n.push(a)})),n}},{key:"fetchOptions",value:function(e,t){var r=this;return this.props.bwfEnableEmptySearch||t?this.getAutocompleter().options(t).then(function(){var e,n=(e=regeneratorRuntime.mark((function e(n){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.getFormattedOptions(n,t),r.setState({options:a}),e.abrupt("return",a);case 3:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,a){var c=e.apply(t,r);function o(e){b(c,n,a,o,i,"next",e)}function i(e){b(c,n,a,o,i,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}()):[]}},{key:"updateSelected",value:function(e){var t=this.props.onChange,r=this.getAutocompleter();t(e.map((function(e){return!e.notFound&&(e.value?r.getOptionCompletion(e.value):e)})).filter(Boolean))}},{key:"appendFreeTextSearch",value:function(e,t){var r=this.props.allowFreeTextSearch;if(!t||!t.length)return[];if(!r)return e.length>0?e:[{label:Object(a.__)("Not Found","wp-marketing-automations-crm"),key:"",notFound:!0}];var n=this.getAutocompleter();return[].concat(m(n.getFreeTextOptions(t,e)),m(e))}},{key:"render",value:function(){var e=this.getAutocompleter(),t=this.props,r=t.className,a=t.inlineTags,c=t.placeholder,o=t.selected,i=t.showClearButton,s=t.staticResults,m=t.disabled,p=(t.multiple,this.state.options),b=e.inputType?e.inputType:"text";return Object(n.createElement)("div",null,Object(n.createElement)(u.a,{className:l()("bwf-search",r,{"is-static-results":s}),disabled:m,hideBeforeSearch:!1,inlineTags:a,isSearchable:!0,label:c,getSearchExpression:e.getSearchExpression,multiple:!0,placeholder:c,onChange:this.updateSelected,onFilter:this.appendFreeTextSearch,onSearch:this.fetchOptions,options:p,remove:this.props.onRemoveTag,searchDebounceTime:500,searchInputType:b,selected:o,showClearButton:i,bwfMaintainSingleTerm:this.props.bwfMaintainSingleTerm}))}}])&&d(t.prototype,r),c&&d(t,c),i}(n.Component);j.propTypes={allowFreeTextSearch:i.a.bool,className:i.a.string,onChange:i.a.func,autocompleter:i.a.object,placeholder:i.a.string,selected:i.a.arrayOf(i.a.shape({key:i.a.oneOfType([i.a.number,i.a.string]).isRequired,label:i.a.string})),inlineTags:i.a.bool,showClearButton:i.a.bool,staticResults:i.a.bool,disabled:i.a.bool,bwfMaintainSingleTerm:i.a.bool,bwfEnableEmptySearch:i.a.bool},j.defaultProps={allowFreeTextSearch:!1,onChange:c.noop,selected:[],inlineTags:!1,showClearButton:!1,staticResults:!1,disabled:!1,bwfMaintainSingleTerm:!1,bwfEnableEmptySearch:!1},t.a=j},134:function(e,t,r){},361:function(e,t,r){"use strict";var n=r(0),a=r(123),c=r(4),o=r(139);t.a=function(e){var t=e.selected,r=e.onTagsChange;return Object(n.createElement)("div",{className:"bwf-c-field-mapper-terms"},Object(n.createElement)("div",{className:"bwf-input-label"},Object(c.__)("Add Tags","wp-marketing-automations-crm")),Object(n.createElement)(a.a,{autocompleter:o.b,multiple:!1,allowFreeTextSearch:!0,inlineTags:!1,selected:t,onChange:function(e){r(e)},onRemoveTag:function(e,n){var a=t.filter((function(t){return!(t.key==e&&t.label==n)}));r(a)},placeholder:Object(c.__)("Search by tag name","wp-marketing-automations-crm"),showClearButton:!0,disabled:!1}))}},455:function(e,t,r){"use strict";var n=r(0),a=r(123),c=r(4),o=r(139);t.a=function(e){var t=e.selected,r=e.onListsChange;return Object(n.createElement)("div",{className:"bwf-c-field-mapper-terms"},Object(n.createElement)("div",{className:"bwf-input-label"},Object(c.__)("Add to Lists","wp-marketing-automations-crm")),Object(n.createElement)(a.a,{autocompleter:o.a,multiple:!1,allowFreeTextSearch:!0,inlineTags:!1,selected:t,onChange:function(e){r(e)},onRemoveTag:function(e){var n=t.filter((function(t){return t.key!=e}));r(n)},placeholder:Object(c.__)("Search by list name","wp-marketing-automations-crm"),showClearButton:!0,disabled:!1}))}},465:function(e,t,r){"use strict";var n=r(0);r(476);t.a=function(e){var t=e.progress,r=e.text,a=e.status,c=e.size,o=e.noStriped?"":"progress-striped";return Object(n.createElement)("div",{className:"progress progress-"+c+" "+o+" active"},Object(n.createElement)("div",{role:"progressbar progress-striped",style:{width:"".concat(t,"%")},className:"progress-bar progress-bar-".concat(a)},Object(n.createElement)("span",null,r)))}},476:function(e,t,r){},487:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(0);var a=function(e,t){var r=Object(n.useRef)();Object(n.useEffect)((function(){r.current=e}),[e]),Object(n.useEffect)((function(){if(null!==t){var e=setInterval((function(){r.current()}),t);return function(){return clearInterval(e)}}}),[t])}},712:function(e,t,r){},742:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(16),c=r.n(a),o=r(7),i=r(4),s=(r(712),r(9)),l=r(465),u=r(20),m=r(17),p=r(487);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw c}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var g=function(e){var t=e.importData.importId,r=v(Object(n.useState)(null),2),a=r[0],b=r[1],d=a&&"log"in a?a.log:{},w=d.skipped,g=void 0===w?0:w,h=d.failed,j=void 0===h?0:h,y=d.succeed,E=void 0===y?0:y,_=location&&location.search?Object(m.parse)(location.search.substring(1)):{},S=v(Object(n.useState)(!1),2),k=S[0],N=S[1],T=v(Object(n.useState)(!1),2),C=T[0],I=T[1],x=function(){var e,r=(e=regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={start_import:!1,import_id:t},e.next=4,c()({method:"GET",path:Object(o.g)("/import/wc/status?"+Object(m.stringify)(r))});case 4:n=e.sent,b(n.result),n.result&&"status"in n.result&&"success"===n.result.status&&n.result.percent>=100&&(Object(o.w)()||(bwfcrm_contacts_data.first_contact_id=1),N(!0),I(!0)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),setError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var c=e.apply(t,r);function o(e){O(c,n,a,o,i,"next",e)}function i(e){O(c,n,a,o,i,"throw",e)}o(void 0)}))});return function(){return r.apply(this,arguments)}}();return Object(p.a)((function(){C||x()}),5e3),a?a&&"percent"in a?Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-crm-import-progress-wrap"},Object(n.createElement)("div",{className:"bwf-t-center"},Object(n.createElement)("h2",null,Object(i.__)("Import Progress","wp-marketing-automations-crm")),Object(n.createElement)("div",{className:"bwf-p bwf-p2"},Object(i.__)("Import has begun in the background. We will let you know when it completes.","wp-marketing-automations-crm"))),Object(n.createElement)("div",{className:"bwf_clear_30"}),Object(n.createElement)(l.a,{status:a.status,size:"lg",progress:parseInt(a.percent),text:Object(i.__)("".concat(a.percent,"%"),"wp-marketing-automations-crm")}),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("p",null,"Skipped: ",parseInt(g)>0?g:0,", Failed:"," ",parseInt(j)>0?j:0,", Success:"," ",parseInt(E)>0?E:0)),k&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-crm-importer-back-button"},Object(n.createElement)(s.Button,{className:"bwf-crm-navigation-back",isPrimary:!0,onClick:function(){Object(u.j)(f(f({},_),{},{path:"/contacts"}),"/contacts",_)}},Object(i.__)("Go To Contacts","wp-marketing-automations-crm"))))):null:Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-crm-import-progress-wrap"},Object(n.createElement)("div",{className:"bwf-t-center"},Object(n.createElement)("h2",null,Object(i.__)("Import Progress","wp-marketing-automations-crm")),Object(n.createElement)("div",{className:"bwf-p bwf-p2"},Object(i.__)("Import has begun in the background. We will let you know when it completes.","wp-marketing-automations-crm"))),Object(n.createElement)("div",{className:"bwf_clear_30"}),Object(n.createElement)(l.a,{status:"info",size:"lg",progress:0,text:Object(i.__)("0%","wp-marketing-automations-crm")}),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("div",{className:"bwf-p"},"Skipped: ",parseInt(g)>0?g:0,", Failed: ",parseInt(j)>0?j:0,", Success: ",parseInt(E)>0?E:0)))},h=r(5),j=r(361),y=r(455),E=r(515),_=r(109),S=r(117);r(13);function k(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}function N(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var c=e.apply(t,r);function o(e){k(c,n,a,o,i,"next",e)}function i(e){k(c,n,a,o,i,"throw",e)}o(void 0)}))}}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw c}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}t.default=function(e){Object(o.d)("WC Importer");var t=e.step,r=T(Object(n.useState)({}),2),a=r[0],l=r[1],u=T(Object(n.useState)(!0),2),p=u[0],b=u[1],f=T(Object(n.useState)(null),2),d=f[0],O=f[1],v=T(Object(n.useState)(!1),2),w=v[0],k=v[1],C=T(Object(n.useState)(!0),2),I=C[0],x=(C[1],T(Object(n.useState)([]),2)),A=x[0],P=x[1],F=T(Object(n.useState)([]),2),R=F[0],B=F[1],D=Object(n.useContext)(o.b),M=T(Object(n.useState)(1),2),L=M[0],U=M[1],W=(0,Object(E.a)().getExistingImports)().wc,G={0:Object(i.__)("Unverified","wp-marketing-automation-crm"),1:Object(i.__)("Subscribed","wp-marketing-automation-crm"),2:Object(i.__)("Bounced","wp-marketing-automation-crm"),3:Object(i.__)("Unsubscribed","wp-marketing-automation-crm")},z=function(){var t=N(regeneratorRuntime.mark((function t(){var r,n,a,s=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>0&&void 0!==s[0]&&s[0],t.prev=1,n={start_import:r,tags:A.map((function(e){return{id:e.key,value:e.label}})),lists:R.map((function(e){return{id:e.key,value:e.label}})),marketing_status:I,disable_events:w,imported_contact_status:L},t.next=5,c()({method:"GET",path:Object(o.g)("/import/wc/status?"+Object(m.stringify)(n))});case 5:a=t.sent,l({importId:a.result.import_id}),e.setStep(3),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),l(null),D(t.t0&&"message"in t.t0?t.t0.message:Object(i.__)("There are some technical difficulties while processing CSV Import","wp-marketing-automations-crm"));case 14:Object(o.L)(D,2e3),b(!1);case 16:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(){return t.apply(this,arguments)}}(),$=function(){var e=N(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c()({method:"GET",path:Object(o.g)("/import/wc/get-orders")}).then((function(e){O(parseInt(e.result)),b(!1)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){parseInt(W)>0?(l({importId:W}),b(!1)):$()}),[]);return Object(n.createElement)("div",{className:"bwf-crm-importer-wrap"},2==t&&p&&(Object(h.isEmpty)(a)||1===a.status)&&Object(n.createElement)(_.a,null),2==t&&!p&&!Object(h.isNull)(d)&&(d>0?Object(n.createElement)(n.Fragment,null,Object(n.createElement)(S.a,null),Object(n.createElement)("div",{className:"bwf-card-wrap"},Object(n.createElement)("div",{className:"bwf-card-header bwf-h4"},Object(i.__)("Configuration","wp-marketing-automations-crm"))),Object(n.createElement)("div",{className:"bwf-crm-importer-wc-wrap"},Object(n.createElement)("div",{className:"bwf-crm-import-section bwf-t-center"},Object(n.createElement)("div",{className:"bwf-h3"},Object(i.__)("WooCommerce Customers","wp-marketing-automations-crm")),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-p bwf-p2"},d+" "+Object(i.__)("paid orders are available for import.","wp-marketing-automations-crm"))),Object(n.createElement)("div",{className:"bwf-crm-import-section"},Object(n.createElement)("div",{className:"bwf-h3"},Object(i.__)("Contact Profile","wp-marketing-automations-crm")),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-c-import-field"},Object(n.createElement)(j.a,{onTagsChange:P,selected:A}),Object(n.createElement)(y.a,{onListsChange:B,selected:R})),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("div",{className:"bwf-p"},Object(i.__)("Status","wp-marketing-automations-crm")),Object(n.createElement)("select",{className:"bwf-import-wc-status-select",onChange:function(e){U(e.target.value)}},Object.keys(G).map((function(e){return Object(n.createElement)("option",{key:e,value:e,selected:L==e},G[e])}))),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)(s.ToggleControl,{label:Object(i.__)("Trigger Automations (for Tag & List related Events)","wp-marketing-automations-crm"),className:"bwf-tooglecontrol-advance",checked:w,onChange:k})),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-crm-btn-right-alignment"},Object(n.createElement)(s.Button,{className:"bwf-crm-navigation-back",isPrimary:!0,onClick:function(){e.setStep(3),b(!0),z(!0)}},Object(i.__)("Import","wp-marketing-automations-crm"))))):Object(n.createElement)(n.Fragment,null,Object(n.createElement)(S.a,null),Object(n.createElement)("div",{className:"bwf-crm-importer-wc-wrap"},Object(n.createElement)("div",{className:"bwf-crm-import-section bwf-t-center"},Object(n.createElement)("div",{className:"bwf-h3"},Object(i.__)("WooCommerce Customers","wp-marketing-automations-crm")),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-p bwf-p2"},Object(i.__)("No Orders are available for import.","wp-marketing-automations-crm"))),Object(n.createElement)("div",{className:"bwf_clear_20"})))),2==t&&!p&&Object(n.createElement)("div",{className:"bwf-crm-importer-navigation"},Object(n.createElement)(s.Button,{className:"bwf-crm-navigation-back bwf-display-flex",isSecondary:!0,onClick:function(){e.setStep(1),e.setImporter(null)}},Object(n.createElement)("span",null,Object(i.__)("Back","wp-marketing-automations-crm")))),3==t&&p&&Object(n.createElement)(_.a,null),3==t&&!p&&a&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)(S.a,null),Object(n.createElement)("div",{className:"bwf-card-wrap"},Object(n.createElement)("div",{className:"bwf-card-header bwf-h4"},Object(i.__)("Configuration","wp-marketing-automations-crm"))),Object(n.createElement)(g,{importData:a,setStep:e.setStep,setImporter:e.setImporter})))}}}]);