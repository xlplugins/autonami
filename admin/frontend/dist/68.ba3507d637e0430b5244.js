(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{128:function(t,e,r){"use strict";r.d(e,"g",(function(){return u})),r.d(e,"i",(function(){return l})),r.d(e,"h",(function(){return s})),r.d(e,"j",(function(){return f})),r.d(e,"e",(function(){return h})),r.d(e,"c",(function(){return b})),r.d(e,"b",(function(){return v})),r.d(e,"f",(function(){return g})),r.d(e,"d",(function(){return w})),r.d(e,"a",(function(){return O})),r.d(e,"k",(function(){return j}));var n=r(30),a=r.n(n),o=r(5),i=r(4),c=r(17),u="YYYY-MM-DD",l=[{value:"today",label:Object(i.__)("Today","woocommerce-admin")},{value:"yesterday",label:Object(i.__)("Yesterday","woocommerce-admin")},{value:"week",label:Object(i.__)("Week to Date","woocommerce-admin")},{value:"last_week",label:Object(i.__)("Last Week","woocommerce-admin")},{value:"month",label:Object(i.__)("Month to Date","woocommerce-admin")},{value:"last_month",label:Object(i.__)("Last Month","woocommerce-admin")},{value:"quarter",label:Object(i.__)("Quarter to Date","woocommerce-admin")},{value:"last_quarter",label:Object(i.__)("Last Quarter","woocommerce-admin")},{value:"year",label:Object(i.__)("Year to Date","woocommerce-admin")},{value:"last_year",label:Object(i.__)("Last Year","woocommerce-admin")},{value:"custom",label:Object(i.__)("Custom","woocommerce-admin")}],s=[{value:"previous_period",label:Object(i.__)("Previous Period","woocommerce-admin")},{value:"previous_year",label:Object(i.__)("Previous Year","woocommerce-admin")}];function f(t,e){if(a.a.isMoment(e))return e.isValid()?e:null;if("string"==typeof e){var r=a()(e,[u,t],!0);return r.isValid()?r:null}throw new Error("toMoment requires a string to be passed as an argument")}function p(t,e){var r=t.year()===e.year(),n=r&&t.month()===e.month(),a=r&&n&&t.isSame(e,"day"),o=Object(i.__)("MMM D, YYYY","woocommerce-admin");if(a)return t.format(o);if(n){var c=t.date();return t.format(o).replace(c,"".concat(c," - ").concat(e.date()))}if(r){var u=Object(i.__)("MMM D","woocommerce-admin");return"".concat(t.format(u)," - ").concat(e.format(o))}return"".concat(t.format(o)," - ").concat(e.format(o))}function d(t,e){var r,n,o=a()().startOf(t).subtract(1,t),i=o.clone().endOf(t);if("previous_period"===e)if("year"===t)n=(r=a()().startOf(t).subtract(2,t)).clone().endOf(t);else{var c=i.diff(o,"days");r=(n=o.clone().subtract(1,"days")).clone().subtract(c,"days")}else r=o.clone().subtract(1,"years"),n=i.clone().subtract(1,"years");return{primaryStart:o,primaryEnd:i,secondaryStart:r,secondaryEnd:n}}function m(t,e){var r,n,o=a()().startOf(t),i=a()(),c=i.diff(o,"days");return"previous_period"===e?(r=o.clone().subtract(1,t),n=i.clone().subtract(1,t)):n=(r=o.clone().subtract(1,"years")).clone().add(c+1,"days").subtract(1,"seconds"),{primaryStart:o,primaryEnd:i,secondaryStart:r,secondaryEnd:n}}function y(t,e,r,n){switch(t){case"today":return m("day",e);case"yesterday":return d("day",e);case"week":return m("week",e);case"last_week":return d("week",e);case"month":return m("month",e);case"last_month":return d("month",e);case"quarter":return m("quarter",e);case"last_quarter":return d("quarter",e);case"year":return m("year",e);case"last_year":return d("year",e);case"custom":var a=n.diff(r,"days");if("previous_period"===e){var o=r.clone().subtract(1,"days");return{primaryStart:r,primaryEnd:n,secondaryStart:o.clone().subtract(a,"days"),secondaryEnd:o}}return{primaryStart:r,primaryEnd:n,secondaryStart:r.clone().subtract(1,"years"),secondaryEnd:n.clone().subtract(1,"years")}}}var h=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"period=month&compare=previous_year",r=t.period,n=t.compare,o=t.after,i=t.before;if(r&&n)return{period:r,compare:n,after:o?a()(o):null,before:i?a()(i):null};var u=Object(c.parse)(e.replace(/&amp;/g,"&"));return{period:u.period,compare:u.compare,after:u.after?a()(u.after):null,before:u.before?a()(u.before):null}},b=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"period=month&compare=previous_year",r=h(t,e),n=r.period,a=r.compare,i=r.after,c=r.before,u=y(n,a,i,c),f=u.primaryStart,d=u.primaryEnd,m=u.secondaryStart,b=u.secondaryEnd;return{primary:{label:Object(o.find)(l,(function(t){return t.value===n})).label,range:p(f,d),after:f,before:d},secondary:{label:Object(o.find)(s,(function(t){return t.value===a})).label,range:p(m,b),after:m,before:b}}};function v(t){var e,r,n,o,i=[];if("custom"===t.period){var c=b(t).primary,u=(e=c.before,r=c.after,n=a()(e),o=a()(r),n.diff(o,"days"));i=u>=365?["day","week","month","quarter","year"]:u>=90?["day","week","month","quarter"]:u>=28?["day","week","month"]:u>=7?["day","week"]:u>1&&u<7?["day"]:["hour","day"]}else switch(t.period){case"today":case"yesterday":i=["hour","day"];break;case"week":case"last_week":i=["day"];break;case"month":case"last_month":i=["day","week"];break;case"quarter":case"last_quarter":i=["day","week","month"];break;case"year":case"last_year":i=["day","week","month","quarter"];break;default:i=["day"]}return i}function g(t){var e=v(t),r=e[0],n=t.interval||r;return t.interval&&!e.includes(t.interval)&&(n=r),n}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r="%B %-d, %Y",n="%B %-d, %Y",a="%Y-%m-%d",o="%b %Y",c="m/d/Y";switch(t){case"hour":r="%_I%p %B %-d, %Y",n="%_I%p %b %-d, %Y",a="%_I%p",o="%b %-d, %Y",c="h A";break;case"day":e<63?a="%-d":(a="%b",o="%Y");break;case"week":e<9?(a="%-d",o="%b %Y"):(a="%b",o="%Y"),r=Object(i.__)("Week of %B %-d, %Y","woocommerce-admin"),n=Object(i.__)("Week of %B %-d, %Y","woocommerce-admin");break;case"quarter":case"month":r="%B %Y",n="%B %Y",a="%b",o="%Y";break;case"year":r="%Y",n="%Y",a="%Y"}return{screenReaderFormat:r,tooltipLabelFormat:n,xFormat:a,x2Format:o,tableFormat:c}}var O={invalid:Object(i.__)("Invalid date","woocommerce-admin"),future:Object(i.__)("Select a date in the past","woocommerce-admin"),startAfterEnd:Object(i.__)("Start date must be before end date","woocommerce-admin"),endBeforeStart:Object(i.__)("Start date must be before end date","woocommerce-admin")};function j(t,e,r,n,o){var i=f(o,e);return i?a()().isBefore(i,"day")?{date:null,error:O.future}:"after"===t&&r&&i.isAfter(r,"day")?{date:null,error:O.startAfterEnd}:"before"===t&&n&&i.isBefore(n,"day")?{date:null,error:O.endBeforeStart}:{date:i}:{date:null,error:O.invalid}}},129:function(t,e,r){"use strict";r.d(e,"a",(function(){return u})),r.d(e,"b",(function(){return l}));var n=r(0),a=r(8),o=r.n(a);function i(t,e){if(null==t)return{};var r,n,a=function(t,e){if(null==t)return{};var r,n,a={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(a[r]=t[r]);return a}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}var c=Object(n.createContext)(2);function u(t){return Object(n.createElement)(c.Consumer,null,(function(e){var r="h"+Math.min(e,6);return Object(n.createElement)(r,t)}))}function l(t){var e=t.component,r=t.children,a=i(t,["component","children"]),o=e||"div";return Object(n.createElement)(c.Consumer,null,(function(t){return Object(n.createElement)(c.Provider,{value:t+1},!1===e?r:Object(n.createElement)(o,a,r))}))}l.propTypes={component:o.a.oneOfType([o.a.func,o.a.string,o.a.bool]),children:o.a.node}},250:function(t,e,r){},251:function(t,e,r){},252:function(t,e,r){},258:function(t,e,r){"use strict";var n=r(0),a=r(4),o=r(15),i=r.n(o),c=r(781),u=r(5),l=r(171),s=r.n(l),f=r(9),p=r(810),d=r(462),m=r(8),y=r.n(m),h=r(95),b=r(20);function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=S(t);if(e){var a=S(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return k(this,r)}}function k(t,e){return!e||"object"!==v(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(i,t);var e,r,a,o=j(i);function i(){return g(this,i),o.apply(this,arguments)}return e=i,(r=[{key:"render",value:function(){var t=this.props.height;return Object(n.createElement)("div",{"aria-hidden":"true",className:"bwf-chart-placeholder",style:{height:t}},Object(n.createElement)(f.Spinner,null))}}])&&w(e.prototype,r),a&&w(e,a),i}(n.Component);_.propTypes={height:y.a.number},_.defaultProps={height:0};var F=_,x=r(129),T=(r(250),r(795)),E=r(776);r(251);function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function D(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function R(t,e){return(R=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function M(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=B(t);if(e){var a=B(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return C(this,r)}}function C(t,e){return!e||"object"!==P(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function B(t){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&R(t,e)}(c,t);var e,r,a,o=M(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=o.call(this,t)).chartRef=Object(n.createRef)(),e}return e=c,(r=[{key:"componentDidMount",value:function(){this.drawUpdatedChart()}},{key:"shouldComponentUpdate",value:function(t){return this.props.className!==t.className||!Object(u.isEqual)(this.props.data,t.data)||!Object(u.isEqual)(this.props.orderedKeys,t.orderedKeys)||this.props.drawChart!==t.drawChart||this.props.height!==t.height||this.props.chartType!==t.chartType||this.props.width!==t.width}},{key:"componentDidUpdate",value:function(){this.drawUpdatedChart()}},{key:"componentWillUnmount",value:function(){this.deleteChart()}},{key:"delayedScroll",value:function(){var t=this.props.tooltip;return Object(u.throttle)((function(){t&&t.hide()}),300)}},{key:"deleteChart",value:function(){Object(E.a)(this.chartRef.current).selectAll("svg").remove()}},{key:"drawUpdatedChart",value:function(){(0,this.props.drawChart)(this.getContainer())}},{key:"getContainer",value:function(){var t=this.props,e=t.className,r=t.height,n=t.width;this.deleteChart();var a=Object(E.a)(this.chartRef.current).append("svg").attr("viewBox","0 0 ".concat(n," ").concat(r)).attr("height",r).attr("width",n).attr("preserveAspectRatio","xMidYMid meet");return e&&a.attr("class","".concat(e,"__viewbox")),a.append("g")}},{key:"render",value:function(){var t=this.props.className;return Object(n.createElement)("div",{className:i()("d3-base",t),ref:this.chartRef,onScroll:this.delayedScroll()})}}])&&D(e.prototype,r),a&&D(e,a),c}(n.Component);function L(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=t[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(t){a=!0,o=t}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(t,e)||I(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(t){return function(t){if(Array.isArray(t))return A(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||I(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(t,e){if(t){if("string"==typeof t)return A(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?A(t,e):void 0}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}Y.propTypes={className:y.a.string,data:y.a.array,orderedKeys:y.a.array,tooltip:y.a.object,chartType:y.a.string};var q=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.b;return"function"==typeof t?t:e(t)},K=function(t){return N(new Set(t.reduce((function(t,e){return t.concat(Object.keys(e))}),[]))).filter((function(t){return"date"!==t}))},V=r(804),H=r(786),U=r(796),W=r(30),z=r.n(W);function $(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=t[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(t){a=!0,o=t}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return G(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Q=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(V.a)().domain(t.filter((function(t){return t.visible})).map((function(t){return t.key}))).rangeRound([0,e.bandwidth()]).padding(r?0:.07)},J=function(t,e){return Object(H.a)().domain([z()(t[0],"YYYY-MM-DD HH:mm").toDate(),z()(t[t.length-1],"YYYY-MM-DD HH:mm").toDate()]).rangeRound([0,e])},X=function(t){var e=function(t){var e=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return t.forEach((function(t){for(var n=0,a=Object.entries(t);n<a.length;n++){var o=$(a[n],2),i=o[0],c=o[1];"date"!==i&&Number.isFinite(c.value)&&c.value>e&&(e=c.value),"date"!==i&&Number.isFinite(c.value)&&c.value<r&&(r=c.value)}})),{upper:e,lower:r}}(t),r=e.lower,n=e.upper,a=function(t,e){if(!Number.isFinite(t)||!Number.isFinite(e))return 1;if(0===e&&0===t)return 1/3;var r=4/3*Math.max(-t,e),n=3*Math.pow(10,(Math.log(r)*Math.LOG10E+1|0)-2),a=Math.ceil(r/n)*n/3;return e<1&&t>-1?Math.round(4*a)/4:Math.ceil(a)}(r,n),o={lower:0,upper:0,step:a};return(Number.isFinite(r)||r<0)&&(o.lower=Math.floor(r/a)*a,o.lower===r&&0!==r&&(o.lower-=a)),(Number.isFinite(n)||n>0)&&(o.upper=Math.ceil(n/a)*a,o.upper===n&&0!==n&&(o.upper+=a)),o},Z=r(805),tt=function(t){for(var e=[],r=1;r<=Math.floor(Math.sqrt(t));r++)t%r==0&&(e.push(r),t/r!==r&&e.push(t/r));return e.sort((function(t,e){return t-e})),e},et=function(t,e,r,n){var a,o=function(t,e){if(t<783)return 7;if(t>=783&&t<=1130)return 12;if(t>1130&&t<=1365){if("time-comparison"===e)return 16;if("item-comparison"===e)return 12}else if(t>1365){if("time-comparison"===e)return 31;if("item-comparison"===e)return 16}return 16}(e,r);return(t.length>=63&&"day"===n||t.length>=9&&"week"===n)&&(t=(a=t).filter((function(t,e){return 0===e||z()(t).toDate().getMonth()!==z()(a[e-1]).toDate().getMonth()}))),t.length<=o||"hour"===n&&function(t){var e=z()(t[0]).toDate(),r=z()(t[t.length-1]).toDate();return e.getDate()===r.getDate()&&e.getMonth()===r.getMonth()&&e.getFullYear()===r.getFullYear()}(t)&&e>783?t:function(t,e){for(var r=[],n=0;n<t.length;n+=e)r.push(t[n]);return r[0]!==t[0]&&r.unshift(t[0]),r}(t,function(t,e){for(var r=[],n=1;r.length<=3;)r=tt(t.length-n),n+=1;return r.find((function(r){return t.length/r<e}))}(t,o))},rt=function(t,e,r,n){var a=z()(t).toDate(),o=0!==e?r[e-1]:r[e];return o=o instanceof Date?o:z()(o).toDate(),0===e?n(a):function(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new RegExp([" |,"],"g"),n=t.split(r),a=e.split(r),o=new Array,i=t.length>e.length?n:a,c=0;c<i.length;c++)n[c]!==a[c]&&o.push(a[c]);return o}(n(o),n(a)).join(" ")};function nt(t){return function(t){if(Array.isArray(t))return at(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return at(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return at(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function at(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var ot=function(t,e,r){for(var n=[],a=0;a<t;a++){var o=(a+1)/t*e,i=r?Math.round(o):o;n[n.length-1]!==i&&n.push(i)}return n},it=function(t,e,r){return[0].concat(nt(function(t,e){if(t>=0)return[];var r=Math.ceil(-t/e);return ot(r,t,t<-1)}(t,r)),nt(function(t,e){if(t<=0)return[];var r=Math.ceil(t/e);return ot(r,t,t>1)}(e,r)))},ct=function(t,e,r,n,a,o){!function(t,e,r,n){var a=r.yScale.range()[0],o=et(e.uniqueDates,r.xScale.range()[1],e.mode,e.interval);"line"===e.chartType&&(o=o.map((function(t){return z()(t).toDate()}))),t.append("g").attr("class","axis").attr("aria-hidden","true").attr("transform","translate(0, ".concat(a,")")).call(Object(Z.a)(r.xScale).tickValues(o).tickFormat((function(t,r){return"hour"===e.interval?n.xFormat(t instanceof Date?t:z()(t).toDate()):rt(t,r,o,n.xFormat)}))),t.append("g").attr("class","axis axis-month").attr("aria-hidden","true").attr("transform","translate(0, ".concat(a+14,")")).call(Object(Z.a)(r.xScale).tickValues(o).tickFormat((function(t,e){return rt(t,e,o,n.x2Format)}))),t.append("g").attr("class","pipes").attr("transform","translate(0, ".concat(a,")")).call(Object(Z.a)(r.xScale).tickValues(o).tickSize(5).tickFormat(""))}(t,e,r,n),function(t,e,r,n,a){var o=it(e.yScale.domain()[0],e.yScale.domain()[1],e.step),i=e.xScale.range()[1],c=a?i+n.left+n.right/2-15:-n.left/2-15,u=e.yMin>=0||e.yMax>0?" with-positive-ticks":"";t.append("g").attr("class","grid"+u).attr("transform","translate(-".concat(n.left,", 0)")).call(Object(Z.b)(e.yScale).tickValues(o).tickSize(-i-n.left-n.right).tickFormat("")),t.append("g").attr("class","axis y-axis").attr("aria-hidden","true").attr("transform","translate("+c+", 12)").attr("text-anchor","start").call(Object(Z.b)(e.yScale).tickValues(0===e.yMax&&0===e.yMin?[o[0]]:o).tickFormat((function(t){return t>-1&&t<1&&r.yBelow1Format?r.yBelow1Format(t):r.yFormat(t)})))}(t,r,n,a,o),t.selectAll(".domain").remove(),t.selectAll(".axis .tick line").remove()},ut=r(598),lt=r(789);function st(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ft(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?st(Object(r),!0).forEach((function(e){pt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):st(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function pt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var dt=function(t,e,r,n,a,o){var i,c,l=n.yScale.range()[0],s=n.xScale.range()[1],f=(i=n.xScale,c=n.yScale,Object(lt.a)().x((function(t){return i(z()(t.date).toDate())})).y((function(t){return c(t.value)}))),p=function(t,e){return e.map((function(e){return{key:e.key,focus:e.focus,visible:e.visible,label:e.label,values:t.map((function(t){return{date:t.date,focus:e.focus,value:t.hasOwnProperty(e.key)&&t[e.key].hasOwnProperty("value")?t[e.key].value:0,visible:e.visible}}))}}))}(e,r.visibleKeys),d=t.append("g").attr("class","lines").selectAll(".line-g").data(p.filter((function(t){return t.visible})).reverse()).enter().append("g").attr("class","line-g").attr("role","region").attr("aria-label",(function(t){return t.label||t.key})),m=function(t,e,r,n,a){var o=r.slice().reverse();return e.map((function(r,i){var c=Object(u.first)(t.filter((function(t){return t.date===r}))),l=a(z()(r).toDate()),s=a(i>=1?z()(e[i-1]).toDate():z()(e[0]).toDate()),f=i<e.length-1?a(z()(e[i+1]).toDate()):a(z()(e[e.length-1]).toDate()),p=0===i?f-l:l-s,d=0===i?0:l-p/2;return p=0===i||i===e.length-1?p/2:p,{date:r,start:e.length>1?d:0,width:e.length>1?p:n,values:o.map((function(t){var e=t.key,n=c[e];return n?{key:e,value:n.value,date:r}:null})).filter(Boolean)}}))}(e,r.uniqueDates,r.visibleKeys,s,n.xScale),y=s<=1365||r.uniqueDates.length>50?2:3;y=s<=783?1.25:y;var h=s<=1365?4:6;r.uniqueDates.length>1&&d.append("path").attr("fill","none").attr("stroke-width",y).attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("stroke",(function(t){return r.getColor(t.key)})).style("opacity",(function(t){var e=t.focus?1:.1;return t.visible?e:0})).attr("d",(function(t){return f(t.values)}));s/r.uniqueDates.length>36&&d.selectAll("circle").data((function(t,e){return t.values.map((function(r){return ft(ft({},r),{},{i:e,visible:t.visible,key:t.key})}))})).enter().append("circle").attr("r",h).attr("fill",(function(t){return r.getColor(t.key)})).attr("stroke","#fff").attr("stroke-width",y+1).style("opacity",(function(t){var e=t.focus?1:.1;return t.visible?e:0})).attr("cx",(function(t){return n.xScale(z()(t.date).toDate())})).attr("cy",(function(t){return n.yScale(t.value)})).attr("tabindex","0").attr("aria-label",(function(t){var e=a.screenReaderFormat(t.date instanceof Date?t.date:z()(t.date).toDate());return"".concat(e," ").concat(o.valueFormat(t.value))})).on("focus",(function(t,r,n){o.show(e.find((function(e){return e.date===t.date})),n[r].parentNode,ut.b.target)})).on("blur",(function(){return o.hide()}));var b=t.append("g").attr("class","focusspaces").selectAll(".focus").data(m).enter().append("g").attr("class","focus"),v=b.append("g").attr("class","focus-grid").attr("opacity","0");v.append("line").attr("x1",(function(t){return n.xScale(z()(t.date).toDate())})).attr("y1",0).attr("x2",(function(t){return n.xScale(z()(t.date).toDate())})).attr("y2",l),v.selectAll("circle").data((function(t){return t.values})).enter().append("circle").attr("r",h+2).attr("fill",(function(t){return r.getColor(t.key)})).attr("stroke","#fff").attr("stroke-width",y+2).attr("cx",(function(t){return n.xScale(z()(t.date).toDate())})).attr("cy",(function(t){return n.yScale(t.value)})),b.append("rect").attr("class","focus-g").attr("x",(function(t){return t.start})).attr("y",0).attr("width",(function(t){return t.width})).attr("height",l).attr("opacity",0).on("mouseover",(function(t,n,a){var i=(0===n||n===m.length-1)&&r.uniqueDates.length>1?0:.5;o.show(e.find((function(e){return e.date===t.date})),ut.b.target,a[n].parentNode,i)})).on("mouseout",(function(){return o.hide()}))},mt=[[],[.5],[.333,.667],[.2,.5,.8],[.12,.375,.625,.88],[0,.25,.5,.75,1]],yt=function(t,e){return function(r){var n=t.length>5?5:t.length,a=Object(u.findIndex)(t,(function(t){return t.key===r})),o=a<=4?mt[n][a]:0;return e(o)}};function ht(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var bt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ref=null,this.chart=null,this.position="",this.title="",this.labelFormat="",this.valueFormat="",this.visibleKeys="",this.getColor=null,this.margin=24}var e,r,n;return e=t,(r=[{key:"calculateXPosition",value:function(t,e,r){var n=this.ref.getBoundingClientRect(),a=this.ref.parentNode.querySelector(".d3-base").getBoundingClientRect(),o=Math.max(a.left,e.left);if("below"===this.position)return Math.max(this.margin,Math.min(t.left+.5*t.width-n.width/2-o,a.width-n.width-this.margin));var i=t.left+t.width*r+this.margin-o;return i+n.width+this.margin>a.width?Math.max(this.margin,t.left+t.width*(1-r)-n.width-this.margin-o):i}},{key:"calculateYPosition",value:function(t,e){if("below"===this.position)return e.height;var r=this.ref.getBoundingClientRect(),n=t.top+this.margin-e.top;return n+r.height+this.margin>e.height?Math.max(0,t.top-r.height-this.margin-e.top):n}},{key:"calculatePosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=t.getBoundingClientRect(),n=this.chart.getBoundingClientRect();return"below"===this.position&&(e=0),{x:this.calculateXPosition(r,n,e),y:this.calculateYPosition(r,n)}}},{key:"hide",value:function(){Object(E.a)(this.chart).selectAll(".barfocus, .focus-grid").attr("opacity","0"),Object(E.a)(this.ref).style("visibility","hidden")}},{key:"getTooltipRowLabel",value:function(t,e){return t[e.key].labelDate?this.labelFormat(z()(t[e.key].labelDate).toDate()):e.label||e.key}},{key:"show",value:function(t,e,r){var n=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(this.visibleKeys.length){Object(E.a)(r).select(".focus-grid, .barfocus").attr("opacity","1");var o=this.calculatePosition(e,a),i=this.visibleKeys.map((function(e){return'\n\t\t\t\t\t<li class="key-row">\n\t\t\t\t\t\t<div class="key-container">\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass="key-color"\n\t\t\t\t\t\t\t\tstyle="background-color: '.concat(n.getColor(e.key),'">\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class="key-key">').concat(n.getTooltipRowLabel(t,e),'</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class="key-value">').concat(n.valueFormat(t[e.key].value),"</span>\n\t\t\t\t\t</li>\n\t\t\t\t")})),c=this.title?this.title:this.labelFormat(z()(t.date).toDate());Object(E.a)(this.ref).style("left",o.x+"px").style("top",o.y+"px").style("visibility","visible").html("\n\t\t\t\t<div>\n\t\t\t\t\t<h4>".concat(c,"</h4>\n\t\t\t\t\t<ul>\n\t\t\t\t\t").concat(i.join(""),"\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t"))}}}])&&ht(e.prototype,r),n&&ht(e,n),t}();function vt(t){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wt(t,e){return(wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=St(t);if(e){var a=St(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return jt(this,r)}}function jt(t,e){return!e||"object"!==vt(e)&&"function"!=typeof e?kt(t):e}function kt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function St(t){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _t=function(){return"rtl"===document.documentElement.dir},Ft=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wt(t,e)}(c,t);var e,r,a,o=Ot(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=o.call(this,t)).drawChart=e.drawChart.bind(kt(e)),e.getParams=e.getParams.bind(kt(e)),e.tooltipRef=Object(n.createRef)(),e}return e=c,(r=[{key:"getFormatParams",value:function(){var t=this.props,e=t.screenReaderFormat,r=t.xFormat,n=t.x2Format,a=t.yFormat,o=t.yBelow1Format;return{screenReaderFormat:q(e,T.a),xFormat:q(r,T.a),x2Format:q(n,T.a),yBelow1Format:q(o),yFormat:q(a)}}},{key:"getScaleParams",value:function(t){var e=this.props,r=e.data,n=e.height,a=e.orderedKeys,o=e.chartType,i=this.getMargin(),c=n-i.top-i.bottom,u=this.getWidth()-i.left-i.right,l=X(r),s=l.upper,f=l.lower,p=l.step,d=function(t,e,r){return Object(U.a)().domain([Math.min(e,0),0===r&&0===e?1:Math.max(r,0)]).rangeRound([t,0])}(c,f,s);if("line"===o)return{step:p,xScale:J(t,u),yMax:s,yMin:f,yScale:d};var m=this.shouldBeCompact(),y=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(V.a)().domain(t).range([0,e]).paddingInner(r?0:.1)}(t,u,m);return{step:p,xGroupScale:Q(a,y,m),xScale:y,yMax:s,yMin:f,yScale:d}}},{key:"getParams",value:function(t){var e=this.props,r=e.chartType,n=e.colorScheme,a=e.data,o=e.interval,i=e.mode,c=e.orderedKeys||function(t){return K(t).map((function(e){return{key:e,focus:!0,total:t.reduce((function(t,r){return t+r[e].value}),0),visible:!0}})).sort((function(t,e){return e.total-t.total}))}(a),u=c.filter((function(t){return t.visible})),l=c.length>5?u:c;return{getColor:yt(l,n),interval:o,mode:i,chartType:r,uniqueDates:t,visibleKeys:u}}},{key:"createTooltip",value:function(t,e,r){var n=this.props,a=n.tooltipLabelFormat,o=n.tooltipPosition,i=n.tooltipTitle,c=n.tooltipValueFormat,u=new bt;u.ref=this.tooltipRef.current,u.chart=t,u.position=o,u.title=i,u.labelFormat=q(a,T.a),u.valueFormat=q(c),u.visibleKeys=r,u.getColor=e,this.tooltip=u}},{key:"drawChart",value:function(t){var e=this.props,r=e.data,n=e.dateParser,a=e.chartType,o=this.getMargin(),i=function(t,e){var r=Object(T.b)(e);return N(new Set(t.map((function(t){return t.date})))).sort((function(t,e){return r(t)-r(e)}))}(r,n),c=this.getFormatParams(),u=this.getParams(i),l=this.getScaleParams(i),s=t.attr("id","chart").append("g").attr("transform","translate(".concat(o.left,", ").concat(o.top,")"));this.createTooltip(s.node(),u.getColor,u.visibleKeys),ct(s,u,l,c,o,_t()),"line"===a&&dt(s,r,u,l,c,this.tooltip),"bar"===a&&function(t,e,r,n,a,o){var i=n.yScale.range()[0],c=t.append("g").attr("class","bars").selectAll("g").data(e).enter().append("g").attr("transform",(function(t){return"translate(".concat(n.xScale(t.date),", 0)")})).attr("class","bargroup").attr("role","region").attr("aria-label",(function(t){return"item-comparison"===r.mode?a.screenReaderFormat(t.date instanceof Date?t.date:z()(t.date).toDate()):null}));c.append("rect").attr("class","barfocus").attr("x",0).attr("y",0).attr("width",n.xGroupScale.range()[1]).attr("height",i).attr("opacity","0").on("mouseover",(function(t,r,n){o.show(e.find((function(e){return e.date===t.date})),ut.b.target,n[r].parentNode)})).on("mouseout",(function(){return o.hide()}));var u=n.yScale(0);c.selectAll(".bar").data((function(t){return r.visibleKeys.map((function(e){return{key:e.key,focus:e.focus,value:t.hasOwnProperty(e.key)&&t[e.key].hasOwnProperty("value")?t[e.key].value:0,label:e.label,visible:e.visible,date:t.date}}))})).enter().append("rect").attr("class","bar").attr("x",(function(t){return n.xGroupScale(t.key)})).attr("y",(function(t){return Math.min(u,n.yScale(t.value))})).attr("width",n.xGroupScale.bandwidth()).attr("height",(function(t){return Math.abs(u-n.yScale(t.value))})).attr("fill",(function(t){return r.getColor(t.key)})).attr("pointer-events","none").attr("tabindex","0").attr("aria-label",(function(t){var n=t.label||t.key;if("time-comparison"===r.mode){var i=e.find((function(e){return e.date===t.date}));n=a.screenReaderFormat(z()(i[t.key].labelDate).toDate())}return"".concat(n," ").concat(o.valueFormat(t.value))})).style("opacity",(function(t){var e=t.focus?1:.1;return t.visible?e:0})).on("focus",(function(t,r,n){var a=t.value>0?ut.b.target:ut.b.target.parentNode;o.show(e.find((function(e){return e.date===t.date})),a,n[r].parentNode)})).on("blur",(function(){return o.hide()}))}(s,r,u,l,c,this.tooltip)}},{key:"shouldBeCompact",value:function(){var t=this.props,e=t.data,r=t.chartType,n=t.width;if("bar"!==r)return!1;var a=this.getMargin(),o=n-a.left-a.right,i=e&&e.length?Object.keys(e[0]).length-1:0;return o<e.length*(i+1)}},{key:"getMargin",value:function(){var t=this.props.margin;return _t()?{bottom:t.bottom,left:t.right,right:t.left,top:t.top}:t}},{key:"getWidth",value:function(){var t=this.props,e=t.data,r=t.chartType,n=t.width;if("bar"!==r)return n;var a=this.getMargin(),o=e&&e.length?Object.keys(e[0]).length-1:0,i=this.shouldBeCompact()?e.length*o:e.length*(o+1);return Math.max(n,i+a.left+a.right)}},{key:"getEmptyMessage",value:function(){var t=this.props,e=t.baseValue,r=t.data,a=t.emptyMessage;if(a&&function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<t.length;r++)for(var n=0,a=Object.entries(t[r]);n<a.length;n++){var o=L(a[n],2),i=o[0],c=o[1];if("date"!==i&&!Object(u.isNil)(c.value)&&c.value!==e)return!1}return!0}(r,e))return Object(n.createElement)("div",{className:"d3-chart__empty-message"},a)}},{key:"render",value:function(){var t=this.props,e=t.className,r=t.data,a=t.height,o=t.orderedKeys,c=t.chartType,u=this.getWidth();return Object(n.createElement)("div",{className:i()("d3-chart__container",e),style:{height:a}},this.getEmptyMessage(),Object(n.createElement)("div",{className:"d3-chart__tooltip",ref:this.tooltipRef}),Object(n.createElement)(Y,{className:i()(e),data:r,drawChart:this.drawChart,height:a,orderedKeys:o,tooltip:this.tooltip,chartType:c,width:u}))}}])&&gt(e.prototype,r),a&&gt(e,a),c}(n.Component);Ft.propTypes={baseValue:y.a.number,className:y.a.string,colorScheme:y.a.func,data:y.a.array.isRequired,dateParser:y.a.string.isRequired,emptyMessage:y.a.string,height:y.a.number,interval:y.a.oneOf(["hour","day","week","month","quarter","year"]),margin:y.a.shape({bottom:y.a.number,left:y.a.number,right:y.a.number,top:y.a.number}),mode:y.a.oneOf(["item-comparison","time-comparison"]),screenReaderFormat:y.a.oneOfType([y.a.string,y.a.func]),orderedKeys:y.a.array,tooltipLabelFormat:y.a.oneOfType([y.a.string,y.a.func]),tooltipValueFormat:y.a.oneOfType([y.a.string,y.a.func]),tooltipPosition:y.a.oneOf(["below","over"]),tooltipTitle:y.a.string,chartType:y.a.oneOf(["bar","line"]),width:y.a.number,xFormat:y.a.oneOfType([y.a.string,y.a.func]),x2Format:y.a.oneOfType([y.a.string,y.a.func]),yBelow1Format:y.a.oneOfType([y.a.string,y.a.func]),yFormat:y.a.oneOfType([y.a.string,y.a.func])},Ft.defaultProps={baseValue:0,data:[],dateParser:"%Y-%m-%dT%H:%M:%S",height:200,margin:{bottom:30,left:40,right:0,top:20},mode:"time-comparison",screenReaderFormat:"%B %-d, %Y",tooltipPosition:"over",tooltipLabelFormat:"%B %-d, %Y",tooltipValueFormat:",",chartType:"line",width:600,xFormat:"%Y-%m-%d",x2Format:"",yBelow1Format:".3~f",yFormat:".3~s"};var xt=Ft,Tt=r(94);function Et(t){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Dt(t,e){return(Dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ct(t);if(e){var a=Ct(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Mt(this,r)}}function Mt(t,e){return!e||"object"!==Et(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ct(t){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dt(t,e)}(u,t);var e,r,o,c=Rt(u);function u(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this)).listRef=Object(n.createRef)(),t.state={isScrollable:!1},t}return e=u,(r=[{key:"componentDidMount",value:function(){this.updateListScroll(),window.addEventListener("resize",this.updateListScroll)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateListScroll)}},{key:"updateListScroll",value:function(){if(this&&this.listRef){var t=this.listRef.current,e=t.scrollHeight-t.scrollTop<=t.offsetHeight;this.setState({isScrollable:!e})}}},{key:"render",value:function(){var t=this.props,e=t.colorScheme,r=t.data,o=t.handleLegendHover,c=t.handleLegendToggle,u=t.interactive,l=t.legendDirection,s=t.legendValueFormat,f=t.instanceId,p=t.totalLabel,d=this.state.isScrollable,m=r.filter((function(t){return t.visible})),y=m.length,h="column"===l&&r.length>5&&p,b=r.length>5?m:r;return Object(n.createElement)("div",{className:i()("bwf-legend","bwf-legend-direction-".concat(l),{"has-total":h,"is-scrollable":d},this.props.className)},Object(n.createElement)("ul",{className:"bwf-legend-list",ref:this.listRef,onScroll:h?this.updateListScroll:null},r.map((function(t){return Object(n.createElement)("li",{className:i()("bwf-legend-item",{"bwf-legend-item-checked":t.visible}),key:t.key,id:"bwf-legend-".concat(f,"__item__").concat(t.key),onMouseEnter:o,onMouseLeave:o,onBlur:o,onFocus:o},Object(n.createElement)("button",{onClick:c,id:"bwf-legend-".concat(f,"__item-button__").concat(t.key),disabled:t.visible&&y<=1||!t.visible&&y>=5||!u,title:y>=5?Object(a.sprintf)(Object(a.__)("You may select up to %d items.","wp-marketing-automations-crm"),5):""},Object(n.createElement)("div",{className:"bwf-legend-item-container"},Object(n.createElement)("span",{className:i()("bwf-legend-item-checkmark",{"bwf-legend-item-checkmark-checked":t.visible}),style:t.visible?{color:yt(b,e)(t.key)}:null}),Object(n.createElement)("span",{className:"bwf-legend-item-title"},t.label),Object(n.createElement)("span",{className:"bwf-legend-item-total"},q(s)(t.total)))))}))),h&&Object(n.createElement)("div",{className:"bwf-legend-total"},p))}}])&&Pt(e.prototype,r),o&&Pt(e,o),u}(n.Component);Bt.propTypes={className:y.a.string,colorScheme:y.a.func,data:y.a.array.isRequired,handleLegendToggle:y.a.func,handleLegendHover:y.a.func,interactive:y.a.bool,legendDirection:y.a.oneOf(["row","column"]),legendValueFormat:y.a.oneOfType([y.a.string,y.a.func]),totalLabel:y.a.string,instanceId:y.a.number},Bt.defaultProps={interactive:!0,legendDirection:"row",legendValueFormat:","};var Yt=Object(Tt.withInstanceId)(Bt);r(252);function Lt(t){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=t[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(t){a=!0,o=t}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return It(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return It(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function It(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function At(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qt(t,e){return(qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ut(t);if(e){var a=Ut(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Vt(this,r)}}function Vt(t,e){return!e||"object"!==Lt(e)&&"function"!=typeof e?Ht(t):e}function Ht(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ut(t){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wt(t,e){switch(e){case"left_space":return[t+" ",""];case"right":return["",t];case"right_space":return[""," "+t];case"left":default:return[t,""]}}var zt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qt(t,e)}(m,t);var e,r,o,l=Kt(m);function m(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m),(e=l.call(this,t)).chartBodyRef=Object(n.createRef)();var r=e.getDataKeys();return e.state={focusedKeys:[],visibleKeys:r.slice(0,5),width:0},e.prevDataKeys=r.sort(),e.handleTypeToggle=e.handleTypeToggle.bind(Ht(e)),e.handleLegendToggle=e.handleLegendToggle.bind(Ht(e)),e.handleLegendHover=e.handleLegendHover.bind(Ht(e)),e.updateDimensions=e.updateDimensions.bind(Ht(e)),e.getVisibleData=Object(d.a)(e.getVisibleData),e.getOrderedKeys=Object(d.a)(e.getOrderedKeys),e.setInterval=e.setInterval.bind(Ht(e)),e}return e=m,(r=[{key:"getDataKeys",value:function(){var t=this.props,e=t.data,r=t.filterParam,n=t.mode,a=t.query;if("item-comparison"===n){var o=r?Object(b.e)(a[r]):[];return this.getOrderedKeys([],[],o).map((function(t){return t.key}))}return K(e)}},{key:"componentDidUpdate",value:function(){var t=this.props.data;if(t&&t.length){var e=K(t).sort();if(!Object(u.isEqual)(e,this.prevDataKeys)){var r=this.getDataKeys();this.prevDataKeys=e,this.setState({visibleKeys:r.slice(0,5)})}}}},{key:"componentDidMount",value:function(){this.updateDimensions(),this.setD3DefaultFormat(),window.addEventListener("resize",this.updateDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions)}},{key:"setD3DefaultFormat",value:function(){var t=this.props.currency,e=t.symbol,r=t.symbolPosition,n=t.decimalSeparator,a=t.thousandSeparator;Object(c.a)({decimal:n,thousands:a,grouping:[3],currency:Wt(e,r)})}},{key:"getOrderedKeys",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=this.props,a=n.data,o=n.legendTotals,i=n.mode;if(!a||0===a.length)return[];var c=a.reduce((function(t,e){return Object.entries(e).forEach((function(e){var r=Nt(e,2),n=r[0],a=r[1];"date"===n||t[n]||(t[n]=a.label)})),t}),{}),u=Object.entries(c).map((function(r){var n=Nt(r,2),i=n[0],c=n[1];return{focus:0===t.length||t.includes(i),key:i,label:c,total:o&&void 0!==o[i]?o[i]:a.reduce((function(t,e){return t+e[i].value}),0),visible:e.includes(i)}}));return"item-comparison"===i?u.sort((function(t,e){return e.total-t.total})).filter((function(t){return t.total>0||r.includes(parseInt(t.key,10))})):u}},{key:"handleTypeToggle",value:function(t){if(this.props.chartType!==t){var e=this.props,r=e.path,n=e.query;Object(b.j)({chartType:t},r,n)}}},{key:"handleLegendToggle",value:function(t){if(this.props.interactiveLegend){var e=t.currentTarget.id.split("_").pop(),r=this.state,n=r.focusedKeys,a=r.visibleKeys;a.includes(e)?this.setState({focusedKeys:Object(u.without)(n,e),visibleKeys:Object(u.without)(a,e)}):this.setState({focusedKeys:n.concat([e]),visibleKeys:a.concat([e])})}}},{key:"handleLegendHover",value:function(t){if("mouseleave"===t.type||"blur"===t.type)this.setState({focusedKeys:[]});else if("mouseenter"===t.type||"focus"===t.type){var e=t.currentTarget.id.split("__").pop();this.setState({focusedKeys:[e]})}}},{key:"updateDimensions",value:function(){this.setState({width:this.chartBodyRef.current.offsetWidth})}},{key:"getVisibleData",value:function(t,e){var r=e.filter((function(t){return t.visible}));return t.map((function(t){var e={date:t.date};return r.forEach((function(r){e[r.key]=t[r.key]})),e}))}},{key:"setInterval",value:function(t){var e=this.props,r=e.path,n=e.query;Object(b.j)({interval:t},r,n)}},{key:"renderIntervalSelector",value:function(){var t=this.props,e=t.interval,r=t.allowedIntervals;if(!r||r.length<1)return null;var o={hour:Object(a.__)("By hour","wp-marketing-automations-crm"),day:Object(a.__)("By day","wp-marketing-automations-crm"),week:Object(a.__)("By week","wp-marketing-automations-crm"),month:Object(a.__)("By month","wp-marketing-automations-crm"),quarter:Object(a.__)("By quarter","wp-marketing-automations-crm"),year:Object(a.__)("By year","wp-marketing-automations-crm")};return Object(n.createElement)(f.SelectControl,{value:e,options:r.map((function(t){return{value:t,label:o[t]}})),onChange:this.setInterval})}},{key:"getChartHeight",value:function(){var t=this.props,e=t.isViewportLarge;return t.isViewportMobile?180:e?300:220}},{key:"getLegendPosition",value:function(){var t=this.props,e=t.legendPosition,r=t.mode,n=t.isViewportWide;return e||(n&&"time-comparison"===r?"top":n&&"item-comparison"===r?"side":"bottom")}},{key:"render",value:function(){var t=this.state,e=t.focusedKeys,r=t.visibleKeys,o=t.width,c=this.props,l=c.baseValue,d=c.chartType,m=c.data,y=c.dateParser,h=c.emptyMessage,v=c.filterParam,g=c.interactiveLegend,w=c.interval,O=c.isRequesting,j=c.isViewportLarge,k=c.itemsLabel,S=c.mode,_=c.query,T=c.screenReaderFormat,E=c.showHeaderControls,P=c.title,D=c.tooltipLabelFormat,R=c.tooltipValueFormat,M=c.tooltipTitle,C=c.valueType,B=c.xFormat,Y=c.x2Format,L=c.yBelow1Format,N=c.yFormat,I=c.hideTypeSelect,A=v?Object(b.e)(_[v]):[],q=this.getOrderedKeys(e,r,A),K=O?null:this.getVisibleData(m,q),V=this.getLegendPosition(),H="top"===V?"row":"column",U="side"===V?"row":"column",W=this.getChartHeight(),z=O?null:Object(n.createElement)(Yt,{colorScheme:p.a,data:q,handleLegendHover:this.handleLegendHover,handleLegendToggle:this.handleLegendToggle,interactive:g,legendDirection:H,legendValueFormat:R,totalLabel:Object(a.sprintf)(k,q.length)}),$=N,G=L;if(!N)switch(C){case"average":$=",.0f";break;case"currency":$="$.3~s",G="$.3~f";break;case"number":$=",.0f"}return Object(n.createElement)("div",{className:"bwf-chart"},E&&Object(n.createElement)("div",{className:"bwf-chart-header"},Object(n.createElement)(x.a,{className:"bwf-chart-title"},P),"top"===V&&z,this.renderIntervalSelector(),!I&&Object(n.createElement)(f.NavigableMenu,{className:"bwf-chart-types",orientation:"horizontal",role:"menubar"},Object(n.createElement)(f.Button,{className:i()("bwf-chart-type-button",{"bwf-chart-type-button-selected":"line"===d}),title:Object(a.__)("Line chart","wp-marketing-automations-crm"),"aria-checked":"line"===d,role:"menuitemradio",tabIndex:"line"===d?0:-1,onClick:Object(u.partial)(this.handleTypeToggle,"line")},Object(n.createElement)(s.a,{icon:"line-graph"})),Object(n.createElement)(f.Button,{className:i()("bwf-chart-type-button",{"bwf-chart-type-button-selected":"bar"===d}),title:Object(a.__)("Bar chart","wp-marketing-automations-crm"),"aria-checked":"bar"===d,role:"menuitemradio",tabIndex:"bar"===d?0:-1,onClick:Object(u.partial)(this.handleTypeToggle,"bar")},Object(n.createElement)(s.a,{icon:"stats-alt"})))),Object(n.createElement)(x.b,{component:!1},Object(n.createElement)("div",{className:i()("bwf-chart-body","bwf-chart-body-".concat(U)),ref:this.chartBodyRef},"side"===V&&z,O&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("span",{className:"screen-reader-text"},Object(a.__)("Your requested data is loading","wp-marketing-automations-crm")),Object(n.createElement)(F,{height:W})),!O&&o>0&&Object(n.createElement)(xt,{baseValue:l,chartType:d,colorScheme:p.a,data:K,dateParser:y,height:W,emptyMessage:h,interval:w,margin:{bottom:50,left:80,right:30,top:0},mode:S,orderedKeys:q,screenReaderFormat:T,tooltipLabelFormat:D,tooltipValueFormat:R,tooltipPosition:j?"over":"below",tooltipTitle:M,valueType:C,width:"row"===U?o-320:o,xFormat:B,x2Format:Y,yBelow1Format:G,yFormat:$})),"bottom"===V&&Object(n.createElement)("div",{className:"bwf-chart-footer"},z)))}}])&&At(e.prototype,r),o&&At(e,o),m}(n.Component);zt.propTypes={allowedIntervals:y.a.array,baseValue:y.a.number,chartType:y.a.oneOf(["bar","line"]),data:y.a.array.isRequired,dateParser:y.a.string.isRequired,emptyMessage:y.a.string,filterParam:y.a.string,itemsLabel:y.a.string,mode:y.a.oneOf(["item-comparison","time-comparison"]),path:y.a.string,query:y.a.object,interactiveLegend:y.a.bool,interval:y.a.oneOf(["hour","day","week","month","quarter","year"]),intervalData:y.a.object,isRequesting:y.a.bool,legendPosition:y.a.oneOf(["bottom","side","top"]),legendTotals:y.a.object,screenReaderFormat:y.a.oneOfType([y.a.string,y.a.func]),showHeaderControls:y.a.bool,title:y.a.string,tooltipLabelFormat:y.a.oneOfType([y.a.string,y.a.func]),tooltipValueFormat:y.a.oneOfType([y.a.string,y.a.func]),tooltipTitle:y.a.string,valueType:y.a.string,xFormat:y.a.string,x2Format:y.a.string,yBelow1Format:y.a.string,yFormat:y.a.string,currency:y.a.object},zt.defaultProps={baseValue:0,chartType:"line",data:[],dateParser:"%Y-%m-%dT%H:%M:%S",interactiveLegend:!0,interval:"day",isRequesting:!1,mode:"time-comparison",screenReaderFormat:"%B %-d, %Y",showHeaderControls:!0,tooltipLabelFormat:"%B %-d, %Y",tooltipValueFormat:",",xFormat:"%d",x2Format:"%b %Y",currency:{symbol:"$",symbolPosition:"left",decimalSeparator:".",thousandSeparator:","}};e.a=Object(h.withViewportMatch)({isViewportMobile:"< medium",isViewportLarge:">= large",isViewportWide:">= wide"})(zt)},731:function(t,e,r){"use strict";r.r(e);var n=r(0),a=r(258),o=r(16),i=r.n(o),c=r(7),u=r(128),l=r(22),s=r(4),f=r(176);function p(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function d(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m(t,e,r,n,a,o,i){try{var c=t[o](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,a)}function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=t[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(t){a=!0,o=t}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}e.default=function(t){var e=t.query,r=t.campaignId,o=e.chartType?e.chartType:"line",h=f.a.getCampaignData(),b=h&&h.type?parseInt(h.type):1,v=y(Object(n.useState)([]),2),g=v[0],w=v[1],O=y(Object(n.useState)(!1),2),j=O[0],k=O[1],S=function(){var t,e=(t=regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return k(!0),t.prev=1,t.next=4,i()({path:Object(c.g)("/broadcast/".concat(r,"/stats")),method:"GET"});case 4:e=t.sent,w(e.result),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log(t.t0);case 11:k(!1);case 12:case"end":return t.stop()}}),t,null,[[1,8]])})),function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function i(t){m(o,n,a,i,c,"next",t)}function c(t){m(o,n,a,i,c,"throw",t)}i(void 0)}))});return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){S(),jQuery(document).ready((function(){window.dispatchEvent(new Event("resize"))}))}),[]);var _=Object(u.d)("hour"),F=g.map((function(t,e){var r={label:Object(s.__)("Opens","wp-marketing-automations-crm"),value:parseInt(t.subtotals.opens)},n={label:Object(s.__)("Clicks","wp-marketing-automations-crm"),value:parseInt(t.subtotals.clicks)};return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(Object(r),!0).forEach((function(e){d(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({date:Object(l.format)("Y-m-d\\TH:i:s",t.start_date),primary:1===b?r:n},1===b?{secondary:n}:{})})),x=Object(s.__)("Total Opens & Clicks","wp-marketing-automations-crm"),T=Object(s.__)("Total Clicks","wp-marketing-automations-crm");return Object(n.createElement)(a.a,{data:F,title:1===b?x:T,chartType:o,interval:"hour",isRequesting:j,layout:"item-comparison",xFormat:_.xFormat,x2Format:_.x2Format,screenReaderFormat:_.screenReaderFormat,tooltipLabelFormat:_.tooltipLabelFormat})}}}]);