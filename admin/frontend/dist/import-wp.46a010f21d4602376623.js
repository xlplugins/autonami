(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{124:function(e,t,r){"use strict";var n=r(0),a=r(4),c=r(5),o=r(8),i=r.n(o),s=r(15),l=r.n(s),u=(r(134),r(160));function m(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=w(e);if(t){var a=w(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?j(e):t}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(i,e);var t,r,c,o=v(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={options:[]},t.appendFreeTextSearch=t.appendFreeTextSearch.bind(j(t)),t.fetchOptions=t.fetchOptions.bind(j(t)),t.updateSelected=t.updateSelected.bind(j(t)),t}return t=i,(r=[{key:"getAutocompleter",value:function(){return this.props.autocompleter&&"object"===p(this.props.autocompleter)?this.props.autocompleter:{}}},{key:"getFormattedOptions",value:function(e,t){var r=this.getAutocompleter(),n=[];return e.forEach((function(e){var a={key:r.getOptionIdentifier(e),label:r.getOptionLabel(e,t),keywords:r.getOptionKeywords(e).filter(Boolean),value:e};n.push(a)})),n}},{key:"fetchOptions",value:function(e,t){var r=this;return this.props.bwfEnableEmptySearch||t?this.getAutocompleter().options(t).then(function(){var e,n=(e=regeneratorRuntime.mark((function e(n){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.getFormattedOptions(n,t),r.setState({options:a}),e.abrupt("return",a);case 3:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,a){var c=e.apply(t,r);function o(e){b(c,n,a,o,i,"next",e)}function i(e){b(c,n,a,o,i,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}()):[]}},{key:"updateSelected",value:function(e){var t=this.props.onChange,r=this.getAutocompleter();t(e.map((function(e){return!e.notFound&&(e.value?r.getOptionCompletion(e.value):e)})).filter(Boolean))}},{key:"appendFreeTextSearch",value:function(e,t){var r=this.props.allowFreeTextSearch;if(!t||!t.length)return[];if(!r)return e.length>0?e:[{label:Object(a.__)("Not Found","wp-marketing-automations-crm"),key:"",notFound:!0}];var n=this.getAutocompleter();return[].concat(m(n.getFreeTextOptions(t,e)),m(e))}},{key:"render",value:function(){var e=this.getAutocompleter(),t=this.props,r=t.className,a=t.inlineTags,c=t.placeholder,o=t.selected,i=t.showClearButton,s=t.staticResults,m=t.disabled,f=(t.multiple,this.state.options),b=e.inputType?e.inputType:"text";return Object(n.createElement)("div",null,Object(n.createElement)(u.a,{className:l()("bwf-search",r,{"is-static-results":s}),disabled:m,hideBeforeSearch:!1,inlineTags:a,isSearchable:!0,label:c,getSearchExpression:e.getSearchExpression,multiple:!0,placeholder:c,onChange:this.updateSelected,onFilter:this.appendFreeTextSearch,onSearch:this.fetchOptions,options:f,remove:this.props.onRemoveTag,searchDebounceTime:500,searchInputType:b,selected:o,showClearButton:i,bwfMaintainSingleTerm:this.props.bwfMaintainSingleTerm}))}}])&&d(t.prototype,r),c&&d(t,c),i}(n.Component);y.propTypes={allowFreeTextSearch:i.a.bool,className:i.a.string,onChange:i.a.func,autocompleter:i.a.object,placeholder:i.a.string,selected:i.a.arrayOf(i.a.shape({key:i.a.oneOfType([i.a.number,i.a.string]).isRequired,label:i.a.string})),inlineTags:i.a.bool,showClearButton:i.a.bool,staticResults:i.a.bool,disabled:i.a.bool,bwfMaintainSingleTerm:i.a.bool,bwfEnableEmptySearch:i.a.bool},y.defaultProps={allowFreeTextSearch:!1,onChange:c.noop,selected:[],inlineTags:!1,showClearButton:!1,staticResults:!1,disabled:!1,bwfMaintainSingleTerm:!1,bwfEnableEmptySearch:!1},t.a=y},134:function(e,t,r){},361:function(e,t,r){"use strict";var n=r(0),a=r(124),c=r(4),o=r(139);t.a=function(e){var t=e.selected,r=e.onTagsChange;return Object(n.createElement)("div",{className:"bwf-c-field-mapper-terms"},Object(n.createElement)("div",{className:"bwf-input-label"},Object(c.__)("Add Tags","wp-marketing-automations-crm")),Object(n.createElement)(a.a,{autocompleter:o.b,multiple:!1,allowFreeTextSearch:!0,inlineTags:!1,selected:t,onChange:function(e){r(e)},onRemoveTag:function(e,n){var a=t.filter((function(t){return!(t.key==e&&t.label==n)}));r(a)},placeholder:Object(c.__)("Search by tag name","wp-marketing-automations-crm"),showClearButton:!0,disabled:!1}))}},455:function(e,t,r){"use strict";var n=r(0),a=r(124),c=r(4),o=r(139);t.a=function(e){var t=e.selected,r=e.onListsChange;return Object(n.createElement)("div",{className:"bwf-c-field-mapper-terms"},Object(n.createElement)("div",{className:"bwf-input-label"},Object(c.__)("Add to Lists","wp-marketing-automations-crm")),Object(n.createElement)(a.a,{autocompleter:o.a,multiple:!1,allowFreeTextSearch:!0,inlineTags:!1,selected:t,onChange:function(e){r(e)},onRemoveTag:function(e){var n=t.filter((function(t){return t.key!=e}));r(n)},placeholder:Object(c.__)("Search by list name","wp-marketing-automations-crm"),showClearButton:!0,disabled:!1}))}},465:function(e,t,r){"use strict";var n=r(0);r(476);t.a=function(e){var t=e.progress,r=e.text,a=e.status,c=e.size,o=e.noStriped?"":"progress-striped";return Object(n.createElement)("div",{className:"progress progress-"+c+" "+o+" active"},Object(n.createElement)("div",{role:"progressbar progress-striped",style:{width:"".concat(t,"%")},className:"progress-bar progress-bar-".concat(a)},Object(n.createElement)("span",null,r)))}},476:function(e,t,r){},487:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(0);var a=function(e,t){var r=Object(n.useRef)();Object(n.useEffect)((function(){r.current=e}),[e]),Object(n.useEffect)((function(){if(null!==t){var e=setInterval((function(){r.current()}),t);return function(){return clearInterval(e)}}}),[t])}},711:function(e,t,r){},735:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(16),c=r.n(a),o=r(7),i=r(4),s=(r(711),r(9)),l=r(361),u=r(455);function m(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw c}}return r}(e,t)||b(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var d=function(e){var t=e.roles,r=void 0===t?{}:t,a=e.onRolesSelected,c=f(Object(n.useState)(Object.keys(r)),2),o=c[0],b=c[1],p=f(Object(n.useState)(!0),2),d=p[0],O=(p[1],f(Object(n.useState)(!0),2)),v=O[0],h=O[1],j=f(Object(n.useState)(!1),2),w=j[0],y=j[1],g=f(Object(n.useState)([]),2),E=g[0],_=g[1],S=f(Object(n.useState)([]),2),k=S[0],N=S[1],x=f(Object(n.useState)(1),2),I=x[0],T=x[1],A={0:Object(i.__)("Unverified","wp-marketing-automation-crm"),1:Object(i.__)("Subscribed","wp-marketing-automation-crm"),2:Object(i.__)("Bounced","wp-marketing-automation-crm"),3:Object(i.__)("Unsubscribed","wp-marketing-automation-crm")};return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(s.Card,{className:"bwf-crm-importer-wp-roles-wrap"},Object(n.createElement)("div",{className:"bwf-crm-import-section"},Object(n.createElement)("div",{className:"bwf-h3"},Object(i.__)("User Roles","wp-marketing-automations-crm")),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-crm-import-checkbox-3col"},r&&Object.keys(r).map((function(e){return Object(n.createElement)(s.CheckboxControl,{checked:o.includes(e),key:e,label:r[e],onChange:function(t){return function(e,t){b(e?[].concat(m(o),[t]):o.filter((function(e){return e!==t})))}(t,e)}})})))),Object(n.createElement)("div",{className:"bwf-crm-import-section"},Object(n.createElement)("div",{className:"bwf-h3"},Object(i.__)("Contact Profile","wp-marketing-automations-crm")),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-c-import-field"},Object(n.createElement)(l.a,{onTagsChange:_,selected:E}),Object(n.createElement)(u.a,{onListsChange:N,selected:k})),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("div",{className:"bwf-p"},Object(i.__)("Status","wp-marketing-automations-crm")),Object(n.createElement)("select",{className:"bwf-import-wp-status-select",onChange:function(e){T(e.target.value)}},Object.keys(A).map((function(e){return Object(n.createElement)("option",{key:e,value:e,selected:I==e},A[e])}))),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)(s.ToggleControl,{checked:v,label:Object(i.__)("Update existing contacts","wp-marketing-automations-crm"),className:"bwf-tooglecontrol-advance",onChange:function(e){return h(e)}}),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)(s.ToggleControl,{label:Object(i.__)("Trigger automations (for tag & list related events)","wp-marketing-automations-crm"),className:"bwf-tooglecontrol-advance",checked:w,onChange:y})),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-form-buttons"},Object(n.createElement)("div",{className:"bwf-crm-btn-right-alignment"},Object(n.createElement)(s.Button,{isPrimary:!0,onClick:function(){return a({roles:o,tags:E.map((function(e){return{id:e.key,value:e.label}})),lists:k.map((function(e){return{id:e.key,value:e.label}})),marketing_status:d,update_existing:v,disable_events:w,imported_contact_status:I})}},Object(i.__)("Import","wp-marketing-automations-crm"))))),Object(n.createElement)("div",{className:"bwf-crm-importer-navigation"},Object(n.createElement)(s.Button,{className:"bwf-crm-navigation-back bwf-display-flex",isSecondary:!0,onClick:function(){e.setStep(1),e.setImporter(null)}},Object(n.createElement)("span",null,Object(i.__)("Back","wp-marketing-automations-crm")))))},O=r(465),v=r(487),h=r(543),j=r(17),w=r(18),y=r(5);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw c}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var x=function(e){var t=e.requestData,r=k(Object(n.useState)(!1),2),a=r[0],l=r[1],u=k(Object(n.useState)(null),2),m=u[0],f=u[1],b=k(Object(n.useState)(t&&"importId"in t?parseInt(t.importId):0),2),p=b[0],d=b[1],g=m&&"log"in m?m.log:{},_=g.skipped,N=void 0===_?0:_,x=g.failed,I=void 0===x?0:x,T=g.succeed,A=void 0===T?0:T,C=k(Object(n.useState)(null),2),P=C[0],F=C[1],R=Object(h.a)().showBackButton,B=location&&location.search?Object(w.parse)(location.search.substring(1)):{},M=0,U=k(Object(n.useState)(5e3),2),D=U[0],L=U[1],$=k(Object(n.useState)(!0),2),z=$[0],G=$[1],W=function(){var e,r=(e=regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M++,e.prev=1,r=parseInt(p)>0?{import_id:p}:t,z?(G(!1),r.start_import=!0):r.start_import=!1,e.next=6,c()({method:"POST",data:r,path:Object(o.g)("/import/wp/status")});case 6:n=e.sent,f(n.result),d(parseInt(n.result.import_id)),n.result&&"status"in n.result&&"success"===n.result.status&&(Object(o.w)()||(bwfcrm_contacts_data.first_contact_id=1),L(null),R(!1),l(!0)),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),L(null),R(!1),F(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,12]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var c=e.apply(t,r);function o(e){S(c,n,a,o,i,"next",e)}function i(e){S(c,n,a,o,i,"throw",e)}o(void 0)}))});return function(){return r.apply(this,arguments)}}();return Object(v.a)((function(){Object(y.isEmpty)(p)&&0!=M||W()}),D),Object(n.useEffect)((function(){return R(!0),window.scrollTo(0,0),function(){R(!1)}}),[]),P||m&&!1 in m?Object(n.createElement)(s.Notice,{status:"error"},P&&"message"in P?P.message:Object(i.__)("There are some technical difficulties while processing CSV Import","wp-marketing-automations-crm")):m?m&&"percent"in m?Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-crm-import-progress-wrap"},Object(n.createElement)("div",{className:"bwf-t-center"},Object(n.createElement)("h2",null,Object(i.__)("Import Progress","wp-marketing-automations-crm")),Object(n.createElement)("div",{className:"bwf-p bwf-p2"},Object(i.__)("Import has begun in the background. We will let you know when it completes.","wp-marketing-automations-crm"))),Object(n.createElement)("div",{className:"bwf_clear_30"}),Object(n.createElement)(O.a,{status:m.status,size:"lg",progress:parseInt(m.percent),text:Object(i.__)("".concat(m.percent,"%"),"wp-marketing-automations-crm")}),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("p",null,"Skipped: ",parseInt(N)>0?N:0,", Failed:"," ",parseInt(I)>0?I:0,", Success:"," ",parseInt(A)>0?A:0)),a&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-crm-importer-back-button"},Object(n.createElement)(s.Button,{className:"bwf-crm-navigation-back",isPrimary:!0,onClick:function(){Object(j.j)(E(E({},B),{},{path:"/contacts"}),"/contacts",B)}},Object(i.__)("Go To Contacts","wp-marketing-automations-crm"))))):null:Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-crm-import-progress-wrap"},Object(n.createElement)("div",{className:"bwf-t-center"},Object(n.createElement)("h2",null,Object(i.__)("Import Progress","wp-marketing-automations-crm")),Object(n.createElement)("div",{className:"bwf-p bwf-p2"},Object(i.__)("Import has begun in the background. We will let you know when it completes.","wp-marketing-automations-crm"))),Object(n.createElement)("div",{className:"bwf_clear_30"}),Object(n.createElement)(O.a,{status:"info",size:"lg",progress:0,text:Object(i.__)("0%","wp-marketing-automations-crm")}),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("div",{className:"bwf-p"},"Skipped: ",parseInt(N)>0?N:0,", Failed: ",parseInt(I)>0?I:0,", Success: ",parseInt(A)>0?A:0)))},I=r(515),T=r(111),A=r(117);function C(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw c}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}t.default=function(e){Object(o.d)("WP Importer");var t=e.step,r=P(Object(n.useState)({}),2),a=r[0],s=r[1],l=P(Object(n.useState)(null),2),u=l[0],m=l[1],f=P(Object(n.useState)(!1),2),b=f[0],p=f[1],O=(0,Object(I.a)().getExistingImports)().wp,v=Object(n.useContext)(o.b),h=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,c()({method:"GET",path:Object(o.g)("/import/wp/roles")});case 4:t=e.sent,s(t.result),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),s(null),v(e.t0&&"message"in e.t0?e.t0.message:Object(i.__)("There are some technical difficulties while processing CSV Import","wp-marketing-automations-crm"));case 12:Object(o.M)(v,2e3),p(!1);case 14:case"end":return e.stop()}}),e,null,[[1,8]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var c=e.apply(t,r);function o(e){C(c,n,a,o,i,"next",e)}function i(e){C(c,n,a,o,i,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(n.useEffect)((function(){O?m({importId:O}):h()}),[]),Object(n.createElement)("div",{className:"bwf-crm-importer-wrap"},b&&Object(n.createElement)(T.a,null),2==t&&!u&&a&&Object(y.size)(a)>0&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)(A.a,null),Object(n.createElement)("div",{className:"bwf-card-wrap"},Object(n.createElement)("div",{className:"bwf-card-header bwf-h4"},Object(i.__)("Configuration","wp-marketing-automations-crm"))),Object(n.createElement)(d,{roles:a,setStep:e.setStep,setImporter:e.setImporter,onRolesSelected:function(t){m(t),e.setStep(3)}})),3==t&&u&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)(A.a,null),Object(n.createElement)("div",{className:"bwf-card-wrap"},Object(n.createElement)("div",{className:"bwf-card-header bwf-h4"},Object(i.__)("Confirmation","wp-marketing-automations-crm"))),Object(n.createElement)(x,{setStep:e.setStep,requestData:u,setImporter:e.setImporter})))}},744:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(16),c=r.n(a),o=r(7),i=r(9),s=r(111),l=r(4),u=r(465),m=r(487),f=r(5);function b(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw c}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var O=function(e){var t=e.exportId,r=void 0===t?"":t,a=e.setLoading,i=p(Object(n.useState)(!1),2),s=i[0],d=i[1],O=p(Object(n.useState)({}),2),v=O[0],h=O[1],j=p(Object(n.useState)(0),2),w=j[0],y=j[1],g=p(Object(n.useState)(!1),2),E=g[0],_=g[1];Object(n.useEffect)((function(){100===parseInt(w)&&setTimeout((function(){_(!0)}),2e3)}),[w]);var S=function(){var e,t=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c()({method:"GET",path:Object(o.g)("/contact/export/".concat(r))}).then((function(e){200==e.code&&h(e.result)}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var c=e.apply(t,r);function o(e){b(c,n,a,o,i,"next",e)}function i(e){b(c,n,a,o,i,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(n.useEffect)((function(){if(!Object(f.isEmpty)(v))if(3==v.status)a(!1),d(!0),y(100);else{var e=parseInt(v.offset)/parseInt(v.count)*100;y(e<100?parseInt(e):100)}}),[v]),Object(m.a)((function(){s||S()}),5e3),Object(n.createElement)("div",{className:"bwf-display-flex-column",style:{alignItems:"center"}},r&&s&&E?Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-h4"},Object(l.__)("Your file is ready for download.","wp-marketing-automations-crm"))):Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-t-center"},Object(n.createElement)("h2",null,Object(l.__)("Export Progress","wp-marketing-automations-crm")),Object(n.createElement)("div",{className:"bwf-p bwf-p2"},Object(l.__)("The file is being created in the background. We will let you know when it completes.","wp-marketing-automations-crm"))),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)(u.a,{status:"striped",size:"lg",progress:parseInt(w),text:"".concat(w,"%")}),Object(n.createElement)("div",{className:"bwf_clear_20"})))};function v(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw c}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}t.default=function(e){var t=e.title,r=e.fields,a=e.expfilter,u=e.setPending,m=e.setAdd,f=e.contactCount,b=h(Object(n.useState)(!1),2),p=b[0],d=b[1],j=h(Object(n.useState)(""),2),w=j[0],y=j[1];Object(n.useEffect)((function(){u(!0),g()}),[]);var g=function(){var e,n=(e=regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={title:t,fields:r,filters:a,count:f},e.next=4,c()({method:"POST",data:n,path:Object(o.g)("/contact/export/add")}).then((function(e){200==e.code&&(Object(o.x)()||(bwfcrm_contacts_data.first_export_id=2),d(!0),e.result.hasOwnProperty("id")&&y(e.result.id))}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("error",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var c=e.apply(t,r);function o(e){v(c,n,a,o,i,"next",e)}function i(e){v(c,n,a,o,i,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}();return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-card-wrap"},Object(n.createElement)("div",{className:"bwf-card-header bwf-h4"},Object(l.__)("Confirmation","wp-marketing-automations-crm"))),Object(n.createElement)(i.Card,{className:"bwfcrm-overview-wrap bwf-contact-export-step-three bwf-p-20"},Object(n.createElement)("div",{className:"bwf-p-20",style:{alignItems:"center"}},p?Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf_clear_20"}),w?Object(n.createElement)(O,{exportId:w,setLoading:u}):Object(n.createElement)("div",{className:"bwf-h4 bwf-t-center"},"Export task has been added we will let you know when the file has been created."),Object(n.createElement)("div",{className:"bwf_clear_20"})):Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)(s.a,null),Object(n.createElement)("div",{className:"bwf_clear_20"}))),Object(n.createElement)("div",{className:"bwf-display-flex"},Object(n.createElement)(i.Button,{isPrimary:!0,onClick:function(){m(!1)}},Object(n.createElement)("span",{className:"bwf-mr-5"},Object(l.__)("Go to Export List","wp-marketing-automations-crm"))))))}}}]);